{"version":3,"file":"useAddEventListener.js","sources":["../src/useAddEventListener.ts"],"sourcesContent":["import React, {useEffect} from 'react';\r\nimport {useEvent} from './useEvent';\r\n\r\n/**\r\n * Add event listener and remove it on unmount\r\n * @param name - event name\r\n * @param handler - event handler (don't care about function stability, handler will be wrapped by useEvent)\r\n * @param target - event target (document by default)\r\n * @param options - additional options\r\n * @param skip - skip adding event listener\r\n */\r\nexport const useAddEventListener = <K extends keyof DocumentEventMap, Target extends EventTarget, TReturn>(\r\n    name: K,\r\n    handler: (ev: DocumentEventMap[K]) => TReturn,\r\n    target?: Target | (() => Target) | React.RefObject<Target> | null,\r\n    options?: boolean | AddEventListenerOptions,\r\n    skip?: boolean\r\n) => {\r\n    const callback = useEvent(handler) as unknown as EventListener;\r\n\r\n    useEffect(() => {\r\n        if (skip) return;\r\n        const targetElement = getTarget(target);\r\n        targetElement.addEventListener(name, callback, options);\r\n        return () => {\r\n            targetElement.removeEventListener(name, callback, options);\r\n        };\r\n    }, [callback, name, options, target]);\r\n};\r\n\r\nexport const getTarget = <Target extends EventTarget>(target?: Target | (() => Target) | React.RefObject<Target> | null) => {\r\n    if (target instanceof EventTarget) return target;\r\n    if (typeof target === 'function') return target();\r\n    if (target?.current instanceof EventTarget) return target.current;\r\n    return document;\r\n};\r\n"],"names":["useAddEventListener","name","handler","target","options","skip","callback","useEvent","useEffect","targetElement","getTarget"],"mappings":";;AAWO,MAAMA,IAAsB,CAC/BC,GACAC,GACAC,GACAC,GACAC,MACC;AACK,QAAAC,IAAWC,EAASL,CAAO;AAEjC,EAAAM,EAAU,MAAM;AACZ,QAAIH,EAAM;AACJ,UAAAI,IAAgBC,EAAUP,CAAM;AACxB,WAAAM,EAAA,iBAAiBR,GAAMK,GAAUF,CAAO,GAC/C,MAAM;AACK,MAAAK,EAAA,oBAAoBR,GAAMK,GAAUF,CAAO;AAAA,IAC7D;AAAA,KACD,CAACE,GAAUL,GAAMG,GAASD,CAAM,CAAC;AACxC,GAEaO,IAAY,CAA6BP,MAC9CA,aAAkB,cAAoBA,IACtC,OAAOA,KAAW,aAAmBA,EAAO,KAC5CA,KAAA,gBAAAA,EAAQ,oBAAmB,cAAoBA,EAAO,UACnD;"}