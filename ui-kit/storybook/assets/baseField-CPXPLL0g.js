var L=Object.defineProperty;var w=(o,e,a)=>e in o?L(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var f=(o,e,a)=>w(o,typeof e!="symbol"?e+"":e,a);import{j as c}from"./jsx-runtime-D_zvdyIk.js";import{a as A}from"./isArray-Cl7xn3Rc.js";import{C as x}from"./dForm-B8QW1p4a.js";import{r as I,R as v}from"./index-iW-139IE.js";import{F as W}from"./TextArea-Bx-nz3Fu.js";import{o as B}from"./buttonsRow-CsTrIbzj.js";import{_ as j}from"./useToken-C9qwXZKU.js";import{x as G,y as O}from"./compact-item-Cxv0YLF9.js";import{G as C}from"./index-mQZ8i_rL.js";const R=({field:o,altLabel:e,children:a})=>{I.useSyncExternalStore(o.subscribe.bind(o),o.getSnapshot.bind(o));const i=o.getProps(),n=o.getFormProps(),t=o.getError(),r={height:"100%",...i.itemWrapperStyle};let s;n.layout==="horizontal"&&(s=" ");const l=typeof e<"u"?e:i.label??s;return c.jsx(W.Item,{label:l,className:i.itemWrapperClassName,help:t||void 0,validateStatus:t?"error":void 0,required:!!i.requiredMark,tooltip:i.tooltip,style:r,children:a})};try{R.displayName="BaseFieldRender",R.__docgenInfo={description:"",displayName:"BaseFieldRender",props:{field:{defaultValue:null,description:"",name:"field",required:!0,type:{name:"IBaseField"}},altLabel:{defaultValue:null,description:"",name:"altLabel",required:!1,type:{name:"ReactNode"}}}}}catch{}function T(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,G(o,e)}function $(o,e){return o.classList?!!e&&o.classList.contains(e):(" "+(o.className.baseVal||o.className)+" ").indexOf(" "+e+" ")!==-1}function U(o,e){o.classList?o.classList.add(e):$(o,e)||(typeof o.className=="string"?o.className=o.className+" "+e:o.setAttribute("class",(o.className&&o.className.baseVal||"")+" "+e))}function D(o,e){return o.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function z(o,e){o.classList?o.classList.remove(e):typeof o.className=="string"?o.className=D(o.className,e):o.setAttribute("class",D(o.className&&o.className.baseVal||"",e))}const H={disabled:!1},k=v.createContext(null);var _=function(e){return e.scrollTop},F="unmounted",g="exited",y="entering",E="entered",P="exiting",m=function(o){T(e,o);function e(i,n){var t;t=o.call(this,i,n)||this;var r=n,s=r&&!r.isMounting?i.enter:i.appear,l;return t.appearStatus=null,i.in?s?(l=g,t.appearStatus=y):l=E:i.unmountOnExit||i.mountOnEnter?l=F:l=g,t.state={status:l},t.nextCallback=null,t}e.getDerivedStateFromProps=function(n,t){var r=n.in;return r&&t.status===F?{status:g}:null};var a=e.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(n){var t=null;if(n!==this.props){var r=this.state.status;this.props.in?r!==y&&r!==E&&(t=y):(r===y||r===E)&&(t=P)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var n=this.props.timeout,t,r,s;return t=r=s=n,n!=null&&typeof n!="number"&&(t=n.exit,r=n.enter,s=n.appear!==void 0?n.appear:r),{exit:t,enter:r,appear:s}},a.updateStatus=function(n,t){if(n===void 0&&(n=!1),t!==null)if(this.cancelNextCallback(),t===y){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:C.findDOMNode(this);r&&_(r)}this.performEnter(n)}else this.performExit();else this.props.unmountOnExit&&this.state.status===g&&this.setState({status:F})},a.performEnter=function(n){var t=this,r=this.props.enter,s=this.context?this.context.isMounting:n,l=this.props.nodeRef?[s]:[C.findDOMNode(this),s],d=l[0],u=l[1],p=this.getTimeouts(),h=s?p.appear:p.enter;if(!n&&!r||H.disabled){this.safeSetState({status:E},function(){t.props.onEntered(d)});return}this.props.onEnter(d,u),this.safeSetState({status:y},function(){t.props.onEntering(d,u),t.onTransitionEnd(h,function(){t.safeSetState({status:E},function(){t.props.onEntered(d,u)})})})},a.performExit=function(){var n=this,t=this.props.exit,r=this.getTimeouts(),s=this.props.nodeRef?void 0:C.findDOMNode(this);if(!t||H.disabled){this.safeSetState({status:g},function(){n.props.onExited(s)});return}this.props.onExit(s),this.safeSetState({status:P},function(){n.props.onExiting(s),n.onTransitionEnd(r.exit,function(){n.safeSetState({status:g},function(){n.props.onExited(s)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(n,t){t=this.setNextCallback(t),this.setState(n,t)},a.setNextCallback=function(n){var t=this,r=!0;return this.nextCallback=function(s){r&&(r=!1,t.nextCallback=null,n(s))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},a.onTransitionEnd=function(n,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:C.findDOMNode(this),s=n==null&&!this.props.addEndListener;if(!r||s){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],d=l[0],u=l[1];this.props.addEndListener(d,u)}n!=null&&setTimeout(this.nextCallback,n)},a.render=function(){var n=this.state.status;if(n===F)return null;var t=this.props,r=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var s=O(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return v.createElement(k.Provider,{value:null},typeof r=="function"?r(n,s):v.cloneElement(v.Children.only(r),s))},e}(v.Component);m.contextType=k;m.propTypes={};function b(){}m.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:b,onEntering:b,onEntered:b,onExit:b,onExiting:b,onExited:b};m.UNMOUNTED=F;m.EXITED=g;m.ENTERING=y;m.ENTERED=E;m.EXITING=P;var X=function(e,a){return e&&a&&a.split(" ").forEach(function(i){return U(e,i)})},S=function(e,a){return e&&a&&a.split(" ").forEach(function(i){return z(e,i)})},q=function(o){T(e,o);function e(){for(var i,n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return i=o.call.apply(o,[this].concat(t))||this,i.appliedClasses={appear:{},enter:{},exit:{}},i.onEnter=function(s,l){var d=i.resolveArguments(s,l),u=d[0],p=d[1];i.removeClasses(u,"exit"),i.addClass(u,p?"appear":"enter","base"),i.props.onEnter&&i.props.onEnter(s,l)},i.onEntering=function(s,l){var d=i.resolveArguments(s,l),u=d[0],p=d[1],h=p?"appear":"enter";i.addClass(u,h,"active"),i.props.onEntering&&i.props.onEntering(s,l)},i.onEntered=function(s,l){var d=i.resolveArguments(s,l),u=d[0],p=d[1],h=p?"appear":"enter";i.removeClasses(u,h),i.addClass(u,h,"done"),i.props.onEntered&&i.props.onEntered(s,l)},i.onExit=function(s){var l=i.resolveArguments(s),d=l[0];i.removeClasses(d,"appear"),i.removeClasses(d,"enter"),i.addClass(d,"exit","base"),i.props.onExit&&i.props.onExit(s)},i.onExiting=function(s){var l=i.resolveArguments(s),d=l[0];i.addClass(d,"exit","active"),i.props.onExiting&&i.props.onExiting(s)},i.onExited=function(s){var l=i.resolveArguments(s),d=l[0];i.removeClasses(d,"exit"),i.addClass(d,"exit","done"),i.props.onExited&&i.props.onExited(s)},i.resolveArguments=function(s,l){return i.props.nodeRef?[i.props.nodeRef.current,s]:[s,l]},i.getClassNames=function(s){var l=i.props.classNames,d=typeof l=="string",u=d&&l?l+"-":"",p=d?""+u+s:l[s],h=d?p+"-active":l[s+"Active"],M=d?p+"-done":l[s+"Done"];return{baseClassName:p,activeClassName:h,doneClassName:M}},i}var a=e.prototype;return a.addClass=function(n,t,r){var s=this.getClassNames(t)[r+"ClassName"],l=this.getClassNames("enter"),d=l.doneClassName;t==="appear"&&r==="done"&&d&&(s+=" "+d),r==="active"&&n&&_(n),s&&(this.appliedClasses[t][r]=s,X(n,s))},a.removeClasses=function(n,t){var r=this.appliedClasses[t],s=r.base,l=r.active,d=r.done;this.appliedClasses[t]={},s&&S(n,s),l&&S(n,l),d&&S(n,d)},a.render=function(){var n=this.props;n.classNames;var t=O(n,["classNames"]);return v.createElement(m,j({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(v.Component);q.defaultProps={classNames:""};q.propTypes={};const V=({field:o,style:e,children:a,noHighlightContainer:i})=>{I.useSyncExternalStore(o.subscribe.bind(o),o.getSnapshot.bind(o));const n=o.getProps(),t=o.isHidden(),r=n.autoHeightResize?" auto-height":"",s=n.containerClassName?" "+n.containerClassName:"",l=N(o),d=o.isHighlighted()&&!i?o.getHighlightedStyle():void 0,u={...n.containerStyle,...e,...d},p=I.useRef(null);return c.jsx(q,{nodeRef:p,in:!t,timeout:300,classNames:"zoom",unmountOnExit:!0,children:c.jsx("div",{ref:p,className:"dform-field-container"+s+r,style:u,onClick:l,children:a})})},N=o=>{const e=B(i=>{i.stopPropagation();const n=document.activeElement;o.setHighlighted(!0),setTimeout(()=>{n==null||n.focus()},100)});return o.getModel().getFormMode()==="constructor"?e:void 0};try{V.displayName="ContainerRender",V.__docgenInfo={description:"",displayName:"ContainerRender",props:{field:{defaultValue:null,description:"",name:"field",required:!0,type:{name:"IBaseField"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},noHighlightContainer:{defaultValue:null,description:"",name:"noHighlightContainer",required:!1,type:{name:"boolean"}}}}}catch{}try{N.displayName="useOnClick",N.__docgenInfo={description:"Highlight field on click",displayName:"useOnClick",props:{fieldProps:{defaultValue:null,description:"form field props",name:"fieldProps",required:!0,type:{name:"IAnyFieldProps<any, any>"}},fieldId:{defaultValue:null,description:"field name",name:"fieldId",required:!0,type:{name:"string"}},model:{defaultValue:null,description:"form model",name:"model",required:!0,type:{name:"DModel"}},parent:{defaultValue:null,description:"parent field",name:"parent",required:!1,type:{name:"IBaseField"}},listeners:{defaultValue:null,description:"React component sync(re-render) listener",name:"listeners",required:!0,type:{name:"(() => void)[]"}},renderSnapshot:{defaultValue:null,description:"react component sync(re-render) snapshot",name:"renderSnapshot",required:!0,type:{name:"Record<never, never>"}},fieldsMap:{defaultValue:null,description:"field collection (plain list of all fields in all component tabs, including child fields)",name:"fieldsMap",required:!0,type:{name:"Record<string, IBaseField>"}},rootFields:{defaultValue:null,description:"root fields collection (only root fields, without children)",name:"rootFields",required:!0,type:{name:"Record<string, IBaseField>"}},prepareChildrenFieldsCollection:{defaultValue:null,description:"",name:"prepareChildrenFieldsCollection",required:!0,type:{name:"() => [Record<string, IBaseField>, Record<string, IBaseField>]"}},initFieldParameters:{defaultValue:null,description:"",name:"initFieldParameters",required:!0,type:{name:"(_fieldProps: IAnyFieldProps<any, any>, _formProps: IDFormProps) => void"}},getProps:{defaultValue:null,description:"@returns get current field properties",name:"getProps",required:!0,type:{name:"() => IAnyFieldProps<any, any>"}},setProps:{defaultValue:null,description:`Set current field properties
@param fieldProps - field new properties
@param noRerender - do not emit re-rendering`,name:"setProps",required:!0,type:{name:"(fieldProps: IAnyFieldProps<any, any>, noRerender?: boolean | undefined) => void"}},noGrowWidth:{defaultValue:null,description:"A sign that the component should not grow in width if free space is available. Relevant for narrow components such as CheckBox or Switch",name:"noGrowWidth",required:!0,type:{name:"() => boolean"}},managesChildWidth:{defaultValue:null,description:"A sign that this component itself controls the width of its child components, and they should not have their own width parameters (for example, inlineGroupField)",name:"managesChildWidth",required:!0,type:{name:"() => boolean"}},getWidth:{defaultValue:null,description:"Get field width property",name:"getWidth",required:!0,type:{name:"() => string | number | undefined"}},updateProps:{defaultValue:null,description:`Set current field properties
@param updatedProps - partial field properties to update
@param noRerender - do not emit re-rendering`,name:"updateProps",required:!0,type:{name:"(updatedProps: Partial<IAnyFieldProps<any, any>>, noRerender?: boolean | undefined) => void"}},getId:{defaultValue:null,description:"@returns field ID",name:"getId",required:!0,type:{name:"() => string"}},getFormProps:{defaultValue:null,description:"Get form properties",name:"getFormProps",required:!0,type:{name:"() => IDFormProps"}},getModel:{defaultValue:null,description:"@returns form model",name:"getModel",required:!0,type:{name:"() => DModel"}},getParent:{defaultValue:null,description:"Return field parent container",name:"getParent",required:!0,type:{name:"() => IBaseField | undefined"}},getLabel:{defaultValue:null,description:"@returns field label",name:"getLabel",required:!0,type:{name:"() => ReactNode"}},setLabel:{defaultValue:null,description:`Sets the field label
@param value - new label value
@param noEvents - do not emit onLabelChanged callback
@param noRerender - do not emit re-rendering`,name:"setLabel",required:!0,type:{name:"(value: ReactNode, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},getValue:{defaultValue:null,description:"@return field value",name:"getValue",required:!0,type:{name:"() => any"}},setValue:{defaultValue:null,description:`Sets a new field value, cause the field to rerender
*this function doesn't change the field touch and dirty statuses. You should handle it in the field component!
@param value - new value
@param noEvents - do not emit onValueChanged callback
@param noRerender - do not emit re-rendering`,name:"setValue",required:!0,type:{name:"(value: any, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},isEmptyValue:{defaultValue:null,description:"@return true if field value is empty array, object, string, undefined or null (if value=0 it is not empty)",name:"isEmptyValue",required:!0,type:{name:"() => boolean"}},isTouched:{defaultValue:null,description:"@returns the field touched status (a user has set focus to the field)",name:"isTouched",required:!0,type:{name:"() => boolean"}},setTouched:{defaultValue:null,description:`Sets a touched status to the field (a user has set focus to the field)
@param value - touched status
@param noEvents - do not emit onTouchedStateChanged callback`,name:"setTouched",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined) => void"}},isDirty:{defaultValue:null,description:"@returns field dirty status",name:"isDirty",required:!0,type:{name:"() => boolean"}},setDirty:{defaultValue:null,description:`Sets a dirty status to the field (a user has changed field value)
@param value - dirty status
@param noEvents - do not emit onDirtyStateChanged and onFormDirtyStateChanged callbacks`,name:"setDirty",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined) => void"}},isDisabled:{defaultValue:null,description:"@returns field disable status",name:"isDisabled",required:!0,type:{name:"() => boolean"}},setDisabled:{defaultValue:null,description:`Sets a disabled status to the field
@param value - disabled status
@param noEvents - do not emit onDisabledStateChanged callback
@param noRerender - do not emit re-rendering`,name:"setDisabled",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},isReadOnly:{defaultValue:null,description:"@returns field read only status",name:"isReadOnly",required:!0,type:{name:"() => boolean"}},setReadOnly:{defaultValue:null,description:`Sets a read only status to the field
@param value - read only status
@param noEvents - do not emit onReadOnlyStateChanged callback
@param noRerender - do not emit re-rendering`,name:"setReadOnly",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},isHidden:{defaultValue:null,description:"@returns field hidden status",name:"isHidden",required:!0,type:{name:"() => boolean"}},setHidden:{defaultValue:null,description:`Sets a hidden status to the field
@param value - hidden status
@param noEvents - do not emit onHiddenStateChanged callback
@param noRerender - do not emit re-rendering`,name:"setHidden",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},isReady:{defaultValue:null,description:"@returns field ready status",name:"isReady",required:!0,type:{name:"() => boolean"}},setReady:{defaultValue:null,description:`Sets a ready status to the field (the field is completely initialized, its data is loaded)
@param value - ready status
@param noEvents - do not emit onReady callback`,name:"setReady",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined) => void"}},getError:{defaultValue:null,description:"@returns the error text of the field",name:"getError",required:!0,type:{name:"() => string"}},setError:{defaultValue:null,description:`Sets an error to the field
@param value - error text
@param noEvents - do not emit onErrorChanged & onFormHasErrors callbacks
@param noRerender - do not emit re-rendering`,name:"setError",required:!0,type:{name:"(value: string, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},validate:{defaultValue:null,description:`Validate field
@param noEvents - do not emit onValidated callback
@param noRerender - do not emit re-rendering
@returns error text`,name:"validate",required:!0,type:{name:"(noEvents?: boolean | undefined, noRerender?: boolean | undefined) => string"}},onInitialFetch:{defaultValue:null,description:"Will called on form initialization data fetch",name:"onInitialFetch",required:!0,type:{name:"() => void"}},isFetching:{defaultValue:null,description:"@returns field fetching status",name:"isFetching",required:!0,type:{name:"() => boolean"}},isFetchingFailed:{defaultValue:null,description:"@returns field fetching failed status",name:"isFetchingFailed",required:!0,type:{name:"() => boolean"}},fetchData:{defaultValue:null,description:"",name:"fetchData",required:!0,type:{name:"() => void"}},isHighlighted:{defaultValue:null,description:"@returns field highlighted status for CONSTRUCTOR MODE",name:"isHighlighted",required:!0,type:{name:"() => boolean"}},setHighlighted:{defaultValue:null,description:"Sets field highlighted status for CONSTRUCTOR MODE",name:"setHighlighted",required:!0,type:{name:"(value: boolean, noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},toggleHighlighted:{defaultValue:null,description:"Toggles field highlighted status for CONSTRUCTOR MODE",name:"toggleHighlighted",required:!0,type:{name:"(noEvents?: boolean | undefined, noRerender?: boolean | undefined) => void"}},getFieldsMap:{defaultValue:null,description:"return@ field collection (plain list of all fields in all component tabs, including child fields)",name:"getFieldsMap",required:!0,type:{name:"() => Record<string, IBaseField>"}},getRootFields:{defaultValue:null,description:"@return root fields collection (only root fields, without children)",name:"getRootFields",required:!0,type:{name:"() => Record<string, IBaseField>"}},isContainer:{defaultValue:null,description:"@return true if field contains another fields",name:"isContainer",required:!0,type:{name:"() => boolean"}},hasVisibleChildren:{defaultValue:null,description:"@return true if field contains visible fields",name:"hasVisibleChildren",required:!0,type:{name:"() => boolean"}},render:{defaultValue:null,description:"",name:"render",required:!0,type:{name:"() => ReactNode"}},renderField:{defaultValue:null,description:"",name:"renderField",required:!0,type:{name:"({ altLabel, extraContainerStyle, }?: { altLabel?: ReactNode; extraContainerStyle?: CSSProperties | undefined; }) => ReactNode"}},renderFieldItem:{defaultValue:null,description:"",name:"renderFieldItem",required:!0,type:{name:"({ children, altLabel, extraContainerStyle, noHighlightContainer, }: { children: ReactNode; altLabel?: ReactNode; extraContainerStyle?: CSSProperties | undefined; noHighlightContainer?: boolean | undefined; }) => Element"}},noItemWrapper:{defaultValue:null,description:"",name:"noItemWrapper",required:!0,type:{name:"() => boolean | undefined"}},noContainer:{defaultValue:null,description:"",name:"noContainer",required:!0,type:{name:"() => boolean | undefined"}},getHighlightedStyle:{defaultValue:null,description:"@return field highlighted style",name:"getHighlightedStyle",required:!0,type:{name:"() => CSSProperties"}},canHaveValue:{defaultValue:null,description:"Is field can have value",name:"canHaveValue",required:!0,type:{name:"() => boolean"}},subscribe:{defaultValue:null,description:"returns React component sync(re-render) listener",name:"subscribe",required:!0,type:{name:"(listener: () => void) => () => void"}},getSnapshot:{defaultValue:null,description:"return React component sync(re-render) snapshot",name:"getSnapshot",required:!0,type:{name:"() => Record<never, never>"}},emitRender:{defaultValue:null,description:"Emit field React component re-render",name:"emitRender",required:!0,type:{name:"() => void"}}}}}catch{}class se{constructor(e,a,i,n){f(this,"fieldProps");f(this,"fieldId");f(this,"model");f(this,"parent");f(this,"listeners",[]);f(this,"renderSnapshot",{});f(this,"fieldsMap",{});f(this,"rootFields",{});this.fieldId=e,this.fieldProps=a,this.model=i,this.parent=n}prepareChildrenFieldsCollection(){return[{},{}]}initFieldParameters(e,a){}getProps(){return this.fieldProps}setProps(e,a){this.fieldProps=e,a||this.emitRender()}noGrowWidth(){return!1}managesChildWidth(){return!1}getWidth(){var e;if(!((e=this.parent)!=null&&e.managesChildWidth()))return this.fieldProps.width}updateProps(e,a){const i=this.getProps()??{};this.setProps({...i,...e},a)}getId(){return this.fieldId}getFormProps(){return this.model.getFormProps()}getModel(){return this.model}getParent(){return this.parent}getLabel(){return this.model.getLabels()[this.fieldId]}setLabel(e,a,i){var t,r;const n=this.getLabel();n!==e&&(this.model.getLabels()[this.fieldId]=e,a||(r=(t=this.getProps())==null?void 0:t.onLabelChanged)==null||r.call(t,e,n,this),i||this.emitRender())}getValue(){return this.model.getValues()[this.fieldId]}setValue(e,a,i){var r,s,l,d;const n=this.getValue();if(n===e)return;const t=this.model.getValues();t[this.fieldId]=e,a||((s=(r=this.getProps())==null?void 0:r.onValueChanged)==null||s.call(r,e,n,this),(d=(l=this.model.getFormProps()).onFormValuesChanged)==null||d.call(l,this.fieldId,t,this.model.getFormApi(),new x),this.validate(a,i)),i||this.emitRender(),this.model.lockDependedFields(this,a,i)}isEmptyValue(){const e=this.getValue();return e===null||A(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0?!0:e!==0&&!e}isTouched(){return this.model.getTouchedFields()[this.fieldId]??!1}setTouched(e,a){var n,t;this.isTouched()!==e&&(this.model.getTouchedFields()[this.fieldId]=e,a||(t=(n=this.getProps())==null?void 0:n.onTouchedStateChanged)==null||t.call(n,e,this))}isDirty(){return this.model.getDirtyFields()[this.fieldId]??!1}setDirty(e,a){var t,r;if(this.isDirty()===e)return;this.model.getDirtyFields()[this.fieldId]=e,a||(r=(t=this.getProps())==null?void 0:t.onDirtyStateChanged)==null||r.call(t,e,this);let n=e;if(!e){for(const s in this.model.getDirtyFields())if(this.model.getDirtyFields()[s]){n=!0;break}}this.model.setFormDirty(n,a)}isDisabled(){var e;return this.model.isFormDisabled()||this.getProps().nonEditable==="disabled"&&this.model.getFormMode()==="update"||(e=this.getParent())!=null&&e.isDisabled()?!0:this.model.getDisabledFields()[this.fieldId]??!1}setDisabled(e,a,i){var t,r;this.isDisabled()!==e&&(this.model.getDisabledFields()[this.fieldId]=e,a||(r=(t=this.getProps())==null?void 0:t.onDisabledStateChanged)==null||r.call(t,e,this),i||this.model.emitFormRender())}isReadOnly(){var e;return this.model.isFormReadOnly()||(this.getProps().nonEditable===!0||this.getProps().nonEditable==="readOnly")&&this.model.getFormMode()==="update"||(e=this.getParent())!=null&&e.isReadOnly()?!0:this.model.getReadOnlyFields()[this.fieldId]??!1}setReadOnly(e,a,i){var t,r;this.model.getReadOnlyFields()[this.fieldId]!==e&&(this.model.getReadOnlyFields()[this.fieldId]=e,a||(r=(t=this.getProps())==null?void 0:t.onReadOnlyStateChanged)==null||r.call(t,e,this),i||this.emitRender())}isHidden(){return this.model.getHiddenFields()[this.fieldId]??!1}setHidden(e,a,i){var t,r;this.isHidden()!==e&&(this.model.getHiddenFields()[this.fieldId]=e,this.model.lockDependedFields(this,a,i),e&&(this.setError("",a,i),this.setReady(!1,!0)),a||(r=(t=this.getProps())==null?void 0:t.onHiddenStateChanged)==null||r.call(t,e,this),i||this.model.emitFormRender())}isReady(){return this.model.isFormFetching()||this.model.isFormFetchingFailed()||this.model.getFetchingFields()[this.fieldId]?!1:this.model.getReadyFields()[this.fieldId]??!1}setReady(e,a){var n,t;this.isReady()!==e&&(this.model.getReadyFields()[this.fieldId]=e,a||(t=(n=this.getProps())==null?void 0:n.onReadyStateChanged)==null||t.call(n,e,this),this.model.checkFormReadyState())}getError(){return this.model.getErrors()[this.fieldId]??""}setError(e,a,i){var r,s,l;if(this.getError()===e)return;const t=this.model.getErrors();if(e?t[this.fieldId]=e:delete t[this.fieldId],!a){const d=this.getProps();(r=d==null?void 0:d.onErrorChanged)==null||r.call(d,e,this);const u=this.model.getFormProps(),p=this.model.getValues(),h=this.model.getFormDataSet();this.model.isFormHasError()?(s=u.onFormHasErrors)==null||s.call(u,p,h,t,this.model.getFormApi(),new x):(l=u.onFormHasNoErrors)==null||l.call(u,p,h,this.model.getFormApi(),new x)}i||this.emitRender()}validate(e,a){var r,s,l;const i=this.getProps().rules??[],n=((r=this.getFormProps().validationRules)==null?void 0:r[this.fieldId])??[],t=this.isHidden()?"":this.model.getValidator().validateValue(this.getValue(),this.model,i.concat(n));return this.setError(t,e),!e&&!this.isHidden()&&((l=(s=this.getProps())==null?void 0:s.onValidated)==null||l.call(s,this.getValue(),t,this.model.isFormSubmitting(),this)),a||this.emitRender(),t}onInitialFetch(){this.fetchData()}isFetching(){return this.model.getFetchingFields()[this.fieldId]===1}isFetchingFailed(){return this.model.getFetchingFields()[this.fieldId]===-1}fetchData(){var i,n;const e=(n=(i=this.fieldProps).onFieldDataFetch)==null?void 0:n.call(i,this);if(!e)return;const a=this.model.getFetchingFields();a[this.fieldId]=1,this.model.checkFormReadyState(),this.emitRender(),e.then(t=>{var s,l;if(!this.model.isFormMounted())return;a[this.fieldId]=0,(l=(s=this.fieldProps).onFieldDataFetchSuccess)==null||l.call(s,t,this);const r=t.data;this.model.setValues(r),this.model.checkFormReadyState(),this.emitRender()},t=>{var r,s;this.model.isFormMounted()&&(a[this.fieldId]=-1,(s=(r=this.fieldProps).onFieldDataFetchError)==null||s.call(r,t,this),this.model.checkFormReadyState(),this.emitRender())})}isHighlighted(){return this.model.getHighlightedId()===this.fieldId}setHighlighted(e,a,i){var s,l;const n=this.model.getHighlightedId(),t=e?this.getId():"";if(n===t)return;this.model.setHighlightedId(t);const r=n?this.model.getField(n):void 0;a||(l=(s=this.getFormProps())==null?void 0:s.onHighlightedFieldChanged)==null||l.call(s,e?this:void 0,r,void 0,this.model.getFormApi()),!i&&(this.emitRender(),r&&(r==null||r.emitRender()))}toggleHighlighted(e,a){this.setHighlighted(!this.isHighlighted(),e,a)}getFieldsMap(){return this.fieldsMap}getRootFields(){return this.rootFields}isContainer(){return Object.keys(this.rootFields).length>0}hasVisibleChildren(){for(const e in this.rootFields){const a=this.rootFields[e];if(!a.isContainer()&&!a.isHidden()||a.hasVisibleChildren())return!0}return!1}render(){throw new Error("Render method must be implemented in a derived class of the BaseField class")}renderField({altLabel:e=void 0,extraContainerStyle:a=void 0}={}){return this.renderFieldItem({children:this.render(),altLabel:e,extraContainerStyle:a})}renderFieldItem({children:e,altLabel:a,extraContainerStyle:i,noHighlightContainer:n}){return this.noContainer()?this.noItemWrapper()?c.jsx(c.Fragment,{children:e}):c.jsx(R,{field:this,altLabel:a,children:e}):this.noItemWrapper()?c.jsx(V,{field:this,style:i,noHighlightContainer:n,children:e},this.getId()):c.jsx(V,{field:this,style:i,noHighlightContainer:n,children:c.jsx(R,{field:this,altLabel:a,children:e})},this.getId())}noItemWrapper(){return this.getProps().noItemWrapper}noContainer(){return this.getProps().noContainer}getHighlightedStyle(){return{border:"dashed 1px blue"}}canHaveValue(){return!0}subscribe(e){return this.listeners=[...this.listeners,e],()=>{this.listeners=this.listeners.filter(a=>a!==e)}}getSnapshot(){return this.renderSnapshot}emitRender(){this.renderSnapshot={};for(const e of this.listeners)e()}}export{se as B};
