import{r as o,B as j,n as ie,t as Gt,i as wt,w as et,h as Pt,bw as zt,f as de,K as Oe,_ as kt,k as gt,l as Ut,g as qt,m as Et,u as mt,o as Xt,F as Yt,E as Ct,a as St,H as Jt,x as Zt,s as Qt,G as en,ax as tn,aH as bt,j as m,R as Qe}from"./index-353109d5.js";import{g as nn,S as rn,G as lt,I as Ke,r as an,P as on,M as ln,m as yt,b as sn,c as un,u as cn,R as dn,C as fn,d as hn,e as Ft,a as vn}from"./index-1664f5a0.js";import{D as gn}from"./dFormModal-cd36bfcf.js";import{u as mn,a as Cn,B as Sn,b as bn,c as yn,d as pn,D as xn,e as Dn}from"./useShowArrow-8a590839.js";import{c as rt,a as In,T as wn,i as kn,g as En,b as Fn,S as Nn,D as Mn}from"./DeleteOutlined-c8bbeae5.js";import{g as Tn,e as Ln,E as Vn}from"./docco-60b84056.js";const An=function(e){var t=o.useRef({valueLabels:new Map});return o.useMemo(function(){var n=t.current.valueLabels,r=new Map,a=e.map(function(l){var s,u=l.value,c=(s=l.label)!==null&&s!==void 0?s:n.get(u);return r.set(u,c),j(j({},l),{},{label:c})});return t.current.valueLabels=r,[a]},[e])},_n=function(e,t,n,r){return o.useMemo(function(){var a=e.map(function(c){var d=c.value;return d}),l=t.map(function(c){var d=c.value;return d}),s=a.filter(function(c){return!r[c]});if(n){var u=rt(a,!0,r);a=u.checkedKeys,l=u.halfCheckedKeys}return[Array.from(new Set([].concat(ie(s),ie(a)))),l]},[e,t,n,r])};function Rn(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function On(e){var t=e||{},n=t.label,r=t.value,a=t.children,l=r||"value";return{_title:n?[n]:["title","label"],value:l,key:l,children:a||"children"}}function at(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function Kn(e,t){var n=[];function r(a){a.forEach(function(l){var s=l[t.children];s&&(n.push(l[t.value]),r(s))})}return r(e),n}function pt(e){return e==null}const jn=function(e,t){return o.useMemo(function(){var n=In(e,{fieldNames:t,initWrapper:function(a){return j(j({},a),{},{valueEntities:new Map})},processEntity:function(a,l){var s=a.node[t.value];l.valueEntities.set(s,a)}});return n},[e,t])};var st=function(){return null},Hn=["children","value"];function Nt(e){return Gt(e).map(function(t){if(!o.isValidElement(t)||!t.type)return null;var n=t,r=n.key,a=n.props,l=a.children,s=a.value,u=wt(a,Hn),c=j({key:r,value:s},u),d=Nt(l);return d.length&&(c.children=d),c}).filter(function(t){return t})}function ot(e){if(!e)return e;var t=j({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return et(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function $n(e,t,n,r,a,l){var s=null,u=null;function c(){function d(i){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return i.map(function(v,g){var C="".concat(h,"-").concat(g),k=v[l.value],V=n.includes(k),H=d(v[l.children]||[],C,V),R=o.createElement(st,v,H.map(function(M){return M.node}));if(t===k&&(s=R),V){var x={pos:C,node:R,children:H};return f||u.push(x),x}return null}).filter(function(v){return v})}u||(u=[],d(r),u.sort(function(i,h){var f=i.node.props.value,v=h.node.props.value,g=n.indexOf(f),C=n.indexOf(v);return g-C}))}Object.defineProperty(e,"triggerNode",{get:function(){return et(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),c(),s}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return et(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),c(),a?u:u.map(function(i){var h=i.node;return h})}})}const Wn=function(e,t,n){var r=n.treeNodeFilterProp,a=n.filterTreeNode,l=n.fieldNames,s=l.children;return o.useMemo(function(){if(!t||a===!1)return e;var u;if(typeof a=="function")u=a;else{var c=t.toUpperCase();u=function(h,f){var v=f[r];return String(v).toUpperCase().includes(c)}}function d(i){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i.reduce(function(f,v){var g=v[s],C=h||u(t,ot(v)),k=d(g||[],C);return(C||k.length)&&f.push(j(j({},v),{},Pt({isLeaf:void 0},s,k))),f},[])}return d(e)},[e,t,s,r,a])};function xt(e){var t=o.useRef();t.current=e;var n=o.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}function Bn(e,t){var n=t.id,r=t.pId,a=t.rootPId,l={},s=[],u=e.map(function(c){var d=j({},c),i=d[n];return l[i]=d,d.key=d.key||i,d});return u.forEach(function(c){var d=c[r],i=l[d];i&&(i.children=i.children||[],i.children.push(c)),(d===a||!i&&a===null)&&s.push(c)}),s}function Gn(e,t,n){return o.useMemo(function(){return e?n?Bn(e,j({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:Nt(t)},[t,n,e])}var Mt=o.createContext(null),Tt=o.createContext(null),Pn={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},zn=function(t,n){var r=mn(),a=r.prefixCls,l=r.multiple,s=r.searchValue,u=r.toggleOpen,c=r.open,d=r.notFoundContent,i=o.useContext(Tt),h=i.virtual,f=i.listHeight,v=i.listItemHeight,g=i.listItemScrollOffset,C=i.treeData,k=i.fieldNames,V=i.onSelect,H=i.dropdownMatchSelectWidth,R=i.treeExpandAction,x=o.useContext(Mt),M=x.checkable,T=x.checkedKeys,Ie=x.halfCheckedKeys,te=x.treeExpandedKeys,je=x.treeDefaultExpandAll,He=x.treeDefaultExpandedKeys,we=x.onTreeExpand,ne=x.treeIcon,fe=x.showTreeIcon,$=x.switcherIcon,ke=x.treeLine,X=x.treeNodeFilterProp,re=x.loadData,W=x.treeLoadedKeys,Ee=x.treeMotion,Fe=x.onTreeLoad,Ne=x.keyEntities,P=o.useRef(),F=zt(function(){return C},[c,C],function(E,S){return S[0]&&E[1]!==S[1]}),he=o.useState(null),B=de(he,2),ae=B[0],oe=B[1],A=Ne[ae],Y=o.useMemo(function(){return M?{checked:T,halfChecked:Ie}:null},[M,T,Ie]);o.useEffect(function(){if(c&&!l&&T.length){var E;(E=P.current)===null||E===void 0||E.scrollTo({key:T[0]}),oe(T[0])}},[c]);var ve=String(s).toLowerCase(),ge=function(S){return ve?String(S[X]).toLowerCase().includes(ve):!1},me=o.useState(He),Ce=de(me,2),Se=Ce[0],Me=Ce[1],$e=o.useState(null),J=de($e,2),Z=J[0],le=J[1],O=o.useMemo(function(){return te?ie(te):s?Z:Se},[Se,Z,te,s]);o.useEffect(function(){s&&le(Kn(C,k))},[s]);var We=function(S){Me(S),le(S),we&&we(S)},be=function(S){S.preventDefault()},z=function(S,U){var K=U.node;M&&at(K)||(V(K.key,{selected:!T.includes(K.key)}),l||u(!1))};if(o.useImperativeHandle(n,function(){var E;return{scrollTo:(E=P.current)===null||E===void 0?void 0:E.scrollTo,onKeyDown:function(U){var K,Te=U.which;switch(Te){case Oe.UP:case Oe.DOWN:case Oe.LEFT:case Oe.RIGHT:(K=P.current)===null||K===void 0||K.onKeyDown(U);break;case Oe.ENTER:{if(A){var pe=(A==null?void 0:A.node)||{},Le=pe.selectable,se=pe.value;Le!==!1&&z(null,{node:{key:ae},selected:!T.includes(se)})}break}case Oe.ESC:u(!1)}},onKeyUp:function(){}}}),F.length===0)return o.createElement("div",{role:"listbox",className:"".concat(a,"-empty"),onMouseDown:be},d);var ye={fieldNames:k};return W&&(ye.loadedKeys=W),O&&(ye.expandedKeys=O),o.createElement("div",{onMouseDown:be},A&&c&&o.createElement("span",{style:Pn,"aria-live":"assertive"},A.node.value),o.createElement(wn,kt({ref:P,focusable:!1,prefixCls:"".concat(a,"-tree"),treeData:F,height:f,itemHeight:v,itemScrollOffset:g,virtual:h!==!1&&H!==!1,multiple:l,icon:ne,showIcon:fe,switcherIcon:$,showLine:ke,loadData:s?null:re,motion:Ee,activeKey:ae,checkable:M,checkStrictly:!0,checkedKeys:Y,selectedKeys:M?[]:T,defaultExpandAll:je},ye,{onActiveChange:oe,onSelect:z,onCheck:z,onExpand:We,onLoad:Fe,filterTreeNode:ge,expandAction:R})))},Lt=o.forwardRef(zn);Lt.displayName="OptionList";var ut="SHOW_ALL",ct="SHOW_PARENT",tt="SHOW_CHILD";function Dt(e,t,n,r){var a=new Set(e);return t===tt?e.filter(function(l){var s=n[l];return!(s&&s.children&&s.children.some(function(u){var c=u.node;return a.has(c[r.value])})&&s.children.every(function(u){var c=u.node;return at(c)||a.has(c[r.value])}))}):t===ct?e.filter(function(l){var s=n[l],u=s?s.parent:null;return!(u&&!at(u.node)&&a.has(u.key))}):e}var Un=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"];function qn(e){return!e||Ut(e)!=="object"}var Xn=o.forwardRef(function(e,t){var n=e.id,r=e.prefixCls,a=r===void 0?"rc-tree-select":r,l=e.value,s=e.defaultValue,u=e.onChange,c=e.onSelect,d=e.onDeselect,i=e.searchValue,h=e.inputValue,f=e.onSearch,v=e.autoClearSearchValue,g=v===void 0?!0:v,C=e.filterTreeNode,k=e.treeNodeFilterProp,V=k===void 0?"value":k,H=e.showCheckedStrategy,R=e.treeNodeLabelProp,x=e.multiple,M=e.treeCheckable,T=e.treeCheckStrictly,Ie=e.labelInValue,te=e.fieldNames,je=e.treeDataSimpleMode,He=e.treeData,we=e.children,ne=e.loadData,fe=e.treeLoadedKeys,$=e.onTreeLoad,ke=e.treeDefaultExpandAll,X=e.treeExpandedKeys,re=e.treeDefaultExpandedKeys,W=e.onTreeExpand,Ee=e.treeExpandAction,Fe=e.virtual,Ne=e.listHeight,P=Ne===void 0?200:Ne,F=e.listItemHeight,he=F===void 0?20:F,B=e.listItemScrollOffset,ae=B===void 0?0:B,oe=e.onDropdownVisibleChange,A=e.dropdownMatchSelectWidth,Y=A===void 0?!0:A,ve=e.treeLine,ge=e.treeIcon,me=e.showTreeIcon,Ce=e.switcherIcon,Se=e.treeMotion,Me=wt(e,Un),$e=Cn(n),J=M&&!T,Z=M||T,le=T||Ie,O=Z||x,We=gt(s,{value:l}),be=de(We,2),z=be[0],ye=be[1],E=o.useMemo(function(){return M?H||tt:ut},[H,M]),S=o.useMemo(function(){return On(te)},[JSON.stringify(te)]),U=gt("",{value:i!==void 0?i:h,postState:function(b){return b||""}}),K=de(U,2),Te=K[0],pe=K[1],Le=function(b){pe(b),f==null||f(b)},se=Gn(He,we,je),ze=jn(se,S),L=ze.keyEntities,Q=ze.valueEntities,Ue=o.useCallback(function(y){var b=[],p=[];return y.forEach(function(D){Q.has(D)?p.push(D):b.push(D)}),{missingRawValues:b,existRawValues:p}},[Q]),qe=Wn(se,Te,{fieldNames:S,treeNodeFilterProp:V,filterTreeNode:C}),Ve=o.useCallback(function(y){if(y){if(R)return y[R];for(var b=S._title,p=0;p<b.length;p+=1){var D=y[b[p]];if(D!==void 0)return D}}},[S,R]),ee=o.useCallback(function(y){var b=Rn(y);return b.map(function(p){return qn(p)?{value:p}:p})},[]),Xe=o.useCallback(function(y){var b=ee(y);return b.map(function(p){var D=p.label,_=p.value,N=p.halfChecked,I,w=Q.get(_);if(w){var G;D=(G=D)!==null&&G!==void 0?G:Ve(w.node),I=w.node.disabled}else if(D===void 0){var ue=ee(z).find(function(Be){return Be.value===_});D=ue.label}return{label:D,value:_,halfChecked:N,disabled:I}})},[Q,Ve,ee,z]),it=o.useMemo(function(){return ee(z)},[ee,z]),At=o.useMemo(function(){var y=[],b=[];return it.forEach(function(p){p.halfChecked?b.push(p):y.push(p)}),[y,b]},[it]),dt=de(At,2),Ae=dt[0],ft=dt[1],ht=o.useMemo(function(){return Ae.map(function(y){return y.value})},[Ae]),_t=_n(Ae,ft,J,L),vt=de(_t,2),_e=vt[0],Ye=vt[1],Rt=o.useMemo(function(){var y=Dt(_e,E,L,S),b=y.map(function(N){var I,w;return(I=(w=L[N])===null||w===void 0||(w=w.node)===null||w===void 0?void 0:w[S.value])!==null&&I!==void 0?I:N}),p=b.map(function(N){var I=Ae.find(function(w){return w.value===N});return{value:N,label:I==null?void 0:I.label}}),D=Xe(p),_=D[0];return!O&&_&&pt(_.value)&&pt(_.label)?[]:D.map(function(N){var I;return j(j({},N),{},{label:(I=N.label)!==null&&I!==void 0?I:N.value})})},[S,O,_e,Ae,Xe,E,L]),Ot=An(Rt),Kt=de(Ot,1),jt=Kt[0],Je=xt(function(y,b,p){var D=Xe(y);if(ye(D),g&&pe(""),u){var _=y;if(J){var N=Dt(y,E,L,S);_=N.map(function(q){var ce=Q.get(q);return ce?ce.node[S.value]:q})}var I=b||{triggerValue:void 0,selected:void 0},w=I.triggerValue,G=I.selected,ue=_;if(T){var Be=ft.filter(function(q){return!_.includes(q.value)});ue=[].concat(ie(ue),ie(Be))}var Ge=Xe(ue),xe={preValue:Ae,triggerValue:w},Re=!0;(T||p==="selection"&&!G)&&(Re=!1),$n(xe,w,y,se,Re,S),Z?xe.checked=G:xe.selected=G;var Ze=le?Ge:Ge.map(function(q){return q.value});u(O?Ze:Ze[0],le?null:Ge.map(function(q){return q.label}),xe)}}),nt=o.useCallback(function(y,b){var p,D=b.selected,_=b.source,N=L[y],I=N==null?void 0:N.node,w=(p=I==null?void 0:I[S.value])!==null&&p!==void 0?p:y;if(!O)Je([w],{selected:!0,triggerValue:w},"option");else{var G=D?[].concat(ie(ht),[w]):_e.filter(function(ce){return ce!==w});if(J){var ue=Ue(G),Be=ue.missingRawValues,Ge=ue.existRawValues,xe=Ge.map(function(ce){return Q.get(ce).key}),Re;if(D){var Ze=rt(xe,!0,L);Re=Ze.checkedKeys}else{var q=rt(xe,{checked:!1,halfCheckedKeys:Ye},L);Re=q.checkedKeys}G=[].concat(ie(Be),ie(Re.map(function(ce){return L[ce].node[S.value]})))}Je(G,{selected:D,triggerValue:w},_||"option")}D||!O?c==null||c(w,ot(I)):d==null||d(w,ot(I))},[Ue,Q,L,S,O,ht,Je,J,c,d,_e,Ye]),Ht=o.useCallback(function(y){if(oe){var b={};Object.defineProperty(b,"documentClickClose",{get:function(){return et(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),oe(y,b)}},[oe]),$t=xt(function(y,b){var p=y.map(function(D){return D.value});if(b.type==="clear"){Je(p,{},"selection");return}b.values.length&&nt(b.values[0].value,{selected:!1,source:"selection"})}),Wt=o.useMemo(function(){return{virtual:Fe,dropdownMatchSelectWidth:Y,listHeight:P,listItemHeight:he,listItemScrollOffset:ae,treeData:qe,fieldNames:S,onSelect:nt,treeExpandAction:Ee}},[Fe,Y,P,he,ae,qe,S,nt,Ee]),Bt=o.useMemo(function(){return{checkable:Z,loadData:ne,treeLoadedKeys:fe,onTreeLoad:$,checkedKeys:_e,halfCheckedKeys:Ye,treeDefaultExpandAll:ke,treeExpandedKeys:X,treeDefaultExpandedKeys:re,onTreeExpand:W,treeIcon:ge,treeMotion:Se,showTreeIcon:me,switcherIcon:Ce,treeLine:ve,treeNodeFilterProp:V,keyEntities:L}},[Z,ne,fe,$,_e,Ye,ke,X,re,W,ge,Se,me,Ce,ve,V,L]);return o.createElement(Tt.Provider,{value:Wt},o.createElement(Mt.Provider,{value:Bt},o.createElement(Sn,kt({ref:t},Me,{id:$e,prefixCls:a,mode:O?"multiple":void 0,displayValues:jt,onDisplayValuesChange:$t,searchValue:Te,onSearch:Le,OptionList:Lt,emptyOptions:!se.length,onDropdownVisibleChange:Ht,dropdownMatchSelectWidth:Y}))))}),Pe=Xn;Pe.TreeNode=st;Pe.SHOW_ALL=ut;Pe.SHOW_PARENT=ct;Pe.SHOW_CHILD=tt;const Yn=e=>{const{componentCls:t,treePrefixCls:n,colorBgElevated:r}=e,a=`.${n}`;return[{[`${t}-dropdown`]:[{padding:`${mt(e.paddingXS)} ${mt(e.calc(e.paddingXS).div(2).equal())}`},En(n,Et(e,{colorBgContainer:r})),{[a]:{borderRadius:0,[`${a}-list-holder-inner`]:{alignItems:"stretch",[`${a}-treenode`]:{[`${a}-node-content-wrapper`]:{flex:"auto"}}}}},Fn(`${n}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${a}-switcher${a}-switcher_close`]:{[`${a}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function Jn(e,t,n){return qt("TreeSelect",r=>{const a=Et(r,{treePrefixCls:t});return[Yn(a)]},kn)(e,n)}var Zn=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};const Qn=(e,t)=>{var n,r,{prefixCls:a,size:l,disabled:s,bordered:u=!0,className:c,rootClassName:d,treeCheckable:i,multiple:h,listHeight:f=256,listItemHeight:v=26,placement:g,notFoundContent:C,switcherIcon:k,treeLine:V,getPopupContainer:H,popupClassName:R,dropdownClassName:x,treeIcon:M=!1,transitionName:T,choiceTransitionName:Ie="",status:te,treeExpandAction:je,builtinPlacements:He,dropdownMatchSelectWidth:we,popupMatchSelectWidth:ne,allowClear:fe}=e,$=Zn(e,["prefixCls","size","disabled","bordered","className","rootClassName","treeCheckable","multiple","listHeight","listItemHeight","placement","notFoundContent","switcherIcon","treeLine","getPopupContainer","popupClassName","dropdownClassName","treeIcon","transitionName","choiceTransitionName","status","treeExpandAction","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","allowClear"]);const{getPopupContainer:ke,getPrefixCls:X,renderEmpty:re,direction:W,virtual:Ee,popupMatchSelectWidth:Fe,popupOverflow:Ne}=o.useContext(Xt),P=X(),F=X("select",a),he=X("select-tree",a),B=X("tree-select",a),{compactSize:ae,compactItemClassnames:oe}=Yt(F,W),A=Ct(F),Y=Ct(B),[ve,ge,me]=bn(F,A),[Ce]=Jn(B,he,Y),Se=St(R||x,`${B}-dropdown`,{[`${B}-dropdown-rtl`]:W==="rtl"},d,me,A,Y,ge),Me=!!(i||h),$e=yn($.suffixIcon,$.showArrow),J=(n=ne??we)!==null&&n!==void 0?n:Fe,{status:Z,hasFeedback:le,isFormItemInput:O,feedbackIcon:We}=o.useContext(Jt),be=Ln(Z,te),{suffixIcon:z,removeIcon:ye,clearIcon:E}=pn(Object.assign(Object.assign({},$),{multiple:Me,showSuffixIcon:$e,hasFeedback:le,feedbackIcon:We,prefixCls:F,componentName:"TreeSelect"})),S=fe===!0?{clearIcon:E}:fe;let U;C!==void 0?U=C:U=(re==null?void 0:re("Select"))||o.createElement(xn,{componentName:"Select"});const K=Zt($,["suffixIcon","itemIcon","removeIcon","clearIcon","switcherIcon"]),Te=o.useMemo(()=>g!==void 0?g:W==="rtl"?"bottomRight":"bottomLeft",[g,W]),pe=Dn(He,Ne),Le=Qt(Ve=>{var ee;return(ee=l??ae)!==null&&ee!==void 0?ee:Ve}),se=o.useContext(en),ze=s??se,L=St(!a&&B,{[`${F}-lg`]:Le==="large",[`${F}-sm`]:Le==="small",[`${F}-rtl`]:W==="rtl",[`${F}-borderless`]:!u,[`${F}-in-form-item`]:O},Tn(F,be,le),oe,c,d,me,A,Y,ge),Q=Ve=>o.createElement(Nn,{prefixCls:he,switcherIcon:k,treeNodeProps:Ve,showLine:V}),[Ue]=tn("SelectLike",(r=$.dropdownStyle)===null||r===void 0?void 0:r.zIndex),qe=o.createElement(Pe,Object.assign({virtual:Ee,disabled:ze},K,{dropdownMatchSelectWidth:J,builtinPlacements:pe,ref:t,prefixCls:F,className:L,listHeight:f,listItemHeight:v,treeCheckable:i&&o.createElement("span",{className:`${F}-tree-checkbox-inner`}),treeLine:!!V,suffixIcon:z,multiple:Me,placement:Te,removeIcon:ye,allowClear:S,switcherIcon:Q,showTreeIcon:M,notFoundContent:U,getPopupContainer:H||ke,treeMotion:null,dropdownClassName:Se,dropdownStyle:Object.assign(Object.assign({},$.dropdownStyle),{zIndex:Ue}),choiceTransitionName:bt(P,"",Ie),transitionName:bt(P,"slide-up",T),treeExpandAction:je}));return ve(Ce(qe))},er=o.forwardRef(Qn),De=er,tr=nn(De);De.TreeNode=st;De.SHOW_ALL=ut;De.SHOW_PARENT=ct;De.SHOW_CHILD=tt;De._InternalPanelDoNotUseOrYouWillBeFired=tr;const nr=De,rr=()=>{const e=o.useRef(!0);return o.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),e},ar=e=>o.useMemo(()=>({...{maxHeight:400,overflow:"auto"},...e||{}}),[e]),or=({fetching:e,error:t,minSymbols:n,plainList:r})=>n?m.jsx(lr,{minSymbols:n,plainList:r}):e?m.jsx(sr,{plainList:r}):t?m.jsx(ur,{error:t,plainList:r}):m.jsx(m.Fragment,{}),lr=({minSymbols:e,plainList:t})=>m.jsxs("div",{style:{paddingLeft:t?"8px":"30px",fontSize:"12px"},children:["Введите как минимум ",e," симв."]}),sr=({plainList:e})=>m.jsxs("div",{style:{paddingLeft:e?"8px":"30px",fontSize:"12px"},children:[m.jsx(rn,{size:"small"})," загрузка..."]}),ur=({error:e,plainList:t})=>m.jsx("div",{role:"alert",style:{paddingLeft:t?"8px":"30px",fontSize:"12px",color:"#ff4d4f"},children:e}),cr=({fetching:e,error:t,minSymbols:n,plainList:r})=>n||e||t?m.jsx(m.Fragment,{}):m.jsx("div",{style:{paddingLeft:r?"8px":"30px",fontSize:"12px"},children:"Данные отсутствуют"}),ir=({menu:e,fetching:t,error:n,minSymbols:r,plainList:a})=>m.jsxs(m.Fragment,{children:[e,m.jsx(or,{fetching:t,error:n,minSymbols:r,plainList:a})]}),dr=({fetchError:e,fetching:t,minSymbols:n,plainList:r})=>o.useCallback(a=>m.jsx("div",{className:r?"tree-select-plain":void 0,children:m.jsx(ir,{menu:a,fetching:t,error:e,minSymbols:n,plainList:r})}),[e,t,n,r]),fr=e=>{const t=e.getProps().fieldNames,n=(t==null?void 0:t.title)||"title";return o.useCallback((r,a)=>{const l=a;return!l||typeof l[n]!="string"?!1:l[n].toLowerCase().indexOf(r.toLowerCase())>=0},[n])},It=({api:e,treeSelectProps:t,antdTreeSelectProps:n})=>{var s,u,c,d,i;const r=ar(t.dropdownStyle),a=dr({fetchError:e.getFetchError(),fetching:e.getIsFetching(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),l=fr(e);return m.jsx(nr,{...n,treeData:e.getDataSet(),showSearch:t.showSearch!==!1,treeDefaultExpandAll:t.treeDefaultExpandAll!==!1,disabled:t.disabled??t.readOnly,dropdownStyle:r,fieldNames:{label:t.titleRender?"__title":((s=t.fieldNames)==null?void 0:s.title)??"title",value:(u=t.fieldNames)!=null&&u.value?t.fieldNames.value:"id",children:(c=t.fieldNames)!=null&&c.children?t.fieldNames.children:"children"},treeNodeLabelProp:t.selectedLabelProp?t.selectedLabelProp:t.labelRender?"__label":((d=t.fieldNames)==null?void 0:d.title)??"title",treeNodeFilterProp:t.titleRender?"__title":((i=t.fieldNames)==null?void 0:i.title)??"title",filterTreeNode:(h,f)=>e.getIsAllFetched()?t.filterTreeNode?typeof t.filterTreeNode=="function"?t.filterTreeNode(h,f):t.filterTreeNode:l(h,f):!0,value:e.getInternalValue(),notFoundContent:t.notFoundContent??m.jsx(cr,{fetching:e.getIsFetching(),error:e.getFetchError(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),dropdownRender:t.dropdownRender??a,onClear:()=>{var h,f;(h=t.onClear)==null||h.call(t),e.setValues(null),(f=t.onClear)==null||f.call(t)},onChange:h=>{var v;const f=e.plainValueToNodes(h);e.setValues(f??null),(v=t.onChange)==null||v.call(t,f??null)},onDropdownVisibleChange:h=>{var f;h&&(t.fetchMode==="onUse"||t.fetchMode==="onUseForce")&&e.fetchData(""),(f=t.onDropdownVisibleChange)==null||f.call(t,h)},onSearch:h=>{var f;e.fetchData(h,!0),(f=t.onSearch)==null||f.call(t,h)}})},hr=e=>{const n=e.getProps().editFormProps,[r]=o.useState((n==null?void 0:n.apiRef)||{}),[a]=o.useState((n==null?void 0:n.formId)??"SelectItemEdit-"+lt());return[o.useMemo(()=>{if(!n)return;const u={...{width:400,minWidth:200,bodyHeight:200,bodyMinHeight:40},...n,apiRef:r,formId:a},c=u==null?void 0:u.onSubmitSuccess;return u.onSubmitSuccess=(d,i,h)=>{if(!i||(c==null?void 0:c(d,i,h))===!1)return;const f={...h.model.getFormDataSet()??{},...i};if(h.getFormProps().formMode==="update")e.updateNodes(f);else{const g=e.getValues(),C=g&&g.length>0?g[0]:void 0;e.addNodes(C,f)}e.setValues([f])},u},[n,r,a,e]),r]},vr=e=>o.useCallback(t=>{var a;if(!e.isMounted())return;const n=e.getProps();if(!n.noCacheFetchedData&&e.getIsAllFetched())return;if(n.minSearchLength&&t.length<n.minSearchLength){e.setSetMynSymbols(n.minSearchLength),e.setDataSet(void 0);return}e.setSetMynSymbols(0),e.setSetFetchError(null);const r=(a=n==null?void 0:n.onDataFetch)==null?void 0:a.call(n,t,e);if(!r){e.setIsAllFetched(!0);return}e.setIsFetching(!0),t||e.setDataSet(null),r.then(l=>{var s,u,c;e.isMounted()&&(e.setDataSet(l.data),e.setIsAllFetched(e.getIsAllFetched()||!t),e.getIsReady()||(e.setIsReady(!0),(s=n==null?void 0:n.onReady)==null||s.call(n)),e.setIsFetching(!1),(u=n==null?void 0:n.onDataFetchSuccess)==null||u.call(n,l,e),(c=n==null?void 0:n.onDataFetchComplete)==null||c.call(n,e))},l=>{e.isMounted()&&(e.setSetFetchError(l.message),e.setDataSet(void 0),e.setIsFetching(!1))})},[e]),gr=(e,t,n,r)=>{const a=o.useRef([]),[l,s]=o.useState(r?[]:null),[,u]=o.useState([]),c=mr(e,t,n),d=o.useCallback(i=>{if(!i){a.current=[],u([]),s(r?[]:null);return}if(!Ke(i)){const g={...i},C=c(g);a.current=[g],u([g]),s(r?C?[C]:[]:C??null);return}const h=[],f=[],v=[...i];for(const g of v){const C={...g},k=c(C);k&&(f.push(C),h.push(k))}r?(s(h),a.current=f,u(a.current)):(s(h.length>0?h[0]:null),a.current=f.length>0?[f[0]]:[],u(a.current))},[c,r,a]);return[l,a,d]},mr=(e,t,n)=>o.useCallback(r=>{if(!r)return null;const a=(e==null?void 0:e.value)??"id",l=r[a];let s;if(t)s=t(r);else{const u=(e==null?void 0:e.title)??"title",c=n?"__title":"";s=r.label??void 0,!s&&c&&(s=r[c]),s||(s=r[u])}return{value:l,label:s??void 0}},[e==null?void 0:e.title,e==null?void 0:e.value,t,n]),Cr=(e,t,n)=>o.useCallback(r=>{if(!r)return;const a=(e==null?void 0:e.value)??"id",l=r;let s=t(l);if(s||(s=n(l),s))return s;const u={};return u[a]=r,u},[e,t,n]),Sr=e=>{const t=e.getProps(),n=br(e.getDataSet()),r=yr(e.getValues()),a=Cr(t.fieldNames,n,r);return o.useCallback(l=>{if(!l)return;const s=Ke(l)?l:[l],u=[];for(const c of s){const d=a(c);d&&u.push(d)}return u},[a])},br=e=>{const t=o.useRef();return t.current=e,o.useCallback(n=>{if(!t.current||!n)return;const r=(a,l)=>{for(const s of a){if(s.id===l)return s;if(!s.children)continue;const u=r(s.children,l);if(u)return u}};return r(t.current,n)},[])},yr=e=>{const t=o.useRef();return t.current=e,o.useCallback(n=>{if(!(!t.current||!n)){for(const r of t.current)if(r.id===n)return r}},[])},pr=(e,t,n)=>{const[r,a]=o.useState(),l=o.useCallback(s=>{if(!n.current)return;if(!s){a(void 0);return}let u;e||t?u=Vt(s,e,t):u=s,a(u)},[e,t,n]);return[r,l]},Vt=(e,t,n)=>{if(!e)return[];const r=[];for(const a of e){const l={...a};n&&(l.__label=n(a)),t&&(l.__title=t(a)),r.push(l),a.children&&(l.children=Vt(l.children,t,n))}return r},xr=({api:e,componentId:t,treeProps:n,updateProps:r,buttonsApi:a})=>{const l=rr(),[s,u]=pr(n.titleRender,n.labelRender,l),[c,d]=o.useState(!1),[i,h]=Qe.useState(!1),[f,v]=Qe.useState(""),[g,C]=Qe.useState(!1),[k,V]=Qe.useState(0),[H,R,x]=gr(n.fieldNames,n.labelRender,n.titleRender,n.multiple);e.buttonsApi=a,e.getId=Dr(t),e.isMounted=Ir(l),e.getProps=wr(n),e.setProps=kr(n,r),e.getInternalValue=Er(H),e.getValues=Fr(R),e.setValues=Nr(x,e),e.getDataSet=Mr(s),e.setDataSet=Tr(u),e.plainValueToNodes=Sr(e),e.getIsReady=Lr(c),e.setIsReady=Vr(d),e.getIsFetching=Ar(i),e.setIsFetching=_r(h),e.getFetchError=Rr(f),e.setSetFetchError=Or(v),e.getIsAllFetched=Kr(g),e.setIsAllFetched=jr(C),e.getMinSymbols=Hr(k),e.setSetMynSymbols=$r(V);const M=vr(e);e.fetchData=Wr(M,e),e.addNodes=Br(e),e.updateNodes=Gr(e),e.deleteNodes=Pr(e)},Dr=e=>o.useCallback(()=>e,[e]),Ir=e=>o.useCallback(()=>e.current,[e]),wr=e=>o.useCallback(()=>e,[e]),kr=(e,t)=>o.useCallback(n=>{t({...e,...n})},[e,t]),Er=e=>o.useCallback(()=>e,[e]),Fr=e=>o.useCallback(()=>e.current,[e]),Nr=(e,t)=>o.useCallback(n=>{var s,u,c,d;const r=t.getProps(),a=((s=r.fieldNames)==null?void 0:s.value)??"id";let l;typeof n!="string"?l=n:(l={},l[a]=n),e(l??[]),l?r.multiple?(d=r==null?void 0:r.onChange)==null||d.call(r,l||[]):(c=r==null?void 0:r.onChange)==null||c.call(r,Ke(l)&&l.length>0?l[0]:l):(u=r==null?void 0:r.onChange)==null||u.call(r,null)},[t,e]),Mr=e=>o.useCallback(()=>e,[e]),Tr=e=>o.useCallback(t=>{e(t??[])},[e]),Lr=e=>o.useCallback(()=>e,[e]),Vr=e=>o.useCallback(t=>{e(t)},[e]),Ar=e=>o.useCallback(()=>e,[e]),_r=e=>o.useCallback(t=>{e(t)},[e]),Rr=e=>o.useCallback(()=>e,[e]),Or=e=>o.useCallback(t=>{e(t??"")},[e]),Kr=e=>o.useCallback(()=>e,[e]),jr=e=>o.useCallback(t=>{e(t)},[e]),Hr=e=>o.useCallback(()=>e,[e]),$r=e=>o.useCallback(t=>{e(t)},[e]),Wr=(e,t)=>o.useCallback((n,r)=>{const a=an(e,t.getProps().debounce??0);r?a(n):e(n)},[t,e]),Br=e=>o.useCallback((t,n)=>{var d,i;const r=Ke(n)?n:[n],a=e.getProps(),l=((d=a.fieldNames)==null?void 0:d.value)??"id",s=((i=a.fieldNames)==null?void 0:i.children)??"children",u=(h,f,v)=>{if(!f){for(const g of v)h.push(g);return}for(const g of h)if(g[l]){if(g[l]===f[l]){if(g.isLeaf)for(const C of v)h.push(C);else{g[s]||(g[s]=[]);const C=g[s];for(const k of v)C.push(k)}return!0}if(g[s]&&u(g[s],f,v))return!0}},c=[...e.getDataSet()??[]];for(const h of r)h[l]||(h[l]=lt());u(c,t,r),e.setDataSet(c)},[e]),Gr=e=>o.useCallback(t=>{var c,d;const n=Ke(t)?t:[t],r=e.getProps(),a=((c=r.fieldNames)==null?void 0:c.value)??"id",l=((d=r.fieldNames)==null?void 0:d.children)??"children",s=(i,h)=>{for(const f of i)if(f[a]){if(f[a]===h[a]){const v=f[l];for(const g in h)f[g]=h[g];return f[l]=v,!0}if(f[l]&&s(f[l],h))return!0}},u=[...e.getDataSet()??[]];for(const i of n)s(u,i);e.setDataSet(u)},[e]),Pr=e=>o.useCallback(t=>{var c,d;const n=Ke(t)?t:[t],r=e.getProps(),a=((c=r.fieldNames)==null?void 0:c.value)??"id",l=((d=r.fieldNames)==null?void 0:d.children)??"children",s=(i,h)=>{for(let f=i.length-1;f>=0;f--){const v=i[f];if(v[a]){if(v[a]===h[a])return i.splice(f,1),!0;if(v[l]&&s(v[l],h))return!0}}},u=[...e.getDataSet()??[]];for(const i of n)s(u,i);e.setDataSet(u)},[e]),zr=(e,t)=>{const n=e.getValues(),r=e.getProps();return o.useMemo(()=>{const a={add:{icon:m.jsx(on,{}),tooltip:"Добавить",position:"left",onClick:()=>{t.open("create")}},edit:{icon:m.jsx(Vn,{}),tooltip:"Редактировать",position:"center",disabled:!n||n.length!==1,onClick:()=>{const l=e.getValues();l.length===1&&t.open("update",l[0])}},delete:{icon:m.jsx(Mn,{}),tooltip:"Удалить",position:"right",disabled:!n||n.length<1,onClick:()=>{Ur(e)}}};return ln(a,r.editButtons)},[e,t,n,r.editButtons])},Ur=e=>{const t=e.getProps(),n=e.getValues();if(n.length<1)return;let r;const a=()=>{var s;const l=(s=t==null?void 0:t.onDelete)==null?void 0:s.call(t,n,e);if(sn(l)){t.confirmDelete||(e.buttonsApi.loading("delete",!0),e.buttonsApi.disabled("add",!0),e.buttonsApi.disabled("edit",!0)),l.then(()=>{e.isMounted()&&(e.deleteNodes(n),e.setValues(null),t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("delete",!0),e.buttonsApi.disabled("add",!1)))}).catch(c=>{e.isMounted()&&(t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("add",!1),e.buttonsApi.disabled("edit",!1)),yt.alert({content:m.jsxs(m.Fragment,{children:[m.jsx("p",{children:m.jsx("b",{children:c.message})}),c.stack&&un()?m.jsx("p",{children:c.stack}):""]}),colorType:"danger"}))});return}e.deleteNodes(n),e.setValues(null),r&&r.destroy()};t.confirmDelete?r=yt.confirmWaiter({content:t.nodeDeleteMessage??"Удалить выбранные строки?",onOk:a}):a()},qr=e=>{const[t,n]=cn(e),[r]=o.useState(t.treeSelectId??"treeSelect-"+lt()),[a]=o.useState(t.apiRef??{}),[l]=o.useState({});xr({api:a,componentId:r,treeProps:t,updateProps:n,buttonsApi:l});const[s,u]=hr(a),c=zr(a,u),d=Xr(e);return o.useEffect(()=>{a.setIsAllFetched(!1),a.setDataSet(void 0),a.setValues(null)},[a]),o.useEffect(()=>{a.setDataSet(t.dataSet)},[a.setDataSet,a,t.dataSet]),o.useEffect(()=>{a.setValues(t.value??null)},[a,t.value]),o.useEffect(()=>{var i;if((!t.fetchMode||t.fetchMode==="onLoad")&&!t.minSearchLength){a.fetchData("");return}a.getIsReady()||(i=t==null?void 0:t.onReady)==null||i.call(t)},[a,t,t.fetchMode,t.minSearchLength]),!s||t.readOnly||t.disabled?m.jsx(It,{api:a,treeSelectProps:e,antdTreeSelectProps:d}):m.jsxs(dn,{wrap:!1,children:[m.jsx(It,{api:a,treeSelectProps:e,antdTreeSelectProps:d}),m.jsx(fn,{children:m.jsx(hn,{buttons:c,apiRef:l,context:a})}),m.jsx(gn,{...s})]})},Xr=e=>o.useMemo(()=>Ft(e,{apiRef:!0,treeSelectId:!0,readOnly:!0,value:!0,defaultValueCallback:!0,titleRender:!0,labelRender:!0,filterTreeNode:!0,dataSet:!0,fetchMode:!0,noCacheFetchedData:!0,minSearchLength:!0,debounce:!0,selectedLabelProp:!0,fieldNames:!0,editFormProps:!0,nodeDeleteMessage:!0,confirmDelete:!0,editButtons:!0,plainList:!0,onReady:!0,onChange:!0,onClear:!0,onDataFetch:!0,onDataFetchSuccess:!0,onDataFetchError:!0,onDataFetchComplete:!0,onDelete:!0})[1],[e]),Yr=({field:e})=>{o.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const t=e.getProps(),n=e.getValue(),r=Jr(t),a=o.useCallback(c=>{var d;e.isReady()&&(e.setValue(c??null),e.setDirty(!0)),(d=t.onChange)==null||d.call(t,c)},[e,t]),l=o.useCallback(()=>{e.setTouched(!0)},[e]),s=o.useCallback(()=>{var c;e.setDirty(!0),e.setTouched(!0),(c=t.onClear)==null||c.call(t)},[e,t]);o.useEffect(()=>{e.setReady(!0)},[e]);const u={width:t.width??"100%",...t.style};return m.jsx(qr,{style:u,...r,autoFocus:t.autoFocus,defaultValueCallback:t.defaultValueCallback,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:n,placeholder:t.placeholder??"Choose",allowClear:t.allowClear!==!1,onChange:a,onClear:s,onBlur:l,onDataFetch:t.onDataFetch,onDataFetchComplete:t.onDataFetchComplete,onDataFetchError:t.onDataFetchError,onDataFetchSuccess:t.onDataFetchSuccess,onDelete:t.onDelete,onReady:()=>{var c;return(c=t.onReady)==null?void 0:c.call(t,e)},onKeyUp:t.onKeyUp,onKeyDown:t.onKeyDown,onClick:t.onClick,onSelect:t.onSelect,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseDown:t.onMouseDown,onFocus:t.onFocus,onDeselect:t.onDeselect,onDropdownVisibleChange:t.onDropdownVisibleChange,onInputKeyDown:t.onInputKeyDown,onTreeExpand:t.onTreeExpand,onPopupScroll:t.onPopupScroll,onSearch:t.onSearch,onTreeLoad:t.onTreeLoad})},Jr=e=>o.useMemo(()=>Ft(e,{component:!0,helpClass:!0,label:!0,placeholder:!0,tab:!0,inlineGroup:!0,value:!0,hidden:!0,dependsOn:!0,width:!0,autoFocus:!0,style:!0,tooltip:!0,disabled:!0,requiredMark:!0,readOnly:!0,rowStyle:!0,autoHeightResize:!0,onDirtyStateChanged:!0,onReady:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,onTouchedStateChanged:!0,onValidated:!0,onValueChanged:!0,onReadyStateChanged:!0,rules:!0})[1],[e]);class aa extends vn{render(){return m.jsx(Yr,{field:this})}}export{aa as T};
