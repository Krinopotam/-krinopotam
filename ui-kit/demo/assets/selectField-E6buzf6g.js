import{r as a,C as Ne,P as Ee,ae as Me,m as _e,F as je,o as De,f as V,G as Fe,l as Re,aa as Te,bm as Be,j as M}from"./index-Cpuh8Ebd.js";import{a as W,B as ze}from"./dForm-t1Ccos62.js";import{s as Ve}from"./dFormModal-iIvnEeWS.js";import{O as We,a as $e,u as ke,b as He,D as Ae,T as Ge,m as Ue}from"./useShowArrow-CyhrQEeE.js";import{j as Le}from"./buttonsRow-MpDC2SN8.js";import{j as Xe,k as Ye,g as Ze}from"./index-DNdv76Wr.js";import{u as qe}from"./useIcons-BgIqUolS.js";var Je=function(e,n){var s={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(s[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(s[t[o]]=e[t[o]]);return s};const $="SECRET_COMBOBOX_MODE_DO_NOT_USE",Ke=(e,n)=>{var s;const{prefixCls:t,bordered:o,className:l,rootClassName:r,getPopupContainer:h,popupClassName:f,dropdownClassName:k,listHeight:H=256,placement:g,listItemHeight:p,size:O,disabled:v,notFoundContent:_,status:A,builtinPlacements:G,dropdownMatchSelectWidth:U,popupMatchSelectWidth:x,direction:y,style:L,allowClear:j,variant:X,dropdownStyle:S,transitionName:Y,tagRender:Z,maxCount:q}=e,D=Je(e,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount"]),{getPopupContainer:J,getPrefixCls:F,renderEmpty:P,direction:K,virtual:Q,popupMatchSelectWidth:ee,popupOverflow:te,select:c}=a.useContext(Ne),[,w]=Ee(),oe=p??(w==null?void 0:w.controlHeight),i=F("select",t),ne=F(),u=y??K,{compactSize:se,compactItemClassnames:ae}=Me(i,u),[le,re]=Xe("select",X,o),I=_e(i),[ie,R,T]=ke(i,I),C=a.useMemo(()=>{const{mode:m}=e;if(m!=="combobox")return m===$?"combobox":m},[e.mode]),N=C==="multiple"||C==="tags",ce=He(e.suffixIcon,e.showArrow),ue=(s=x??U)!==null&&s!==void 0?s:ee,{status:de,hasFeedback:B,isFormItemInput:me,feedbackIcon:Se}=a.useContext(je),Ce=Ze(de,A);let b;_!==void 0?b=_:C==="combobox"?b=null:b=(P==null?void 0:P("Select"))||a.createElement(Ae,{componentName:"Select"});const{suffixIcon:be,itemIcon:he,removeIcon:fe,clearIcon:ge}=qe(Object.assign(Object.assign({},D),{multiple:N,hasFeedback:B,feedbackIcon:Se,showSuffixIcon:ce,prefixCls:i,componentName:"Select"})),pe=j===!0?{clearIcon:ge}:j,Oe=De(D,["suffixIcon","itemIcon"]),ve=V(f||k,{[`${i}-dropdown-${u}`]:u==="rtl"},r,T,I,R),z=Fe(m=>{var E;return(E=O??se)!==null&&E!==void 0?E:m}),xe=a.useContext(Re),ye=v??xe,Pe=V({[`${i}-lg`]:z==="large",[`${i}-sm`]:z==="small",[`${i}-rtl`]:u==="rtl",[`${i}-${le}`]:re,[`${i}-in-form-item`]:me},Ye(i,Ce,B),ae,c==null?void 0:c.className,l,r,T,I,R),we=a.useMemo(()=>g!==void 0?g:u==="rtl"?"bottomRight":"bottomLeft",[g,u]),[Ie]=Te("SelectLike",S==null?void 0:S.zIndex);return ie(a.createElement(Ge,Object.assign({ref:n,virtual:Q,showSearch:c==null?void 0:c.showSearch},Oe,{style:Object.assign(Object.assign({},c==null?void 0:c.style),L),dropdownMatchSelectWidth:ue,transitionName:Be(ne,"slide-up",Y),builtinPlacements:Ue(G,te),listHeight:H,listItemHeight:oe,mode:C,prefixCls:i,placement:we,direction:u,suffixIcon:be,menuItemSelectedIcon:he,removeIcon:fe,allowClear:pe,notFoundContent:b,className:Pe,getPopupContainer:h||J,dropdownClassName:ve,disabled:ye,dropdownStyle:Object.assign(Object.assign({},S),{zIndex:Ie}),maxCount:N?q:void 0,tagRender:N?Z:void 0})))},d=a.forwardRef(Ke),Qe=Le(d);d.SECRET_COMBOBOX_MODE_DO_NOT_USE=$;d.Option=We;d.OptGroup=$e;d._InternalPanelDoNotUseOrYouWillBeFired=Qe;const et=e=>{const n=nt(e),s=tt(e),t=ot(e,e.value);return M.jsx(d,{...n,options:s,value:t,disabled:e.disabled||e.readOnly,optionFilterProp:e.optionFilterProp??"label",showSearch:e.showSearch!==!1,onSelect:(o,l)=>{var r;return(r=e.onSelect)==null?void 0:r.call(e,o,l)},onDeselect:(o,l)=>{var r;return(r=e.onDeselect)==null?void 0:r.call(e,o,l)},onChange:(o,l)=>{var r;return(r=e.onChange)==null?void 0:r.call(e,o,l)},children:e.children})},tt=e=>a.useMemo(()=>{if(!e.dataSet)return;const n=s=>{const t=[];if(!(!s||!W(s))){for(const o of s){const l={...o};o.id&&(l.value=o.id),o.label&&(l.label=o.label),o.children&&(l.children=n(o.children)),t.push(l)}return t}};return n(e.dataSet)},[e.dataSet]),ot=(e,n)=>a.useMemo(()=>{if(typeof n>"u")return;if(!W(n))return typeof n=="object"?{value:n.id??"0",label:n.label}:n;const s=[];for(const t of n)typeof t=="object"?s.push({value:t.id,label:t.label}):s.push(t);return s},[n]),nt=e=>a.useMemo(()=>Ve(e,{dataSet:!0,value:!0,readOnly:!0,onSelect:!0,onDeselect:!0,onChange:!0})[1],[e]),st=({field:e})=>{a.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const n=e.getProps(),s=e.getValue(),t=a.useCallback((h,f)=>{e.isReady()&&(n.fullItemValue?e.setValue(f):e.setValue(h),e.setDirty(!0))},[e]),o=a.useCallback(()=>{e.setTouched(!0)},[e]);a.useEffect(()=>{e.setReady(!0)},[e]);const r={...{width:e.getWidth()??"100%"},...n.style};return M.jsx(et,{allowClear:!0,...n,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:s,style:r,onBlur:o,onChange:t})};class mt extends ze{render(){return M.jsx(st,{field:this})}}export{mt as S};
