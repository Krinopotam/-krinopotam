import{r as o,B as H,n as he,t as Bt,i as Et,w as nt,h as Pt,bz as Ut,f as ve,K as $e,_ as Ft,k as Ct,l as qt,g as Jt,m as Mt,u as St,o as Xt,H as Yt,G as bt,a as yt,L as Zt,A as Qt,v as en,J as tn,aA as nn,aK as pt,j as m,R as tt}from"./index-CRRPgvdi.js";import{g as rn,S as an,G as ut,I as He,r as on,R as ln,M as sn,m as Dt,b as un,c as cn,u as dn,d as fn,C as hn,e as vn,f as Nt,a as gn}from"./index-CR3eF2D1.js";import{D as mn}from"./dFormModal-Df9g-P_m.js";import{u as Cn,a as Sn,B as bn,b as yn,D as pn,m as Dn,c as xn}from"./useShowArrow-Cy7EkWLx.js";import{c as ot,a as In,T as kn,i as wn,g as En,b as Fn,S as Mn,R as Nn}from"./DeleteOutlined-CzvauNsJ.js";import{f as Tn,j as Rn,g as Ln,R as Vn}from"./docco-COLmzWzy.js";import{u as An}from"./useIcons-BN1b1-Dw.js";const _n=function(e){var t=o.useRef({valueLabels:new Map});return o.useMemo(function(){var n=t.current.valueLabels,r=new Map,a=e.map(function(l){var s,c=l.value,u=(s=l.label)!==null&&s!==void 0?s:n.get(c);return r.set(c,u),H(H({},l),{},{label:u})});return t.current.valueLabels=r,[a]},[e])},On=function(e,t,n,r){return o.useMemo(function(){var a=e.map(function(u){var i=u.value;return i}),l=t.map(function(u){var i=u.value;return i}),s=a.filter(function(u){return!r[u]});if(n){var c=ot(a,!0,r);a=c.checkedKeys,l=c.halfCheckedKeys}return[Array.from(new Set([].concat(he(s),he(a)))),l]},[e,t,n,r])};function Kn(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function jn(e){var t=e||{},n=t.label,r=t.value,a=t.children,l=r||"value";return{_title:n?[n]:["title","label"],value:l,key:l,children:a||"children"}}function lt(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function $n(e,t){var n=[];function r(a){a.forEach(function(l){var s=l[t.children];s&&(n.push(l[t.value]),r(s))})}return r(e),n}function xt(e){return e==null}const Hn=function(e,t){return o.useMemo(function(){var n=In(e,{fieldNames:t,initWrapper:function(a){return H(H({},a),{},{valueEntities:new Map})},processEntity:function(a,l){var s=a.node[t.value];l.valueEntities.set(s,a)}});return n},[e,t])};var ct=function(){return null},Wn=["children","value"];function Tt(e){return Bt(e).map(function(t){if(!o.isValidElement(t)||!t.type)return null;var n=t,r=n.key,a=n.props,l=a.children,s=a.value,c=Et(a,Wn),u=H({key:r,value:s},c),i=Tt(l);return i.length&&(u.children=i),u}).filter(function(t){return t})}function st(e){if(!e)return e;var t=H({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return nt(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function Gn(e,t,n,r,a,l){var s=null,c=null;function u(){function i(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(v,g){var b="".concat(h,"-").concat(g),w=v[l.value],A=n.includes(w),W=i(v[l.children]||[],b,A),_=o.createElement(ct,v,W.map(function(O){return O.node}));if(t===w&&(s=_),A){var P={pos:b,node:_,children:W};return f||c.push(P),P}return null}).filter(function(v){return v})}c||(c=[],i(r),c.sort(function(d,h){var f=d.node.props.value,v=h.node.props.value,g=n.indexOf(f),b=n.indexOf(v);return g-b}))}Object.defineProperty(e,"triggerNode",{get:function(){return nt(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),u(),s}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return nt(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),u(),a?c:c.map(function(d){var h=d.node;return h})}})}const zn=function(e,t,n){var r=n.treeNodeFilterProp,a=n.filterTreeNode,l=n.fieldNames,s=l.children;return o.useMemo(function(){if(!t||a===!1)return e;var c;if(typeof a=="function")c=a;else{var u=t.toUpperCase();c=function(h,f){var v=f[r];return String(v).toUpperCase().includes(u)}}function i(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.reduce(function(f,v){var g=v[s],b=h||c(t,st(v)),w=i(g||[],b);return(b||w.length)&&f.push(H(H({},v),{},Pt({isLeaf:void 0},s,w))),f},[])}return i(e)},[e,t,s,r,a])};function It(e){var t=o.useRef();t.current=e;var n=o.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}function Bn(e,t){var n=t.id,r=t.pId,a=t.rootPId,l={},s=[],c=e.map(function(u){var i=H({},u),d=i[n];return l[d]=i,i.key=i.key||d,i});return c.forEach(function(u){var i=u[r],d=l[i];d&&(d.children=d.children||[],d.children.push(u)),(i===a||!d&&a===null)&&s.push(u)}),s}function Pn(e,t,n){return o.useMemo(function(){return e?n?Bn(e,H({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:Tt(t)},[t,n,e])}var Rt=o.createContext(null),Lt=o.createContext(null),Un={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},qn=function(t,n){var r=Cn(),a=r.prefixCls,l=r.multiple,s=r.searchValue,c=r.toggleOpen,u=r.open,i=r.notFoundContent,d=o.useContext(Lt),h=d.virtual,f=d.listHeight,v=d.listItemHeight,g=d.listItemScrollOffset,b=d.treeData,w=d.fieldNames,A=d.onSelect,W=d.dropdownMatchSelectWidth,_=d.treeExpandAction,P=d.treeTitleRender,O=d.onPopupScroll,D=o.useContext(Rt),G=D.checkable,T=D.checkedKeys,Ne=D.halfCheckedKeys,ge=D.treeExpandedKeys,me=D.treeDefaultExpandAll,Ce=D.treeDefaultExpandedKeys,Se=D.onTreeExpand,X=D.treeIcon,Te=D.showTreeIcon,Y=D.switcherIcon,Re=D.treeLine,Z=D.treeNodeFilterProp,ae=D.loadData,z=D.treeLoadedKeys,Le=D.treeMotion,Ve=D.onTreeLoad,Ae=D.keyEntities,U=o.useRef(),F=Ut(function(){return b},[u,b],function(E,C){return C[0]&&E[1]!==C[1]}),be=o.useState(null),K=ve(be,2),oe=K[0],le=K[1],R=Ae[oe],se=o.useMemo(function(){return G?{checked:T,halfChecked:Ne}:null},[G,T,Ne]);o.useEffect(function(){if(u&&!l&&T.length){var E;(E=U.current)===null||E===void 0||E.scrollTo({key:T[0]}),le(T[0])}},[u]);var ye=String(s).toLowerCase(),pe=function(C){return ye?String(C[Z]).toLowerCase().includes(ye):!1},De=o.useState(Ce),Q=ve(De,2),xe=Q[0],We=Q[1],Ge=o.useState(null),B=ve(Ge,2),ee=B[0],Ie=B[1],j=o.useMemo(function(){return ge?he(ge):s?ee:xe},[xe,ee,ge,s]);o.useEffect(function(){s&&Ie($n(b,w))},[s]);var _e=function(C){We(C),Ie(C),Se&&Se(C)},ke=function(C){C.preventDefault()},q=function(C,ue){var $=ue.node;G&&lt($)||(A($.key,{selected:!T.includes($.key)}),l||c(!1))};if(o.useImperativeHandle(n,function(){var E;return{scrollTo:(E=U.current)===null||E===void 0?void 0:E.scrollTo,onKeyDown:function(ue){var $,ce=ue.which;switch(ce){case $e.UP:case $e.DOWN:case $e.LEFT:case $e.RIGHT:($=U.current)===null||$===void 0||$.onKeyDown(ue);break;case $e.ENTER:{if(R){var Ee=(R==null?void 0:R.node)||{},ze=Ee.selectable,te=Ee.value;ze!==!1&&q(null,{node:{key:oe},selected:!T.includes(te)})}break}case $e.ESC:c(!1)}},onKeyUp:function(){}}}),F.length===0)return o.createElement("div",{role:"listbox",className:"".concat(a,"-empty"),onMouseDown:ke},i);var we={fieldNames:w};return z&&(we.loadedKeys=z),j&&(we.expandedKeys=j),o.createElement("div",{onMouseDown:ke},R&&u&&o.createElement("span",{style:Un,"aria-live":"assertive"},R.node.value),o.createElement(kn,Ft({ref:U,focusable:!1,prefixCls:"".concat(a,"-tree"),treeData:F,height:f,itemHeight:v,itemScrollOffset:g,virtual:h!==!1&&W!==!1,multiple:l,icon:X,showIcon:Te,switcherIcon:Y,showLine:Re,loadData:s?null:ae,motion:Le,activeKey:oe,checkable:G,checkStrictly:!0,checkedKeys:se,selectedKeys:G?[]:T,defaultExpandAll:me,titleRender:P},we,{onActiveChange:le,onSelect:q,onCheck:q,onExpand:_e,onLoad:Ve,filterTreeNode:pe,expandAction:_,onScroll:O})))},Jn=o.forwardRef(qn),it="SHOW_ALL",dt="SHOW_PARENT",rt="SHOW_CHILD";function kt(e,t,n,r){var a=new Set(e);return t===rt?e.filter(function(l){var s=n[l];return!(s&&s.children&&s.children.some(function(c){var u=c.node;return a.has(u[r.value])})&&s.children.every(function(c){var u=c.node;return lt(u)||a.has(u[r.value])}))}):t===dt?e.filter(function(l){var s=n[l],c=s?s.parent:null;return!(c&&!lt(c.node)&&a.has(c.key))}):e}var Xn=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender","onPopupScroll"];function Yn(e){return!e||qt(e)!=="object"}var Zn=o.forwardRef(function(e,t){var n=e.id,r=e.prefixCls,a=r===void 0?"rc-tree-select":r,l=e.value,s=e.defaultValue,c=e.onChange,u=e.onSelect,i=e.onDeselect,d=e.searchValue,h=e.inputValue,f=e.onSearch,v=e.autoClearSearchValue,g=v===void 0?!0:v,b=e.filterTreeNode,w=e.treeNodeFilterProp,A=w===void 0?"value":w,W=e.showCheckedStrategy,_=e.treeNodeLabelProp,P=e.multiple,O=e.treeCheckable,D=e.treeCheckStrictly,G=e.labelInValue,T=e.fieldNames,Ne=e.treeDataSimpleMode,ge=e.treeData,me=e.children,Ce=e.loadData,Se=e.treeLoadedKeys,X=e.onTreeLoad,Te=e.treeDefaultExpandAll,Y=e.treeExpandedKeys,Re=e.treeDefaultExpandedKeys,Z=e.onTreeExpand,ae=e.treeExpandAction,z=e.virtual,Le=e.listHeight,Ve=Le===void 0?200:Le,Ae=e.listItemHeight,U=Ae===void 0?20:Ae,F=e.listItemScrollOffset,be=F===void 0?0:F,K=e.onDropdownVisibleChange,oe=e.dropdownMatchSelectWidth,le=oe===void 0?!0:oe,R=e.treeLine,se=e.treeIcon,ye=e.showTreeIcon,pe=e.switcherIcon,De=e.treeMotion,Q=e.treeTitleRender,xe=e.onPopupScroll,We=Et(e,Xn),Ge=Sn(n),B=O&&!D,ee=O||D,Ie=D||G,j=ee||P,_e=Ct(s,{value:l}),ke=ve(_e,2),q=ke[0],we=ke[1],E=o.useMemo(function(){return O?W||rt:it},[W,O]),C=o.useMemo(function(){return jn(T)},[JSON.stringify(T)]),ue=Ct("",{value:d!==void 0?d:h,postState:function(S){return S||""}}),$=ve(ue,2),ce=$[0],Ee=$[1],ze=function(S){Ee(S),f==null||f(S)},te=Pn(ge,me,Ne),qe=Hn(te,C),N=qe.keyEntities,ne=qe.valueEntities,Je=o.useCallback(function(y){var S=[],p=[];return y.forEach(function(I){ne.has(I)?p.push(I):S.push(I)}),{missingRawValues:S,existRawValues:p}},[ne]),Xe=zn(te,ce,{fieldNames:C,treeNodeFilterProp:A,filterTreeNode:b}),Ye=o.useCallback(function(y){if(y){if(_)return y[_];for(var S=C._title,p=0;p<S.length;p+=1){var I=y[S[p]];if(I!==void 0)return I}}},[C,_]),re=o.useCallback(function(y){var S=Kn(y);return S.map(function(p){return Yn(p)?{value:p}:p})},[]),ie=o.useCallback(function(y){var S=re(y);return S.map(function(p){var I=p.label,L=p.value,M=p.halfChecked,k,x=ne.get(L);if(x){var V;I=(V=I)!==null&&V!==void 0?V:Ye(x.node),k=x.node.disabled}else if(I===void 0){var de=re(q).find(function(Be){return Be.value===L});I=de.label}return{label:I,value:L,halfChecked:M,disabled:k}})},[ne,Ye,re,q]),ft=o.useMemo(function(){return re(q)},[re,q]),At=o.useMemo(function(){var y=[],S=[];return ft.forEach(function(p){p.halfChecked?S.push(p):y.push(p)}),[y,S]},[ft]),ht=ve(At,2),Oe=ht[0],vt=ht[1],gt=o.useMemo(function(){return Oe.map(function(y){return y.value})},[Oe]),_t=On(Oe,vt,B,N),mt=ve(_t,2),Ke=mt[0],Ze=mt[1],Ot=o.useMemo(function(){var y=kt(Ke,E,N,C),S=y.map(function(M){var k,x;return(k=(x=N[M])===null||x===void 0||(x=x.node)===null||x===void 0?void 0:x[C.value])!==null&&k!==void 0?k:M}),p=S.map(function(M){var k=Oe.find(function(V){return V.value===M}),x;return G&&k.label!==void 0?x=k.label:!G&&Q&&(x=Q(k)),{value:M,label:x}}),I=ie(p),L=I[0];return!j&&L&&xt(L.value)&&xt(L.label)?[]:I.map(function(M){var k;return H(H({},M),{},{label:(k=M.label)!==null&&k!==void 0?k:M.value})})},[C,j,Ke,Oe,ie,E,N]),Kt=_n(Ot),jt=ve(Kt,1),$t=jt[0],Qe=It(function(y,S,p){var I=ie(y);if(we(I),g&&Ee(""),c){var L=y;if(B){var M=kt(y,E,N,C);L=M.map(function(J){var fe=ne.get(J);return fe?fe.node[C.value]:J})}var k=S||{triggerValue:void 0,selected:void 0},x=k.triggerValue,V=k.selected,de=L;if(D){var Be=vt.filter(function(J){return!L.includes(J.value)});de=[].concat(he(de),he(Be))}var Pe=ie(de),Fe={preValue:Oe,triggerValue:x},je=!0;(D||p==="selection"&&!V)&&(je=!1),Gn(Fe,x,y,te,je,C),ee?Fe.checked=V:Fe.selected=V;var et=Ie?Pe:Pe.map(function(J){return J.value});c(j?et:et[0],Ie?null:Pe.map(function(J){return J.label}),Fe)}}),at=o.useCallback(function(y,S){var p,I=S.selected,L=S.source,M=N[y],k=M==null?void 0:M.node,x=(p=k==null?void 0:k[C.value])!==null&&p!==void 0?p:y;if(!j)Qe([x],{selected:!0,triggerValue:x},"option");else{var V=I?[].concat(he(gt),[x]):Ke.filter(function(fe){return fe!==x});if(B){var de=Je(V),Be=de.missingRawValues,Pe=de.existRawValues,Fe=Pe.map(function(fe){return ne.get(fe).key}),je;if(I){var et=ot(Fe,!0,N);je=et.checkedKeys}else{var J=ot(Fe,{checked:!1,halfCheckedKeys:Ze},N);je=J.checkedKeys}V=[].concat(he(Be),he(je.map(function(fe){return N[fe].node[C.value]})))}Qe(V,{selected:I,triggerValue:x},L||"option")}I||!j?u==null||u(x,st(k)):i==null||i(x,st(k))},[Je,ne,N,C,j,gt,Qe,B,u,i,Ke,Ze]),Ht=o.useCallback(function(y){if(K){var S={};Object.defineProperty(S,"documentClickClose",{get:function(){return nt(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),K(y,S)}},[K]),Wt=It(function(y,S){var p=y.map(function(I){return I.value});if(S.type==="clear"){Qe(p,{},"selection");return}S.values.length&&at(S.values[0].value,{selected:!1,source:"selection"})}),Gt=o.useMemo(function(){return{virtual:z,dropdownMatchSelectWidth:le,listHeight:Ve,listItemHeight:U,listItemScrollOffset:be,treeData:Xe,fieldNames:C,onSelect:at,treeExpandAction:ae,treeTitleRender:Q,onPopupScroll:xe}},[z,le,Ve,U,be,Xe,C,at,ae,Q,xe]),zt=o.useMemo(function(){return{checkable:ee,loadData:Ce,treeLoadedKeys:Se,onTreeLoad:X,checkedKeys:Ke,halfCheckedKeys:Ze,treeDefaultExpandAll:Te,treeExpandedKeys:Y,treeDefaultExpandedKeys:Re,onTreeExpand:Z,treeIcon:se,treeMotion:De,showTreeIcon:ye,switcherIcon:pe,treeLine:R,treeNodeFilterProp:A,keyEntities:N}},[ee,Ce,Se,X,Ke,Ze,Te,Y,Re,Z,se,De,ye,pe,R,A,N]);return o.createElement(Lt.Provider,{value:Gt},o.createElement(Rt.Provider,{value:zt},o.createElement(bn,Ft({ref:t},We,{id:Ge,prefixCls:a,mode:j?"multiple":void 0,displayValues:$t,onDisplayValuesChange:Wt,searchValue:ce,onSearch:ze,OptionList:Jn,emptyOptions:!te.length,onDropdownVisibleChange:Ht,dropdownMatchSelectWidth:le}))))}),Ue=Zn;Ue.TreeNode=ct;Ue.SHOW_ALL=it;Ue.SHOW_PARENT=dt;Ue.SHOW_CHILD=rt;const Qn=e=>{const{componentCls:t,treePrefixCls:n,colorBgElevated:r}=e,a=`.${n}`;return[{[`${t}-dropdown`]:[{padding:`${St(e.paddingXS)} ${St(e.calc(e.paddingXS).div(2).equal())}`},En(n,Mt(e,{colorBgContainer:r})),{[a]:{borderRadius:0,[`${a}-list-holder-inner`]:{alignItems:"stretch",[`${a}-treenode`]:{[`${a}-node-content-wrapper`]:{flex:"auto"}}}}},Fn(`${n}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${a}-switcher${a}-switcher_close`]:{[`${a}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function er(e,t,n){return Jt("TreeSelect",r=>{const a=Mt(r,{treePrefixCls:t});return[Qn(a)]},wn)(e,n)}var tr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};const nr=(e,t)=>{var n,{prefixCls:r,size:a,disabled:l,bordered:s=!0,className:c,rootClassName:u,treeCheckable:i,multiple:d,listHeight:h=256,listItemHeight:f=26,placement:v,notFoundContent:g,switcherIcon:b,treeLine:w,getPopupContainer:A,popupClassName:W,dropdownClassName:_,treeIcon:P=!1,transitionName:O,choiceTransitionName:D="",status:G,treeExpandAction:T,builtinPlacements:Ne,dropdownMatchSelectWidth:ge,popupMatchSelectWidth:me,allowClear:Ce,variant:Se,dropdownStyle:X,tagRender:Te}=e,Y=tr(e,["prefixCls","size","disabled","bordered","className","rootClassName","treeCheckable","multiple","listHeight","listItemHeight","placement","notFoundContent","switcherIcon","treeLine","getPopupContainer","popupClassName","dropdownClassName","treeIcon","transitionName","choiceTransitionName","status","treeExpandAction","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","allowClear","variant","dropdownStyle","tagRender"]);const{getPopupContainer:Re,getPrefixCls:Z,renderEmpty:ae,direction:z,virtual:Le,popupMatchSelectWidth:Ve,popupOverflow:Ae}=o.useContext(Xt),U=Z(),F=Z("select",r),be=Z("select-tree",r),K=Z("tree-select",r),{compactSize:oe,compactItemClassnames:le}=Yt(F,z),R=bt(F),se=bt(K),[ye,pe,De]=yn(F,R),[Q]=er(K,be,se),[xe,We]=Tn(Se,s),Ge=yt(W||_,`${K}-dropdown`,{[`${K}-dropdown-rtl`]:z==="rtl"},u,De,R,se,pe),B=!!(i||d),ee=xn(Y.suffixIcon,Y.showArrow),Ie=(n=me??ge)!==null&&n!==void 0?n:Ve,{status:j,hasFeedback:_e,isFormItemInput:ke,feedbackIcon:q}=o.useContext(Zt),we=Ln(j,G),{suffixIcon:E,removeIcon:C,clearIcon:ue}=An(Object.assign(Object.assign({},Y),{multiple:B,showSuffixIcon:ee,hasFeedback:_e,feedbackIcon:q,prefixCls:F,componentName:"TreeSelect"})),$=Ce===!0?{clearIcon:ue}:Ce;let ce;g!==void 0?ce=g:ce=(ae==null?void 0:ae("Select"))||o.createElement(pn,{componentName:"Select"});const Ee=Qt(Y,["suffixIcon","removeIcon","clearIcon","itemIcon","switcherIcon"]),ze=o.useMemo(()=>v!==void 0?v:z==="rtl"?"bottomRight":"bottomLeft",[v,z]),te=en(re=>{var ie;return(ie=a??oe)!==null&&ie!==void 0?ie:re}),qe=o.useContext(tn),N=l??qe,ne=yt(!r&&K,{[`${F}-lg`]:te==="large",[`${F}-sm`]:te==="small",[`${F}-rtl`]:z==="rtl",[`${F}-${xe}`]:We,[`${F}-in-form-item`]:ke},Rn(F,we,_e),le,c,u,De,R,se,pe),Je=re=>o.createElement(Mn,{prefixCls:be,switcherIcon:b,treeNodeProps:re,showLine:w}),[Xe]=nn("SelectLike",X==null?void 0:X.zIndex),Ye=o.createElement(Ue,Object.assign({virtual:Le,disabled:N},Ee,{dropdownMatchSelectWidth:Ie,builtinPlacements:Dn(Ne,Ae),ref:t,prefixCls:F,className:ne,listHeight:h,listItemHeight:f,treeCheckable:i&&o.createElement("span",{className:`${F}-tree-checkbox-inner`}),treeLine:!!w,suffixIcon:E,multiple:B,placement:ze,removeIcon:C,allowClear:$,switcherIcon:Je,showTreeIcon:P,notFoundContent:ce,getPopupContainer:A||Re,treeMotion:null,dropdownClassName:Ge,dropdownStyle:Object.assign(Object.assign({},X),{zIndex:Xe}),choiceTransitionName:pt(U,"",D),transitionName:pt(U,"slide-up",O),treeExpandAction:T,tagRender:B?Te:void 0}));return ye(Q(Ye))},rr=o.forwardRef(nr),Me=rr,ar=rn(Me);Me.TreeNode=ct;Me.SHOW_ALL=it;Me.SHOW_PARENT=dt;Me.SHOW_CHILD=rt;Me._InternalPanelDoNotUseOrYouWillBeFired=ar;const or=()=>{const e=o.useRef(!0);return o.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),e},lr=e=>o.useMemo(()=>({...{maxHeight:400,overflow:"auto"},...e||{}}),[e]),sr=({fetching:e,error:t,minSymbols:n,plainList:r})=>n?m.jsx(ur,{minSymbols:n,plainList:r}):e?m.jsx(cr,{plainList:r}):t?m.jsx(ir,{error:t,plainList:r}):m.jsx(m.Fragment,{}),ur=({minSymbols:e,plainList:t})=>m.jsxs("div",{style:{paddingLeft:t?"8px":"30px",fontSize:"12px"},children:["Введите как минимум ",e," симв."]}),cr=({plainList:e})=>m.jsxs("div",{style:{paddingLeft:e?"8px":"30px",fontSize:"12px"},children:[m.jsx(an,{size:"small"})," загрузка..."]}),ir=({error:e,plainList:t})=>m.jsx("div",{role:"alert",style:{paddingLeft:t?"8px":"30px",fontSize:"12px",color:"#ff4d4f"},children:e}),dr=({fetching:e,error:t,minSymbols:n,plainList:r})=>n||e||t?m.jsx(m.Fragment,{}):m.jsx("div",{style:{paddingLeft:r?"8px":"30px",fontSize:"12px"},children:"Данные отсутствуют"}),fr=({menu:e,fetching:t,error:n,minSymbols:r,plainList:a})=>m.jsxs(m.Fragment,{children:[e,m.jsx(sr,{fetching:t,error:n,minSymbols:r,plainList:a})]}),hr=({fetchError:e,fetching:t,minSymbols:n,plainList:r})=>o.useCallback(a=>m.jsx("div",{className:r?"tree-select-plain":void 0,children:m.jsx(fr,{menu:a,fetching:t,error:e,minSymbols:n,plainList:r})}),[e,t,n,r]),vr=e=>{const t=e.getProps().fieldNames,n=(t==null?void 0:t.title)||"title";return o.useCallback((r,a)=>{const l=a;return!l||typeof l[n]!="string"?!1:l[n].toLowerCase().indexOf(r.toLowerCase())>=0},[n])},wt=({api:e,treeSelectProps:t,antdTreeSelectProps:n})=>{var s,c,u,i,d;const r=lr(t.dropdownStyle),a=hr({fetchError:e.getFetchError(),fetching:e.getIsFetching(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),l=vr(e);return m.jsx(Me,{...n,treeData:e.getDataSet(),showSearch:t.showSearch!==!1,treeDefaultExpandAll:t.treeDefaultExpandAll!==!1,disabled:t.disabled||t.readOnly,dropdownStyle:r,fieldNames:{label:t.titleRender?"__title":((s=t.fieldNames)==null?void 0:s.title)??"title",value:(c=t.fieldNames)!=null&&c.value?t.fieldNames.value:"id",children:(u=t.fieldNames)!=null&&u.children?t.fieldNames.children:"children"},treeNodeLabelProp:t.selectedLabelProp?t.selectedLabelProp:t.labelRender?"__label":((i=t.fieldNames)==null?void 0:i.title)??"title",treeNodeFilterProp:t.titleRender?"__title":((d=t.fieldNames)==null?void 0:d.title)??"title",filterTreeNode:(h,f)=>e.getIsAllFetched()?t.filterTreeNode?typeof t.filterTreeNode=="function"?t.filterTreeNode(h,f):t.filterTreeNode:l(h,f):!0,value:e.getInternalValue(),notFoundContent:t.notFoundContent??m.jsx(dr,{fetching:e.getIsFetching(),error:e.getFetchError(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),dropdownRender:t.dropdownRender??a,onClear:()=>{var h,f;(h=t.onClear)==null||h.call(t),e.setValues(null),(f=t.onClear)==null||f.call(t)},onChange:h=>{var v;const f=e.plainValueToNodes(h);e.setValues(f??null),(v=t.onChange)==null||v.call(t,f??null)},onDropdownVisibleChange:h=>{var f;h&&(t.fetchMode==="onUse"||t.fetchMode==="onUseForce")&&e.fetchData(""),(f=t.onDropdownVisibleChange)==null||f.call(t,h)},onSearch:h=>{var f;e.fetchData(h,!0),(f=t.onSearch)==null||f.call(t,h)}})},gr=e=>{const n=e.getProps().editFormProps,[r]=o.useState((n==null?void 0:n.apiRef)||{}),[a]=o.useState((n==null?void 0:n.formId)??"SelectItemEdit-"+ut());return[o.useMemo(()=>{if(!n)return;const c={...{width:400,minWidth:200,bodyHeight:200,bodyMinHeight:40},...n,apiRef:r,formId:a},u=c==null?void 0:c.onSubmitSuccess;return c.onSubmitSuccess=(i,d,h)=>{if(!d||(u==null?void 0:u(i,d,h))===!1)return;const f={...h.model.getFormDataSet()??{},...d};if(h.getFormProps().formMode==="update")e.updateNodes(f);else{const g=e.getValues(),b=g&&g.length>0?g[0]:void 0;e.addNodes(b,f)}e.setValues([f])},c},[n,r,a,e]),r]},mr=e=>o.useCallback(t=>{var a;if(!e.isMounted())return;const n=e.getProps();if(!n.noCacheFetchedData&&e.getIsAllFetched())return;if(n.minSearchLength&&t.length<n.minSearchLength){e.setSetMynSymbols(n.minSearchLength),e.setDataSet(void 0);return}e.setSetMynSymbols(0),e.setSetFetchError(null);const r=(a=n==null?void 0:n.onDataFetch)==null?void 0:a.call(n,t,e);if(!r){e.setIsAllFetched(!0);return}e.setIsFetching(!0),t||e.setDataSet(null),r.then(l=>{var s,c,u;e.isMounted()&&(e.setDataSet(l.data),e.setIsAllFetched(e.getIsAllFetched()||!t),e.getIsReady()||(e.setIsReady(!0),(s=n==null?void 0:n.onReady)==null||s.call(n)),e.setIsFetching(!1),(c=n==null?void 0:n.onDataFetchSuccess)==null||c.call(n,l,e),(u=n==null?void 0:n.onDataFetchComplete)==null||u.call(n,e))},l=>{e.isMounted()&&(e.setSetFetchError(l.message),e.setDataSet(void 0),e.setIsFetching(!1))})},[e]),Cr=(e,t,n,r)=>{const a=o.useRef([]),[l,s]=o.useState(r?[]:null),[,c]=o.useState([]),u=Sr(e,t,n),i=o.useCallback(d=>{if(!d){a.current=[],c([]),s(r?[]:null);return}if(!He(d)){const g={...d},b=u(g);a.current=[g],c([g]),s(r?b?[b]:[]:b??null);return}const h=[],f=[],v=[...d];for(const g of v){const b={...g},w=u(b);w&&(f.push(b),h.push(w))}r?(s(h),a.current=f,c(a.current)):(s(h.length>0?h[0]:null),a.current=f.length>0?[f[0]]:[],c(a.current))},[u,r,a]);return[l,a,i]},Sr=(e,t,n)=>o.useCallback(r=>{if(!r)return null;const a=(e==null?void 0:e.value)??"id",l=r[a];let s;if(t)s=t(r);else{const c=(e==null?void 0:e.title)??"title",u=n?"__title":"";s=r.label??void 0,!s&&u&&(s=r[u]),s||(s=r[c])}return{value:l,label:s??void 0}},[e==null?void 0:e.title,e==null?void 0:e.value,t,n]),br=(e,t,n)=>o.useCallback(r=>{if(!r)return;const a=(e==null?void 0:e.value)??"id",l=r;let s=t(l);if(s||(s=n(l),s))return s;const c={};return c[a]=r,c},[e,t,n]),yr=e=>{const t=e.getProps(),n=pr(e.getDataSet()),r=Dr(e.getValues()),a=br(t.fieldNames,n,r);return o.useCallback(l=>{if(!l)return;const s=He(l)?l:[l],c=[];for(const u of s){const i=a(u);i&&c.push(i)}return c},[a])},pr=e=>{const t=o.useRef();return t.current=e,o.useCallback(n=>{if(!t.current||!n)return;const r=(a,l)=>{for(const s of a){if(s.id===l)return s;if(!s.children)continue;const c=r(s.children,l);if(c)return c}};return r(t.current,n)},[])},Dr=e=>{const t=o.useRef();return t.current=e,o.useCallback(n=>{if(!(!t.current||!n)){for(const r of t.current)if(r.id===n)return r}},[])},xr=(e,t,n)=>{const[r,a]=o.useState(),l=o.useCallback(s=>{if(!n.current)return;if(!s){a(void 0);return}let c;e||t?c=Vt(s,e,t):c=s,a(c)},[e,t,n]);return[r,l]},Vt=(e,t,n)=>{if(!e)return[];const r=[];for(const a of e){const l={...a};n&&(l.__label=n(a)),t&&(l.__title=t(a)),r.push(l),a.children&&(l.children=Vt(l.children,t,n))}return r},Ir=({api:e,componentId:t,treeProps:n,updateProps:r,buttonsApi:a})=>{const l=or(),[s,c]=xr(n.titleRender,n.labelRender,l),[u,i]=o.useState(!1),[d,h]=tt.useState(!1),[f,v]=tt.useState(""),[g,b]=tt.useState(!1),[w,A]=tt.useState(0),[W,_,P]=Cr(n.fieldNames,n.labelRender,n.titleRender,n.multiple);e.buttonsApi=a,e.getId=kr(t),e.isMounted=wr(l),e.getProps=Er(n),e.setProps=Fr(n,r),e.getInternalValue=Mr(W),e.getValues=Nr(_),e.setValues=Tr(P,e),e.getDataSet=Rr(s),e.setDataSet=Lr(c),e.plainValueToNodes=yr(e),e.getIsReady=Vr(u),e.setIsReady=Ar(i),e.getIsFetching=_r(d),e.setIsFetching=Or(h),e.getFetchError=Kr(f),e.setSetFetchError=jr(v),e.getIsAllFetched=$r(g),e.setIsAllFetched=Hr(b),e.getMinSymbols=Wr(w),e.setSetMynSymbols=Gr(A);const O=mr(e);e.fetchData=zr(O,e),e.addNodes=Br(e),e.updateNodes=Pr(e),e.deleteNodes=Ur(e)},kr=e=>o.useCallback(()=>e,[e]),wr=e=>o.useCallback(()=>e.current,[e]),Er=e=>o.useCallback(()=>e,[e]),Fr=(e,t)=>o.useCallback(n=>{t({...e,...n})},[e,t]),Mr=e=>o.useCallback(()=>e,[e]),Nr=e=>o.useCallback(()=>e.current,[e]),Tr=(e,t)=>o.useCallback(n=>{var s,c,u,i;const r=t.getProps(),a=((s=r.fieldNames)==null?void 0:s.value)??"id";let l;typeof n!="string"?l=n:(l={},l[a]=n),e(l??[]),l?r.multiple?(i=r==null?void 0:r.onChange)==null||i.call(r,l||[]):(u=r==null?void 0:r.onChange)==null||u.call(r,He(l)&&l.length>0?l[0]:l):(c=r==null?void 0:r.onChange)==null||c.call(r,null)},[t,e]),Rr=e=>o.useCallback(()=>e,[e]),Lr=e=>o.useCallback(t=>{e(t??[])},[e]),Vr=e=>o.useCallback(()=>e,[e]),Ar=e=>o.useCallback(t=>{e(t)},[e]),_r=e=>o.useCallback(()=>e,[e]),Or=e=>o.useCallback(t=>{e(t)},[e]),Kr=e=>o.useCallback(()=>e,[e]),jr=e=>o.useCallback(t=>{e(t??"")},[e]),$r=e=>o.useCallback(()=>e,[e]),Hr=e=>o.useCallback(t=>{e(t)},[e]),Wr=e=>o.useCallback(()=>e,[e]),Gr=e=>o.useCallback(t=>{e(t)},[e]),zr=(e,t)=>o.useCallback((n,r)=>{const a=on(e,t.getProps().debounce??0);r?a(n):e(n)},[t,e]),Br=e=>o.useCallback((t,n)=>{var i,d;const r=He(n)?n:[n],a=e.getProps(),l=((i=a.fieldNames)==null?void 0:i.value)??"id",s=((d=a.fieldNames)==null?void 0:d.children)??"children",c=(h,f,v)=>{if(!f){for(const g of v)h.push(g);return}for(const g of h)if(g[l]){if(g[l]===f[l]){if(g.isLeaf)for(const b of v)h.push(b);else{g[s]||(g[s]=[]);const b=g[s];for(const w of v)b.push(w)}return!0}if(g[s]&&c(g[s],f,v))return!0}},u=[...e.getDataSet()??[]];for(const h of r)h[l]||(h[l]=ut());c(u,t,r),e.setDataSet(u)},[e]),Pr=e=>o.useCallback(t=>{var u,i;const n=He(t)?t:[t],r=e.getProps(),a=((u=r.fieldNames)==null?void 0:u.value)??"id",l=((i=r.fieldNames)==null?void 0:i.children)??"children",s=(d,h)=>{for(const f of d)if(f[a]){if(f[a]===h[a]){const v=f[l];for(const g in h)f[g]=h[g];return f[l]=v,!0}if(f[l]&&s(f[l],h))return!0}},c=[...e.getDataSet()??[]];for(const d of n)s(c,d);e.setDataSet(c)},[e]),Ur=e=>o.useCallback(t=>{var u,i;const n=He(t)?t:[t],r=e.getProps(),a=((u=r.fieldNames)==null?void 0:u.value)??"id",l=((i=r.fieldNames)==null?void 0:i.children)??"children",s=(d,h)=>{for(let f=d.length-1;f>=0;f--){const v=d[f];if(v[a]){if(v[a]===h[a])return d.splice(f,1),!0;if(v[l]&&s(v[l],h))return!0}}},c=[...e.getDataSet()??[]];for(const d of n)s(c,d);e.setDataSet(c)},[e]),qr=(e,t)=>{const n=e.getValues(),r=e.getProps();return o.useMemo(()=>{const a={add:{icon:m.jsx(ln,{}),tooltip:"Добавить",position:"left",onClick:()=>{t.open("create")}},edit:{icon:m.jsx(Vn,{}),tooltip:"Редактировать",position:"center",disabled:!n||n.length!==1,onClick:()=>{const l=e.getValues();l.length===1&&t.open("update",l[0])}},delete:{icon:m.jsx(Nn,{}),tooltip:"Удалить",position:"right",disabled:!n||n.length<1,onClick:()=>{Jr(e)}}};return sn(a,r.editButtons)},[e,t,n,r.editButtons])},Jr=e=>{const t=e.getProps(),n=e.getValues();if(n.length<1)return;let r;const a=()=>{var s;const l=(s=t==null?void 0:t.onDelete)==null?void 0:s.call(t,n,e);if(un(l)){t.confirmDelete||(e.buttonsApi.loading("delete",!0),e.buttonsApi.disabled("add",!0),e.buttonsApi.disabled("edit",!0)),l.then(()=>{e.isMounted()&&(e.deleteNodes(n),e.setValues(null),t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("delete",!0),e.buttonsApi.disabled("add",!1)))}).catch(u=>{e.isMounted()&&(t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("add",!1),e.buttonsApi.disabled("edit",!1)),Dt.alert({content:m.jsxs(m.Fragment,{children:[m.jsx("p",{children:m.jsx("b",{children:u.message})}),u.stack&&cn()?m.jsx("p",{children:u.stack}):""]}),colorType:"danger"}))});return}e.deleteNodes(n),e.setValues(null),r&&r.destroy()};t.confirmDelete?r=Dt.confirmWaiter({content:t.nodeDeleteMessage??"Удалить выбранные строки?",onOk:a}):a()},Xr=e=>{const[t,n]=dn(e),[r]=o.useState(t.treeSelectId??"treeSelect-"+ut()),[a]=o.useState(t.apiRef??{}),[l]=o.useState({});Ir({api:a,componentId:r,treeProps:t,updateProps:n,buttonsApi:l});const[s,c]=gr(a),u=qr(a,c),i=Yr(e);return o.useEffect(()=>{a.setIsAllFetched(!1),a.setDataSet(void 0),a.setValues(null)},[a]),o.useEffect(()=>{a.setDataSet(t.dataSet)},[a.setDataSet,a,t.dataSet]),o.useEffect(()=>{a.setValues(t.value??null)},[a,t.value]),o.useEffect(()=>{var d;if((!t.fetchMode||t.fetchMode==="onLoad")&&!t.minSearchLength){a.fetchData("");return}a.getIsReady()||(d=t==null?void 0:t.onReady)==null||d.call(t)},[a,t,t.fetchMode,t.minSearchLength]),!s||t.readOnly||t.disabled?m.jsx(wt,{api:a,treeSelectProps:e,antdTreeSelectProps:i}):m.jsxs(fn,{wrap:!1,children:[m.jsx(wt,{api:a,treeSelectProps:e,antdTreeSelectProps:i}),m.jsx(hn,{children:m.jsx(vn,{buttons:u,apiRef:l,context:a})}),m.jsx(mn,{...s})]})},Yr=e=>o.useMemo(()=>Nt(e,{apiRef:!0,treeSelectId:!0,readOnly:!0,value:!0,defaultValueCallback:!0,titleRender:!0,labelRender:!0,filterTreeNode:!0,dataSet:!0,fetchMode:!0,noCacheFetchedData:!0,minSearchLength:!0,debounce:!0,selectedLabelProp:!0,fieldNames:!0,editFormProps:!0,nodeDeleteMessage:!0,confirmDelete:!0,editButtons:!0,plainList:!0,onReady:!0,onChange:!0,onClear:!0,onDataFetch:!0,onDataFetchSuccess:!0,onDataFetchError:!0,onDataFetchComplete:!0,onDelete:!0})[1],[e]),Zr=({field:e})=>{o.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const t=e.getProps(),n=e.getValue(),r=Qr(t),a=o.useCallback(u=>{var i;e.isReady()&&(e.setValue(u??null),e.setDirty(!0)),(i=t.onChange)==null||i.call(t,u)},[e,t]),l=o.useCallback(()=>{e.setTouched(!0)},[e]),s=o.useCallback(()=>{var u;e.setDirty(!0),e.setTouched(!0),(u=t.onClear)==null||u.call(t)},[e,t]);o.useEffect(()=>{e.setReady(!0)},[e]);const c={width:t.width??"100%",...t.style};return m.jsx(Xr,{style:c,...r,autoFocus:t.autoFocus,defaultValueCallback:t.defaultValueCallback,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:n,placeholder:t.placeholder??"Choose",allowClear:t.allowClear!==!1,onChange:a,onClear:s,onBlur:l,onDataFetch:t.onDataFetch,onDataFetchComplete:t.onDataFetchComplete,onDataFetchError:t.onDataFetchError,onDataFetchSuccess:t.onDataFetchSuccess,onDelete:t.onDelete,onReady:()=>{var u;return(u=t.onReady)==null?void 0:u.call(t,e)},onKeyUp:t.onKeyUp,onKeyDown:t.onKeyDown,onClick:t.onClick,onSelect:t.onSelect,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseDown:t.onMouseDown,onFocus:t.onFocus,onDeselect:t.onDeselect,onDropdownVisibleChange:t.onDropdownVisibleChange,onInputKeyDown:t.onInputKeyDown,onTreeExpand:t.onTreeExpand,onPopupScroll:t.onPopupScroll,onSearch:t.onSearch,onTreeLoad:t.onTreeLoad})},Qr=e=>o.useMemo(()=>Nt(e,{component:!0,helpClass:!0,label:!0,placeholder:!0,tab:!0,inlineGroup:!0,value:!0,hidden:!0,dependsOn:!0,width:!0,autoFocus:!0,style:!0,tooltip:!0,disabled:!0,requiredMark:!0,readOnly:!0,nonEditable:!0,rowStyle:!0,autoHeightResize:!0,onDirtyStateChanged:!0,onReady:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,onTouchedStateChanged:!0,onValidated:!0,onValueChanged:!0,onReadyStateChanged:!0,rules:!0})[1],[e]);class sa extends gn{render(){return m.jsx(Zr,{field:this})}}export{sa as T};
