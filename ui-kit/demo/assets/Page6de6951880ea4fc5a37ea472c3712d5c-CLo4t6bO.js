const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Ck5bJKlb.js","assets/default-highlight-D85JGHgv.js","assets/index-CAK7O9l6.js"])))=>i.map(i=>d[i]);
import{j as e,r as t,D as n,_ as i}from"./index-CAK7O9l6.js";import{D as d}from"./isArray-Bxga0gLP.js";import{I as r}from"./inputField-Wpdm7b6O.js";import{T as o}from"./treeSelectField-D9YzsXQJ.js";import{P as l}from"./useApiGetGroupsOnly-0xzjaV82.js";import{d as a}from"./dFormModal-BvlSklTP.js";import{P as s,C as m}from"./pageLayout-Cp-Vtr5E.js";import{d as h,c}from"./darcula-BqMdvqtY.js";import"./buttonsRow-B4oNgxRU.js";import"./messageBox-BplIwBs3.js";import"./index-CnihH4Wh.js";import"./baseField-VcJHUSVQ.js";import"./index-DzBz7Ssv.js";import"./SearchOutlined-Dka42DAS.js";import"./defaultButtonsProps-BkRAcHUl.js";import"./PlusOutlined-C_0a9Z7Q.js";import"./useShowArrow-64pIGnUs.js";import"./useIcons-CwAeAPpP.js";import"./index-BdbmqN31.js";import"./modal-C2E0CpxP.js";const p=()=>{const t=S();return e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Пример TreeSelect с формой редактирования"}),e.jsx("div",{style:{maxWidth:500},children:e.jsx(d,{...t})})]})},u=t=>e.jsxs(e.Fragment,{children:[t.title,e.jsx("br",{}),e.jsx("small",{style:{color:"#808080"},children:t.head?"("+t.head+")":""})]}),f=t=>e.jsxs(e.Fragment,{children:[t.title," ",e.jsx("small",{style:{color:"#808080"},children:t.head?"("+t.head+")":""})]}),F=(e,t)=>(t.title+" ("+t.head+")").toLowerCase().indexOf(e.toLowerCase())>=0,j={},S=()=>{const e=P();return t.useMemo((()=>({formId:"Test form",confirmChanges:!0,fieldsProps:{departments:{component:o,apiRef:j,label:"Подразделения",confirmDelete:!0,titleRender:u,selectedRender:f,filterTreeNode:F,dataSet:I,onDelete:()=>{},editFormProps:e}},buttons:null})),[e])},P=()=>t.useMemo((()=>({onFormInit:e=>{const t=e.model,n=t.getField("parent"),i=j.getDataSet();if("update"!==t.getFormMode())return void n.updateProps({dataSet:i});const d=t.getFormDataSet().id,r=a(i);l(d,r,{key:"id",children:"children"}),n.updateProps({dataSet:r})},formId:"EditForm",confirmChanges:!0,fieldsProps:{title:{component:r,label:"Подразделение"},head:{component:r,label:"Руководитель"},parent:{component:o,label:"Родитель"}}})),[]),I=[{id:"01",title:"Департамент аналитики данных",head:"Иванов Иван Иванович",children:[{id:"01-01",title:"Управление аналитики продаж",children:[{id:"01-01-01",title:"Отдел продаж север",head:"Петров Петр Петрович"},{id:"01-01-02",title:"Отдел продаж юг",head:"Сидоров Сидр Сидорович"},{id:"01-01-03",title:"Отдел продаж запад",head:"Дмитриев Дмитрий Дмитриевич"}]},{id:"01-02",title:"Управление аналитики закупок",head:"Семенов Семен Семенович",children:[{id:"01-02-01",title:"Отдел закупок север",head:"Максимов Максим Максимович"},{id:"01-02-02",title:"Отдел закупок юг",head:"Русланов Руслан Русланович"},{id:"01-02-03",title:"Отдел закупок запад",head:"Сметанин Сметан Сметанович"}]},{id:"01-03",title:"Управление аналитики производства",head:"Саратов Сарат Саратович",children:[{id:"01-03-01",title:"Отдел производства север",head:"Трибратов Трибрат Трибратович"},{id:"01-03-02",title:"Отдел производства юг",head:"Уваров Увар Уварович"},{id:"01-03-03",title:"Отдел производства запад",head:"Каямов Каям Каямович"}]}]},{id:"02",title:"Департамент инженерных работ",head:"Примеров Пример Примерович",children:[{id:"02-01",title:"Управление строительства",children:[{id:"02-01-01",title:"Отдел строительства север",head:"Неверов Невер Неверович"},{id:"02-01-02",title:"Отдел строительства юг",head:"Занудов Зануд Занудович"},{id:"02-01-03",title:"Отдел строительства запад",head:"Сигизмундов Сигизмунд Сигизмундович"}]},{id:"02-02",title:"Управление демонтажа",head:"Картонов Картон Картонович",children:[{id:"02-02-01",title:"Отдел демонтажа север",head:"Помидоров Помидор Помидорович"},{id:"02-02-02",title:"Отдел демонтажа юг",head:"Бананов Банан Бананович"},{id:"02-02-03",title:"Отдел демонтажа запад",head:"Огурцов Огурец Огурцович"}]},{id:"02-03",title:"Управление реконструкции",head:"Ремонтов Ремонт Ремонтович",children:[{id:"02-03-01",title:"Отдел реконструкции север",head:"Лимонов Лимон Лимонович"},{id:"02-03-02",title:"Отдел реконструкции юг",head:"Маркелов Маркел Маркелович"},{id:"02-03-03",title:"Отдел реконструкции запад",head:"Карпелов Карпел Карпелович"}]}]},{id:"03",title:"Департамент проектных работ",head:"Терпелов Терпел Терпелович",children:[{id:"03-01",title:"Управление проектирования",children:[{id:"03-01-01",title:"Отдел проектирования север",head:"Березин Берез Березович"},{id:"03-01-02",title:"Отдел проектирования юг",head:"Битов Бит Битович"},{id:"03-01-03",title:"Отдел проектирования запад",head:"Литеров Литер Литерович"}]},{id:"03-02",title:"Управление согласования",children:[{id:"03-02-01",title:"Отдел согласования север",head:"Рамов Рама Рамович"},{id:"03-02-02",title:"Отдел согласования юг",head:"Груздев Грузд Груздевич"},{id:"03-02-03",title:"Отдел согласования запад",head:"Блинов Блин Блинович"}]},{id:"03-03",title:"Управление анализа проектов",children:[{id:"03-03-01",title:"Отдел анализа север",head:"Котов Кот Котович"},{id:"03-03-02",title:"Отдел анализа юг",head:"Самолетов Самолет Самолетович"},{id:"03-03-03",title:"Отдел анализа запад",head:"Кораллов Коралл Кораллович"}]}]}],T=t.lazy((()=>i((()=>import("./index-Ck5bJKlb.js").then((e=>e.dw))),__vite__mapDeps([0,1,2])).then((e=>({default:e.Prism}))))),x=i=>e.jsxs(s,{children:[e.jsx(p,{}),e.jsx(n,{}),e.jsx("div",{children:e.jsx(m,{items:[{key:1,label:"Show source",children:e.jsx(t.Suspense,{fallback:e.jsx("div",{children:"Loading source..."}),children:e.jsx(T,{language:"tsx",style:i.darkMode?h:c,showLineNumbers:!0,children:"\nimport React, {useMemo} from 'react';\nimport {DForm, IDFormProps} from @krinopotam/ui-kit/dForm';\nimport {IDFormModalProps} from @krinopotam/ui-kit/dFormModal';\nimport {IInputFieldProps, InputField} from @krinopotam/ui-kit/dForm/fields/input/inputField';\nimport {ITreeSelectFieldProps, TreeSelectField} from @krinopotam/ui-kit/dForm/fields/treeSelect/treeSelectField';\nimport {ITreeSelectApi, ITreeSelectNode} from @krinopotam/ui-kit/treeSelect';\nimport {removeFromTree} from @krinopotam/ui-kit/_shared/hooks/treeComponentApiMethods/serviceMethods/removeFromTree';\nimport {CloneObject} from '@krinopotam/js-helpers';\nexport const TreeSelectWithFormAndNodeRenderers = (): React.JSX.Element => {\n    const formProps = useFormProps();\n    return (\n        <>\n            <div style={{maxWidth: 500}}>\n                <DForm {...formProps} />\n            </div>\n        </>\n    );\n};\nconst titleRender: ITreeSelectFieldProps['titleRender'] = (treeNode: ITreeSelectNode) => {\n    return (\n        <>\n            {treeNode.title}\n            <br />\n            <small style={{color: '#808080'}}>{treeNode.head ? '(' + treeNode.head + ')' : ''}</small>\n        </>\n    );\n};\nconst selectRender: ITreeSelectFieldProps['selectedRender'] = (treeNode: ITreeSelectNode) => {\n    return (\n        <>\n            {treeNode.title} <small style={{color: '#808080'}}>{treeNode.head ? '(' + treeNode.head + ')' : ''}</small>\n        </>\n    );\n};\nconst filterTreeNode: ITreeSelectFieldProps['filterTreeNode'] = (inputValue: string, treeNode: ITreeSelectNode) => {\n    const nodeString = (treeNode.title + ' (' + treeNode.head + ')').toLowerCase();\n    return nodeString.indexOf(inputValue.toLowerCase()) >= 0;\n};\nconst departmentsApi = {} as ITreeSelectApi;\nconst useFormProps = () => {\n    const editFormProps = useTreeEditFormProps();\n    return useMemo(\n        (): IDFormProps => ({\n            formId: 'Test form',\n            confirmChanges: true,\n            fieldsProps: {\n                departments: {\n                    component: TreeSelectField,\n                    apiRef: departmentsApi,\n                    label: 'Подразделения',\n                    confirmDelete: true,\n                    titleRender: titleRender,\n                    selectedRender: selectRender,\n                    filterTreeNode: filterTreeNode,\n                    dataSet: dataSet,\n                    onDelete: () => {},\n                    editFormProps: editFormProps,\n                } satisfies ITreeSelectFieldProps,\n            },\n            buttons: null,\n        }),\n        [editFormProps]\n    );\n};\nconst useTreeEditFormProps = () => {\n    return useMemo(\n        (): IDFormModalProps => ({\n            onFormInit: formApi => {\n                const model = formApi.model;\n                const field = model.getField('parent');\n                const data = departmentsApi.getDataSet();\n                const formMode = model.getFormMode();\n                if (formMode !== 'update') {\n                    field.updateProps({dataSet: data});\n                    return;\n                }\n                /** modify dataset for update to avoid the possibility of a parent node choosing itself or its own child node */\n                const id = model.getFormDataSet()['id'];\n                const clonedData = CloneObject(data);\n                removeFromTree(id, clonedData, {key: 'id', children: 'children'});\n                field.updateProps({dataSet: clonedData});\n            },\n            formId: 'EditForm',\n            confirmChanges: true,\n            fieldsProps: {\n                title: {component: InputField, label: 'Подразделение'} satisfies IInputFieldProps,\n                head: {component: InputField, label: 'Руководитель'} satisfies IInputFieldProps,\n                parent: {\n                    component: TreeSelectField,\n                    label: 'Родитель',\n                } satisfies ITreeSelectFieldProps,\n            },\n        }),\n        []\n    );\n};\nconst dataSet: ITreeSelectFieldProps['dataSet'] = [\n    {\n        id: '01',\n        title: 'Департамент аналитики данных',\n        head: 'Иванов Иван Иванович',\n        children: [\n            {\n                id: '01-01',\n                title: 'Управление аналитики продаж',\n                children: [\n                    {id: '01-01-01', title: 'Отдел продаж север', head: 'Петров Петр Петрович'},\n                    {id: '01-01-02', title: 'Отдел продаж юг', head: 'Сидоров Сидр Сидорович'},\n                    {id: '01-01-03', title: 'Отдел продаж запад', head: 'Дмитриев Дмитрий Дмитриевич'},\n                ],\n            },\n            {\n                id: '01-02',\n                title: 'Управление аналитики закупок',\n                head: 'Семенов Семен Семенович',\n                children: [\n                    {id: '01-02-01', title: 'Отдел закупок север', head: 'Максимов Максим Максимович'},\n                    {id: '01-02-02', title: 'Отдел закупок юг', head: 'Русланов Руслан Русланович'},\n                    {id: '01-02-03', title: 'Отдел закупок запад', head: 'Сметанин Сметан Сметанович'},\n                ],\n            },\n            {\n                id: '01-03',\n                title: 'Управление аналитики производства',\n                head: 'Саратов Сарат Саратович',\n                children: [\n                    {id: '01-03-01', title: 'Отдел производства север', head: 'Трибратов Трибрат Трибратович'},\n                    {id: '01-03-02', title: 'Отдел производства юг', head: 'Уваров Увар Уварович'},\n                    {id: '01-03-03', title: 'Отдел производства запад', head: 'Каямов Каям Каямович'},\n                ],\n            },\n        ],\n    },\n    {\n        id: '02',\n        title: 'Департамент инженерных работ',\n        head: 'Примеров Пример Примерович',\n        children: [\n            {\n                id: '02-01',\n                title: 'Управление строительства',\n                children: [\n                    {id: '02-01-01', title: 'Отдел строительства север', head: 'Неверов Невер Неверович'},\n                    {id: '02-01-02', title: 'Отдел строительства юг', head: 'Занудов Зануд Занудович'},\n                    {id: '02-01-03', title: 'Отдел строительства запад', head: 'Сигизмундов Сигизмунд Сигизмундович'},\n                ],\n            },\n            {\n                id: '02-02',\n                title: 'Управление демонтажа',\n                head: 'Картонов Картон Картонович',\n                children: [\n                    {id: '02-02-01', title: 'Отдел демонтажа север', head: 'Помидоров Помидор Помидорович'},\n                    {id: '02-02-02', title: 'Отдел демонтажа юг', head: 'Бананов Банан Бананович'},\n                    {id: '02-02-03', title: 'Отдел демонтажа запад', head: 'Огурцов Огурец Огурцович'},\n                ],\n            },\n            {\n                id: '02-03',\n                title: 'Управление реконструкции',\n                head: 'Ремонтов Ремонт Ремонтович',\n                children: [\n                    {id: '02-03-01', title: 'Отдел реконструкции север', head: 'Лимонов Лимон Лимонович'},\n                    {id: '02-03-02', title: 'Отдел реконструкции юг', head: 'Маркелов Маркел Маркелович'},\n                    {id: '02-03-03', title: 'Отдел реконструкции запад', head: 'Карпелов Карпел Карпелович'},\n                ],\n            },\n        ],\n    },\n    {\n        id: '03',\n        title: 'Департамент проектных работ',\n        head: 'Терпелов Терпел Терпелович',\n        children: [\n            {\n                id: '03-01',\n                title: 'Управление проектирования',\n                children: [\n                    {id: '03-01-01', title: 'Отдел проектирования север', head: 'Березин Берез Березович'},\n                    {id: '03-01-02', title: 'Отдел проектирования юг', head: 'Битов Бит Битович'},\n                    {id: '03-01-03', title: 'Отдел проектирования запад', head: 'Литеров Литер Литерович'},\n                ],\n            },\n            {\n                id: '03-02',\n                title: 'Управление согласования',\n                children: [\n                    {id: '03-02-01', title: 'Отдел согласования север', head: 'Рамов Рама Рамович'},\n                    {id: '03-02-02', title: 'Отдел согласования юг', head: 'Груздев Грузд Груздевич'},\n                    {id: '03-02-03', title: 'Отдел согласования запад', head: 'Блинов Блин Блинович'},\n                ],\n            },\n            {\n                id: '03-03',\n                title: 'Управление анализа проектов',\n                children: [\n                    {id: '03-03-01', title: 'Отдел анализа север', head: 'Котов Кот Котович'},\n                    {id: '03-03-02', title: 'Отдел анализа юг', head: 'Самолетов Самолет Самолетович'},\n                    {id: '03-03-03', title: 'Отдел анализа запад', head: 'Кораллов Коралл Кораллович'},\n                ],\n            },\n        ],\n    },\n];\n"})})}]})})]});export{x as Page6de6951880ea4fc5a37ea472c3712d5c,x as default};
