var y=Object.defineProperty;var C=(e,t,r)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var D=(e,t,r)=>C(e,typeof t!="symbol"?t+"":t,r);import{r as h,j as i}from"./index-CRRPgvdi.js";import{f as R,a as S}from"./index-CR3eF2D1.js";import{T as b}from"./tabulatorGrid-qvzlLlhb.js";const d=({field:e,gridApi:t})=>{h.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const r=e.getProps(),[s]=h.useState(t),n=M(r),u=e.getValue(),a=h.useRef();typeof a.current>"u"&&(r.selectionMode?a.current=r.dataSet:a.current=u);const o=F(e,r);let c=r.height;r.autoHeightResize&&(c="100%");const g=h.useMemo(()=>r.autoHeightResize?{position:"absolute",inset:0}:{},[r.autoHeightResize]);return i.jsx("div",{style:g,children:i.jsx(b,{...n,...o,apiRef:s,dataSet:a.current,readOnly:r.readOnly,placeholder:r.placeholder,width:r.width,height:c,resizeHeightWithParent:r.resizeHeightWithForm?"#"+e.getModel().getFormId():r.resizeHeightWithParent})})},M=e=>h.useMemo(()=>R(e,{value:!0,dataSet:!0,onMenuVisibilityChanged:!0,onDataLoading:!0,onDataLoaded:!0,onDataProcessed:!0,onDataLoadError:!0,onDataChanged:!0,onDataFetch:!0,onDataFetchResponse:!0,onDataFetching:!0,fetchInCreateMode:!0,onSelectionChange:!0,onDelete:!0,readOnly:!0,onValueChanged:!0,width:!0,autoHeightResize:!0,component:!0,rules:!0,onReadyStateChanged:!0,autoFocus:!0,dependsOn:!0,disabled:!0,helpClass:!0,hidden:!0,label:!0,nonEditable:!0,inlineGroup:!0,onDirtyStateChanged:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,placeholder:!0,onTouchedStateChanged:!0,onValidated:!0,requiredMark:!0,rowStyle:!0,style:!0,tooltip:!0,resizeHeightWithForm:!0})[1],[e]),F=(e,t)=>h.useMemo(()=>{const s=e.getModel().getFormMode();return{onDataChanged:(n,u)=>{var a;return e.isReady()&&(t.selectionMode||(e.setValue(n??[],!1,!0,!0),e.setDirty(!0))),(a=t.onDataChanged)==null?void 0:a.call(t,n,u,e)},onSelectionChange:(n,u,a,o,c)=>{var g;return e.isReady()&&(t.selectionMode&&(e.setValue(n??[],!1,!0,!0),e.setDirty(!0)),e.setTouched(!0)),(g=t.onSelectionChange)==null?void 0:g.call(t,n,u,a,o,c,e)},onDataLoading:(n,u)=>{var a;return e.setReady(!1),(a=t.onDataLoading)==null?void 0:a.call(t,n,u,e)},onDataLoaded:(n,u)=>{var o;e.setReady(!0);const a=e.getProps();return a.selectionMode||e.setValue(n??[],!1,!0,!0),(o=a.onDataLoaded)==null?void 0:o.call(a,n,u,e)},onDataProcessed:(n,u)=>{var o;const a=e.getProps();return a.selectionMode&&u.setSelectedRows(e.getValue()),(o=a.onDataProcessed)==null?void 0:o.call(a,n,u,e)},onDataLoadError:(n,u,a)=>{var o;return e.setReady(!1),(o=t.onDataLoadError)==null?void 0:o.call(t,n,u,a,e)},onDataFetch:!t.onDataFetch||s==="create"&&!t.fetchInCreateMode?void 0:(n,u)=>t.onDataFetch(n,u,e),onDataFetching:t.onDataFetching?(n,u,a)=>t.onDataFetching(n,u,a,e):void 0,onDataFetchResponse:t.onDataFetchResponse?(n,u,a)=>{var o;return((o=t==null?void 0:t.onDataFetchResponse)==null?void 0:o.call(t,n,u,a,e))??n}:void 0,onMenuVisibilityChanged:t.onMenuVisibilityChanged?(n,u)=>{var a;return(a=t==null?void 0:t.onMenuVisibilityChanged)==null?void 0:a.call(t,n,u,e)}:void 0,onDelete:t.onDelete?(n,u)=>{var a;return(a=t==null?void 0:t.onDelete)==null?void 0:a.call(t,n,u,e)}:void 0}},[t,e]);class x extends S{constructor(){super(...arguments);D(this,"gridApi",{})}render(){const r=this.getProps();return r.apiRef&&(this.gridApi=r.apiRef),i.jsx(d,{field:this,gridApi:this.gridApi})}getGridApi(){return this.gridApi}setValue(r,s,n,u){const a=this.getProps();return!u&&!a.selectionMode&&this.gridApi.setDataSet(r),super.setValue(r,s,n)}setDataSet(r,s){this.getProps().selectionMode?this.gridApi.setDataSet(r):this.setValue(r,s)}getDataSet(){return this.gridApi.getDataSet()}}export{x as T};
