import{r as d,j as c,ap as te,aq as E,ar as ne}from"./index-CObHp3AH.js";import{t as re,E as oe,n as M,u as se,a as ue,B as de}from"./dForm-DjwSwKfj.js";import{r as ae,D as L,s as X}from"./dFormModal-BBSecmha.js";import{S as ce,m as le,a as $,b as ie,c as fe,d as B,u as ge,t as he,e as me,f as be,g as ye,h as Fe,P as Se}from"./modal-BBQwvlDP.js";import{o as Re,d as xe,a as Ae,b as Ce,c as Ge,e as ve,f as De,g as Ne}from"./defaultButtonsProps-DSb7WT6w.js";import{a as Ee,T as Ie}from"./index-C0zsZX4a.js";import{n as J,g as Oe,u as K,a as we,b as je,c as Me,d as ke,e as Te,f as Ve,h as Le,i as Be,j as Ke,k as We,l as ze,m as Pe,o as He,p as Qe,q as Ue,r as qe,s as _e,t as Xe,v as $e,w as Je,x as Ye,y as Ze,z as pe,A as et,B as tt,C as nt,D as rt,E as ot}from"./useApiIsNodeSelected-DsZSnUgD.js";const st=e=>d.useMemo(()=>({...{maxHeight:400,overflow:"auto"},...e}),[e]),ut=e=>{const n=e.getFieldNames().title;return d.useCallback((r,o)=>!o||typeof o[n]!="string"?!1:o[n].toLowerCase().indexOf(r.toLowerCase())>=0,[n])},Y=({api:e})=>{const t=e.getFetchError(),n=e.getIsFetching(),r=e.getMinSymbols(),o=e.isDataPlainList();return r?c.jsx(dt,{minSymbols:r,plainList:o}):n?c.jsx(at,{plainList:o}):t?c.jsx(ct,{error:t,plainList:o}):c.jsx(c.Fragment,{})},dt=({minSymbols:e,plainList:t})=>c.jsxs("div",{style:{paddingLeft:t?"8px":"30px",fontSize:"12px"},children:["Введите как минимум ",e," симв."]}),at=({plainList:e})=>c.jsxs("div",{style:{paddingLeft:e?"8px":"30px",fontSize:"12px"},children:[c.jsx(ce,{size:"small"})," загрузка..."]}),ct=({error:e,plainList:t})=>c.jsx("div",{role:"alert",style:{paddingLeft:t?"8px":"30px",fontSize:"12px",color:"#ff4d4f"},children:e}),lt=({api:e})=>{const t=e.getIsFetching(),n=e.getFetchError(),r=e.getMinSymbols(),o=e.isDataPlainList();return r||t||n?c.jsx(c.Fragment,{}):c.jsx("div",{style:{paddingLeft:o?"8px":"30px",fontSize:"12px"},children:e.t("dataNotFound")})},I=d.createContext(void 0),it=({children:e})=>{const t=d.useRef(!1),n=d.useRef(!1),r=d.useMemo(()=>({ctrlPressedRef:t,dialogOpenedRef:n}),[t]);return c.jsx(I.Provider,{value:r,children:e})},W=(e,t,n)=>{const{dialogOpenedRef:r}=d.useContext(I);return d.useMemo(()=>{const o=n?t==null?void 0:t.editGroupFormProps:t==null?void 0:t.editFormProps;if(!o)return;const s={...o};t.language&&!s.language&&(s.language=t.language);const u=o==null?void 0:o.onSubmitSuccess;s.onSubmitSuccess=(i,f,h,b,y)=>{var A;if(u==null||u(i,f,h,b,y),y.isPrevented())return;const R=b.model.getFormMode(),S=e.getFieldNames(),F={...h};let g;if(ae(F,S.parent)?g=(A=F[S.parent])==null?void 0:A[S.key]:g=e.getActiveNodeKey(),R==="create"||R==="clone")F[S.key]||(F[S.key]=Re()),e.addNode(F,g,"insideBottom",{ensureVisible:!0,select:!!t.selectNewNode});else if(R==="update"){e.updateNode(F,g,{ensureVisible:!0});const C=e.getValues();e.setValues(ft(C,F,S))}};const a=o==null?void 0:o.onOpen;s.onOpen=(i,f,h,b)=>{const y=a==null?void 0:a(i,f,h,b);return b.isPrevented()||(r.current=!0),y};const l=o==null?void 0:o.onClosed;return s.onClosed=(i,f)=>{l==null||l(i,f),!f.isPrevented()&&(r.current=!1)},s},[n,t==null?void 0:t.editFormProps,t==null?void 0:t.editGroupFormProps,t.language,t.selectNewNode,e,r])},ft=(e,t,n)=>{if(!e)return;const r=[];for(const o of e)o.value===t[n.key]?r.push({value:o.value}):r.push(o);return r},gt=(e,t)=>{e.getButtonsApi().refreshButtons=ht();const n=e.getActiveNode(!0),r=t.groupsMode&&(!(n!=null&&n.isLeaf)||(n==null?void 0:n.isGroup)),o=t.buttons,s=t.buttonsSize??"small",u=t.buttonsPosition??"right",a=mt(t),l=bt(e,t),i=yt(e,t),f=Ft(e,t,n,r),h=St(e,t,n,r),b=Rt(e,t,n,r),y=xt(e,t,n,r);return d.useMemo(()=>{const S=le({headerLabel:a,view:f,create:l,createGroup:i,clone:h,update:b,delete:y},o);for(const F in S){const g=S[F];!g||F==="headerLabel"||g.type==="hotkey"||(g.size=g.size??s,g.position=g.position??u,g.checkDisabled&&(g.disabled=!n),g.checkHidden&&(g.hidden=!n))}return S},[a,f,l,i,h,b,y,o,s,u,n])},ht=()=>{const[,e]=d.useState({});return d.useCallback(()=>{e({})},[e])},mt=e=>d.useMemo(()=>{if(e.headerLabel)return{...xe,title:e.headerLabel}},[e.headerLabel]),bt=(e,t)=>{var n;return d.useMemo(()=>{var r;if(!(!t.editFormProps||t.disabled||t.readOnly||((r=t.buttons)==null?void 0:r.create)===null))return{...Ae,title:e.t("create"),tooltip:e.t("createRecord"),onClick:()=>{const o=e.getFieldNames(),s=e.getActiveNode(!1);let u;s&&(s.isLeaf?u=e.getParentNode(s):u=s),e.getEditFormApi().open("create",{defaultValues:{[o.parent]:u}})}}},[e,t.disabled,(n=t.buttons)==null?void 0:n.create,t.editFormProps,t.readOnly])},yt=(e,t)=>{var n;return d.useMemo(()=>{var r;if(!(!t.editGroupFormProps||!t.groupsMode||t.disabled||t.readOnly||((r=t.buttons)==null?void 0:r.createGroup)===null))return{...Ce,title:e.t("createGroup"),tooltip:e.t("createRecordsGroup"),onClick:()=>{const o=e.getFieldNames(),s=e.getActiveNode(!1);let u;s&&(s.isLeaf?u=e.getParentNode(s):u=s),e.getEditGroupFormApi().open("create",{defaultValues:{[o.parent]:u}})}}},[t.editGroupFormProps,t.groupsMode,t.disabled,t.readOnly,(n=t.buttons)==null?void 0:n.createGroup,e])},Ft=(e,t,n,r)=>{var o;return d.useMemo(()=>{var s;if(!(!r&&!t.editFormProps||r&&!t.editGroupFormProps||!t.readOnly||t.disabled||((s=t.buttons)==null?void 0:s.view)===null))return{...Ge,title:e.t("view"),tooltip:e.t("viewRecord"),disabled:!n,onClick:()=>{if(!n)return;const u=e.getFieldNames(),a=e.getParentNode(n);r?e.getEditGroupFormApi().open("view",{dataSet:{...v(n),[u.parent]:a}}):e.getEditFormApi().open("view",{dataSet:{...v(n),[u.parent]:a}})}}},[r,t.editFormProps,t.editGroupFormProps,t.readOnly,t.disabled,(o=t.buttons)==null?void 0:o.view,n,e])},St=(e,t,n,r)=>{var o;return d.useMemo(()=>{var u;const s=t.editGroupFormProps;if(!(!r&&!t.editFormProps||r&&!t.editGroupFormProps||t.disabled||t.readOnly||((u=t.buttons)==null?void 0:u.clone)===null))return{...ve,title:r&&s?e.t("cloneGroup"):e.t("clone"),tooltip:r&&s?e.t("cloneRecordsGroup"):e.t("cloneRecord"),disabled:!n,onClick:()=>{if(!n)return;const a=e.getFieldNames(),l=e.getParentNode(n);r?e.getEditGroupFormApi().open("clone",{dataSet:{...v(n),[a.parent]:l}}):e.getEditFormApi().open("clone",{dataSet:{...v(n),[a.parent]:l}})}}},[t.editGroupFormProps,t.editFormProps,t.disabled,t.readOnly,(o=t.buttons)==null?void 0:o.clone,r,n,e])},Rt=(e,t,n,r)=>{var o;return d.useMemo(()=>{var u;const s=t.editGroupFormProps;if(!(!r&&!t.editFormProps||r&&!t.editGroupFormProps||t.disabled||t.readOnly||((u=t.buttons)==null?void 0:u.update)===null))return{...De,title:r&&s?e.t("editGroup"):e.t("edit"),tooltip:r&&s?e.t("editRecordsGroup"):e.t("editRecord"),disabled:!n,onClick:()=>{if(!n)return;const a=e.getFieldNames(),l=e.getParentNode(n);r?e.getEditGroupFormApi().open("update",{dataSet:{...v(n),[a.parent]:l}}):e.getEditFormApi().open("update",{dataSet:{...v(n),[a.parent]:l}})}}},[t.editGroupFormProps,t.editFormProps,t.disabled,t.readOnly,(o=t.buttons)==null?void 0:o.update,r,n,e])},xt=(e,t,n,r)=>{const{dialogOpenedRef:o}=d.useContext(I);return d.useMemo(()=>{var s;if(!(!t.editFormProps||t.disabled||t.readOnly||((s=t.buttons)==null?void 0:s.delete)===null))return{...Ne,title:r?e.t("deleteGroup"):e.t("delete"),tooltip:r?e.t("deleteRecordsGroup"):e.t("deleteRecord"),disabled:!n,onClick:()=>{if(!n)return;if(o.current=!0,!t.confirmDelete){z(n,t,e,o,e.t("error")),o.current=!1;return}const u=$.confirmWaiter({language:t.language,content:t.nodeDeleteMessage??e.t("deleteSelectedRecordQt"),onOk:()=>{z(n,t,e,o,e.t("error"),u)},onCancel:()=>{u.destroy(),o.current=!1}})}}},[t,r,e,n,o])},z=(e,t,n,r,o,s)=>{var l;const u=n.getButtonsApi(),a=(l=t==null?void 0:t.onDelete)==null?void 0:l.call(t,e,n);if(!re(a)){n.removeNode(e),s&&s.destroy(),r.current=!1;return}t.confirmDelete||(u.loading("delete",!0),u.disableAll(!0)),a.then(()=>{s==null||s.destroy(),n.getIsMounted()&&(n.removeNode(e),t.confirmDelete||(u.loading("delete",!1),u.disableAll(!1)),r.current=!1)}).catch(i=>{s==null||s.destroy(),n.getIsMounted()&&(t.confirmDelete||(u.loading("delete",!1),u.disableAll(!1)),$.alert({language:t.language,title:o,content:c.jsx(oe,{error:i}),colorType:"danger",onOk:()=>{r.current=!1}}))})},v=e=>({...e}),At=({treeApi:e,treeProps:t})=>{const n=gt(e,t),{token:{colorBorderSecondary:r}}=te.useToken();return d.useMemo(()=>n?c.jsx("div",{style:{padding:"0 4px 6px 4px",borderBottom:`1px solid ${r}`,...t.buttonsRowWrapperStyle},children:c.jsx(ie,{buttons:n,apiRef:e.getButtonsApi(),style:t.buttonsRowStyle,context:e,iconsOnly:t.buttonsIconsOnly!==!1})}):null,[n,r,e,t.buttonsIconsOnly,t.buttonsRowStyle,t.buttonsRowWrapperStyle])},Ct=({api:e,children:t})=>{const n=e.isDataPlainList(),r=e.getProps();return c.jsx("div",{className:n?"tree-select-plain":void 0,children:r.editFormProps||r.editGroupFormProps?c.jsx(Gt,{api:e,children:t}):c.jsxs(c.Fragment,{children:[t,c.jsx(Y,{api:e})]})})},Gt=({api:e,children:t})=>{const n=e.getProps();return c.jsxs(fe,{style:{display:"flex",flexDirection:"column",...n.buttonsRowWrapperStyle},noKeepFocus:!0,children:[c.jsx(At,{treeApi:e,treeProps:n}),t,c.jsx(Y,{api:e})]})},vt=({api:e,children:t})=>{const n=e.getProps(),r=d.useContext(Ee);return r&&(n.titleRender?r.treeTitleRender=n.titleRender:r.treeTitleRender=void 0),n.dropdownRender?n.dropdownRender(t):c.jsx(Ct,{api:e,children:t})},Dt=({api:e,allProps:t,treeSelectProps:n})=>{const{ctrlPressedRef:r,dialogOpenedRef:o}=d.useContext(I);Et(r);const s=W(e,t,!1),u=W(e,t,!0),a=st(t.dropdownStyle),l=Ot({api:e}),i=It(e),f=Vt(e.getFieldNames()),h=e.getExpandedKeys(),b=Lt(e),y=wt(e),R=jt(e),S=Mt(e,r,o),F=kt(e),g=Tt(e);return c.jsxs(c.Fragment,{children:[c.jsx(Ie,{ref:e.treeSelectRef,treeNodeFilterProp:f.label,notFoundContent:c.jsx(lt,{api:e}),...n,labelInValue:!0,treeTitleRender:t.selectedRender,dropdownRender:t.readOnly?Nt:l,showSearch:!t.readOnly&&t.showSearch!==!1,allowClear:!t.readOnly&&t.allowClear!==!1,fieldNames:f,treeData:e.getDataSet(),value:i,disabled:t.disabled,treeDefaultExpandAll:t.defaultExpandAll,treeDefaultExpandedKeys:t.defaultExpandedKeys,treeExpandedKeys:h,open:e.getIsOpen(),dropdownStyle:a,filterTreeNode:g,onTreeExpand:b,onClear:y,onChange:R,onDropdownVisibleChange:S,onSearch:F}),!t.disabled&&s?c.jsx(L,{...s,apiRef:e.getEditFormApi()}):null,!t.disabled&&u?c.jsx(L,{...u,apiRef:e.getEditGroupFormApi()}):null]})},Nt=()=>c.jsx(c.Fragment,{}),Et=e=>{B("keydown",t=>{t.key==="Control"&&(e.current=!0)}),B("keyup",t=>{t.key==="Control"&&(e.current=!1)})},It=e=>{const t=e.getValues();return e.getProps().multiple?t??void 0:(t==null?void 0:t[0])??void 0},Ot=({api:e})=>d.useCallback(t=>c.jsx(vt,{api:e,children:t}),[e]),wt=e=>d.useCallback(()=>{var n;e.setValues(void 0);const t=e.getProps();(n=t.onClear)==null||n.call(t)},[e]),jt=e=>d.useCallback(t=>{var u;const n=t;e.setValues(n);const r=e.getProps(),o=n?e.getSelectedKeys(n)??[]:[],s=n?e.getSelectedNodes(void 0,n)??[]:[];(u=r.onChange)==null||u.call(r,t,o,s)},[e]),Mt=(e,t,n)=>d.useCallback(r=>{var s;const o=e.getProps();if(o.readOnly){e.setIsOpen(!1);return}t.current||n.current?e.setIsOpen(!0):e.setIsOpen(r),r&&(o.fetchMode==="onUse"||o.fetchMode==="onUseForce")&&e.fetchData(),(s=o.onDropdownVisibleChange)==null||s.call(o,r)},[e,t,n]),kt=e=>d.useCallback(t=>{var r;e.fetchData(t,!0);const n=e.getProps();(r=n.onSearch)==null||r.call(n,t)},[e]),Tt=e=>{const t=ut(e);return d.useCallback((n,r)=>{if(!e.getIsAllFetched())return!0;const o=e.getProps();return o.filterTreeNode?typeof o.filterTreeNode=="function"?o.filterTreeNode(n,r):o.filterTreeNode:t(n,r)},[e,t])},Vt=e=>d.useMemo(()=>{const t=e.key,n=e.title,r=e.children;return{value:t,label:n,children:r}},[e.children,e.key,e.title]),Lt=e=>d.useCallback(t=>{var r;const n=e.getProps();e.setExpandedKeys(t),(r=n.onTreeExpand)==null||r.call(n,t)},[e]),Bt=e=>t=>{var o;if(!e.getIsMounted())return;const n=e.getProps();if(!n.noCacheFetchedData&&e.getIsAllFetched())return;if(n.minSearchLength&&t.length<n.minSearchLength){e.setMinSymbols(n.minSearchLength),e.setDataSet(void 0);return}e.setMinSymbols(0),e.setFetchError(void 0);const r=(o=n==null?void 0:n.onDataFetch)==null?void 0:o.call(n,t,e);if(!r){e.setIsAllFetched(!0);return}e.setIsFetching(!0),t||e.setDataSet(void 0),r.then(s=>{var u,a,l;e.getIsMounted()&&(e.setDataSet(s.data),e.setIsAllFetched(e.getIsAllFetched()||!t),e.getIsReady()||(e.setIsReady(!0),(u=n==null?void 0:n.onReady)==null||u.call(n)),e.setIsFetching(!1),(a=n==null?void 0:n.onDataFetchSuccess)==null||a.call(n,s,e),(l=n==null?void 0:n.onDataFetchComplete)==null||l.call(n,e))},s=>{e.getIsMounted()&&(e.setFetchError(s.message),e.setDataSet(void 0),e.setIsFetching(!1))})},Kt=e=>{const[t,n]=d.useState(e.open);return J(()=>{n(e.open)},[e.open]),[t,n]},Wt=e=>()=>e,zt=e=>t=>{e(t)},Pt=({dataMutator:e})=>d.useCallback(t=>{if(!e)return t;let n={...t};return e&&(n=e(n)),n},[e]),Ht=e=>()=>e,Qt=e=>t=>{e(t)},Ut=e=>()=>e,qt=e=>()=>e,_t=e=>()=>e,Xt=e=>t=>{e(t)},$t=e=>()=>e,Jt=e=>t=>{e(t)},Yt=e=>()=>e,Zt=e=>t=>{e(t)},pt=e=>()=>e,en=e=>t=>{e(t)};var tn="Expected a function",P=NaN,nn="[object Symbol]",rn=/^\s+|\s+$/g,on=/^[-+]0x[0-9a-f]+$/i,sn=/^0b[01]+$/i,un=/^0o[0-7]+$/i,dn=parseInt,an=typeof E=="object"&&E&&E.Object===Object&&E,cn=typeof self=="object"&&self&&self.Object===Object&&self,ln=an||cn||Function("return this")(),fn=Object.prototype,gn=fn.toString,hn=Math.max,mn=Math.min,w=function(){return ln.Date.now()};function bn(e,t,n){var r,o,s,u,a,l,i=0,f=!1,h=!1,b=!0;if(typeof e!="function")throw new TypeError(tn);t=H(t)||0,j(n)&&(f=!!n.leading,h="maxWait"in n,s=h?hn(H(n.maxWait)||0,t):s,b="trailing"in n?!!n.trailing:b);function y(m){var x=r,G=o;return r=o=void 0,i=m,u=e.apply(G,x),u}function R(m){return i=m,a=setTimeout(g,t),f?y(m):u}function S(m){var x=m-l,G=m-i,N=t-x;return h?mn(N,s-G):N}function F(m){var x=m-l,G=m-i;return l===void 0||x>=t||x<0||h&&G>=s}function g(){var m=w();if(F(m))return A(m);a=setTimeout(g,S(m))}function A(m){return a=void 0,b&&r?y(m):(r=o=void 0,u)}function C(){a!==void 0&&clearTimeout(a),i=0,r=l=o=a=void 0}function O(){return a===void 0?u:A(w())}function D(){var m=w(),x=F(m);if(r=arguments,o=this,l=m,x){if(a===void 0)return R(l);if(h)return a=setTimeout(g,t),y(l)}return a===void 0&&(a=setTimeout(g,t)),u}return D.cancel=C,D.flush=O,D}function j(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function yn(e){return!!e&&typeof e=="object"}function Fn(e){return typeof e=="symbol"||yn(e)&&gn.call(e)==nn}function H(e){if(typeof e=="number")return e;if(Fn(e))return P;if(j(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=j(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(rn,"");var n=sn.test(e);return n||un.test(e)?dn(e.slice(2),n?2:8):on.test(e)?P:+e}var Sn=bn;const Rn=ne(Sn),xn=(e,t)=>(n="",r)=>{const o=Rn(e,t.getProps().debounce??0);r?o(n):e(n)},Q=e=>!!(e&&typeof e=="object"&&e.value),U=(e,t)=>{const n=e[t.key],r=e[t.title];return{value:n,label:r}},k=(e,t)=>{if(!e)return;if(!M(e))return typeof e=="object"?Q(e)?[e]:[U(e,t)]:[{value:e}];const n=[];for(const r of e)r&&(typeof r=="object"?Q(r)?n.push(r):n.push(U(r,t)):n.push({value:r}));return n},An=({value:e},t)=>{const n=Cn(e,t),[r,o]=d.useState(n);return J(()=>{o(n)},[n]),[r,o]},Cn=(e,t)=>d.useMemo(()=>k(e,t),[t,e]),Gn=e=>()=>e,vn=(e,t)=>d.useCallback(n=>{e(k(n,t))},[t,e]),Dn=e=>t=>{const n=t??e;if(!n)return;if(!M(n))return[n.value];const r=[];for(const o of n)r.push(o.value);return r},q=(e,t,n)=>{const r={[n.key]:e.value,[n.title]:e.label},{idx:o,nodes:s}=Oe(t,e.value,n);if(o<0||!(s!=null&&s[o]))return r;const u={...s[o]};return delete u[n.children],u},Nn=(e,t)=>{const n=d.useRef(void 0),r=d.useRef(void 0),o=d.useRef(void 0);return(s,u)=>{const a=e.getDataSet(),l=e.getFieldNames(),i=s??a,f=u??t;if(n.current===i&&r.current===f)return o.current;if(n.current=i,r.current=f,!f){o.current=void 0;return}const h=[];if(!M(f))h.push(q(f,i,l));else for(const b of f){const y=q(b,i,l);y&&h.push(y)}return o.current=h,h}},En=(e,t)=>d.useCallback((n,r=!0)=>{var a;const o=e.getFieldNames(),s=(a=k(n,o))==null?void 0:a[0];if(!s)return;const u=e.getValues();if(r){if(_(u,s.value))return;t?e.setValues([...u??[],s]):e.setValues([s])}else{if(!_(u,s.value))return;t?e.setValues(u==null?void 0:u.filter(l=>l.value!==s.value)):e.setValues([])}},[e,t]),_=(e,t)=>{if(!e)return!1;for(const n of e)if(n.value===t)return!0;return!1},In={view:"Просмотр",viewRecord:"Просмотр записи",create:"Создать",createRecord:"Создать запись",createGroup:"Создать группу",createRecordsGroup:"Создать группу записей",edit:"Редактировать",editGroup:"Редактировать группу",editRecord:"Редактировать запись",editRecordsGroup:"Редактировать группу записей",clone:"Клонировать",cloneGroup:"Клонировать группу",cloneRecord:"Клонировать запись",cloneRecordsGroup:"Клонировать группу записей",delete:"Удалить",deleteGroup:"Удалить группу",deleteRecord:"Удалить запись(и)",deleteRecordsGroup:"Удалить группу записей",select:"Выбрать",selectRecord:"Выбрать запись(и)",go:"Перейти",filter:"Фильтр",ok:"OK",cancel:"Отмена",tryAgainQt:"Попробовать еще раз?",deleteSelectedRecordQt:"Удалить выбранную запись?",error:"Ошибка",dataNotFound:"Данные не найдены"},On={view:"View",viewRecord:"View record",create:"Create",createRecord:"Create record",createGroup:"Create group",createRecordsGroup:"Create records group",edit:"Edit",editGroup:"Edit group",editRecord:"Edit record",editRecordsGroup:"Edit records group",clone:"Clone",cloneGroup:"Clone group",cloneRecord:"Clone record",cloneRecordsGroup:"Clone records group",delete:"Delete",deleteGroup:"Delete group",deleteRecord:"Delete record(s)",deleteRecordsGroup:"Delete records group(s)",select:"Select",selectRecord:"Select record(s)",go:"Go",filter:"Filter",ok:"OK",cancel:"Cancel",tryAgainQt:"Try again?",deleteSelectedRecordQt:"Delete selected record?",error:"Error",dataNotFound:"Data not found"},wn={view:"查看",viewRecord:"查看记录",create:"创建",createRecord:"创建记录",createGroup:"创建组",createRecordsGroup:"创建记录组",edit:"编辑",editGroup:"编辑组",editRecord:"编辑记录",editRecordsGroup:"编辑记录组",clone:"克隆",cloneGroup:"克隆组",cloneRecord:"克隆记录",cloneRecordsGroup:"克隆记录组",delete:"删除",deleteGroup:"删除组",deleteRecord:"删除记录",deleteRecordsGroup:"删除记录组",select:"选择",selectRecord:"选择记录",go:"前往",filter:"过滤",ok:"确定",cancel:"取消",tryAgainQt:"再试一次",deleteSelectedRecordQt:"删除选定的记录",error:"错误",dataNotFound:"数据未找到"},jn={ru:In,en:On,cn:wn},Mn=e=>se(e.language,jn,e.translation),kn=({props:e,setProps:t})=>{var T,V;const[n]=d.useState(e.apiRef??{}),[r]=d.useState(((T=e.editFormProps)==null?void 0:T.apiRef)??{}),[o]=d.useState(((V=e.editGroupFormProps)==null?void 0:V.apiRef)??{}),[s,u]=d.useState(!1),[a,l]=d.useState(!1),[i,f]=d.useState(),[h,b]=d.useState(!1),[y,R]=d.useState(0),[S,F]=Kt(e),g=K(e)(),A=Pt(e),[C,O]=An(e,g),[D,m,x,G]=we(e.dataSet,g,A),[N,Z]=je(e.expandedKeys,e.defaultExpandedKeys,e.defaultExpandAll,G),p=Bt(n),ee={getId:ge(e.componentId??"treeSelect-"+he()),getProps:me(e),setProps:be(t),updateProps:ye(e,t),getIsMounted:Fe(),getFieldNames:K(e),getDataSet:Me(D),setDataSet:ke(m,e==null?void 0:e.onDataSetChanged),getValues:Gn(C),setValues:vn(O,g),isDataPlainList:Te(x),getEditFormApi:qt(r),getEditGroupFormApi:Ut(o),getSelectedKeys:Dn(C),getSelectedNodes:Nn(n,C),isNodeSelected:Ve(n),selectNode:En(n,e.multiple),getActiveNodeKey:Le(n),getActiveNode:Be(n),getExpandedKeys:Ke(N),setExpandedKeys:We(Z),getExpandedNodes:ze(n),isNodeExpanded:Pe(n),expandNode:He(n),collapseNode:Qe(n),toggleNode:Ue(n),expandParentNodes:qe(n),getNode:_e(n),getNodes:Xe(n),getNextNodeKey:$e(n),getPrevNodeKey:Je(n),getNextNode:Ye(n),getPrevNode:Ze(n),getParentNode:pe(n),addNode:et(n),updateNode:tt(n),removeNode:nt(n),moveNode:rt(n),ensureNodeVisible:ot(n),t:Mn(e),treeSelectRef:d.useRef(null),getButtonsApi:ue(),getIsReady:Ht(s),setIsReady:Qt(u),getIsOpen:Wt(S),setIsOpen:zt(F),getIsFetching:_t(a),setIsFetching:Xt(l),getFetchError:$t(i),setFetchError:Jt(f),getIsAllFetched:Yt(h),setIsAllFetched:Zt(b),getMinSymbols:pt(y),setMinSymbols:en(R),fetchData:xn(p,n)};return Object.assign(n,ee),n},Tn=e=>{const[t,n]=Se(e),r=Vn(t),o=kn({props:t,setProps:n});return d.useEffect(()=>{var s;(!t.fetchMode||t.fetchMode==="onLoad")&&!t.minSearchLength?o.fetchData():o.getIsReady()||(o.setIsReady(!0),(s=t==null?void 0:t.onReady)==null||s.call(t))},[o,t,t.fetchMode,t.minSearchLength]),c.jsx(it,{children:c.jsx(Dt,{api:o,allProps:t,treeSelectProps:r})})},Vn=e=>d.useMemo(()=>X(e,{apiRef:!0,componentId:!0,dataMutator:!0,readOnly:!0,value:!0,filterTreeNode:!0,dataSet:!0,fetchMode:!0,noCacheFetchedData:!0,minSearchLength:!0,debounce:!0,editFormProps:!0,nodeDeleteMessage:!0,confirmDelete:!0,buttons:!0,onReady:!0,onDataFetch:!0,onDataFetchSuccess:!0,onDataFetchError:!0,onDataFetchComplete:!0,onDelete:!0,fieldNames:!0,titleRender:!0,selectedRender:!0,editGroupFormProps:!0,defaultExpandAll:!0,defaultExpandedKeys:!0,expandedKeys:!0,buttonsRowStyle:!0,buttonsRowWrapperStyle:!0,buttonsIconsOnly:!0,buttonsPosition:!0,buttonsSize:!0,headerLabel:!0,language:!0,translation:!0,selectNewNode:!0,groupsMode:!0,onChange:!0,onGetLabelCallback:!0,onDataSetChanged:!0})[1],[e]),Ln=(e,t)=>d.useCallback((n,r,o)=>{var s;if(e.isReady()){switch(t.valueType){case void 0:case"node":t.multiple?e.setValue(o??void 0):e.setValue(o!=null&&o.length?o[0]:void 0);break;case"labeledValue":e.setValue(n??void 0);break;case"key":t.multiple?e.setValue(r??void 0):e.setValue(r!=null&&r.length?r[0]:void 0);break}e.setDirty(!0)}(s=t.onChange)==null||s.call(t,n,r,o,e)},[e,t]),Bn=e=>d.useCallback(()=>{e.setTouched(!0)},[e]),Kn=e=>d.useCallback(()=>{var n;e.setDirty(!0),e.setTouched(!0);const t=e.getProps();(n=t.onClear)==null||n.call(t)},[e]),Wn=(e,t)=>d.useCallback(n=>{var r;return(r=t.onDataSetChanged)==null?void 0:r.call(t,n,e)},[e,t]),zn=e=>d.useMemo(()=>X(e,{autoFocus:!0,autoHeightResize:!0,component:!0,dependsOn:!0,disabled:!0,helpClass:!0,hidden:!0,inlineGroup:!0,label:!0,nonEditable:!0,onDirtyStateChanged:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,onReady:!0,onReadyStateChanged:!0,onTouchedStateChanged:!0,onValidated:!0,onValueChanged:!0,placeholder:!0,readOnly:!0,requiredMark:!0,rowStyle:!0,rules:!0,style:!0,tab:!0,tooltip:!0,value:!0,width:!0,valueType:!0,onDataSetChanged:!0,onChange:!0,dataSet:!0,onDataFetch:!0})[1],[e]),Pn=({field:e})=>{d.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const[t]=d.useState({}),n=e.getProps(),r=e.getValue(),o=Bn(e),s=Kn(e),u=Hn(e,n.dataSet),a=Ln(e,n),l=Wn(e,n),i=Qn(e,n),f=Un(e,n);d.useEffect(()=>{e.setReady(!0)},[e]);const h={width:n.width??"100%",...n.style},b=zn(n);return c.jsx(Tn,{apiRef:t,style:h,...b,dataSet:u,autoFocus:n.autoFocus,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:r,placeholder:n.placeholder??"Choose",onChange:a,onDataSetChanged:l,onDataFetch:i,onReady:f,onClear:s,onBlur:o})},Hn=(e,t)=>d.useMemo(()=>typeof t!="function"?t:()=>t(e),[t,e]),Qn=(e,t)=>d.useCallback((n,r)=>{var o;return(o=t.onDataFetch)==null?void 0:o.call(t,n,r,e)},[e,t]),Un=(e,t)=>d.useCallback(()=>{var n;return(n=t.onReady)==null?void 0:n.call(t,e)},[e,t]);class pn extends de{render(){return c.jsx(Pn,{field:this})}}export{Tn as T,pn as a};
