import{r as l,B as G,n as ve,t as Jt,i as Rt,w as rt,h as Yt,bc as Zt,f as ge,K as $e,_ as Lt,k as yt,l as Qt,g as en,m as Vt,u as pt,o as tn,H as nn,G as xt,a as Dt,L as rn,A as on,v as an,J as ln,ag as sn,aq as It,j as C,ak as tt,T as un,R as nt}from"./index-zp8t8nBI.js";import{g as cn,S as dn,G as dt,I as He,R as fn,M as hn,m as kt,b as vn,c as gn,u as mn,d as Cn,C as bn,e as Sn,f as At,a as yn}from"./dForm-CtyM7E66.js";import{D as pn}from"./dFormModal-DQXWVkWJ.js";import{u as xn,a as Dn,B as In,b as kn,D as wn,m as En,c as Tn}from"./useShowArrow-Dt3J_uW-.js";import{c as st,a as Fn,T as Mn,i as Nn,g as Rn,b as Ln,S as Vn,R as An}from"./DeleteOutlined-oAPYnq6c.js";import{f as _n,j as On,g as jn,R as Kn}from"./docco-qM7CaTt5.js";import{u as $n}from"./useIcons-DXo1KyCf.js";const Hn=function(e){var t=l.useRef({valueLabels:new Map});return l.useMemo(function(){var n=t.current.valueLabels,r=new Map,o=e.map(function(a){var s,u=a.value,c=(s=a.label)!==null&&s!==void 0?s:n.get(u);return r.set(u,c),G(G({},a),{},{label:c})});return t.current.valueLabels=r,[o]},[e])},Wn=function(e,t,n,r){return l.useMemo(function(){var o=e.map(function(c){var i=c.value;return i}),a=t.map(function(c){var i=c.value;return i}),s=o.filter(function(c){return!r[c]});if(n){var u=st(o,!0,r);o=u.checkedKeys,a=u.halfCheckedKeys}return[Array.from(new Set([].concat(ve(s),ve(o)))),a]},[e,t,n,r])};function Bn(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Gn(e){var t=e||{},n=t.label,r=t.value,o=t.children,a=r||"value";return{_title:n?[n]:["title","label"],value:a,key:a,children:o||"children"}}function ut(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function Pn(e,t){var n=[];function r(o){o.forEach(function(a){var s=a[t.children];s&&(n.push(a[t.value]),r(s))})}return r(e),n}function wt(e){return e==null}const zn=function(e,t){return l.useMemo(function(){var n=Fn(e,{fieldNames:t,initWrapper:function(o){return G(G({},o),{},{valueEntities:new Map})},processEntity:function(o,a){var s=o.node[t.value];a.valueEntities.set(s,o)}});return n},[e,t])};var ft=function(){return null},Un=["children","value"];function _t(e){return Jt(e).map(function(t){if(!l.isValidElement(t)||!t.type)return null;var n=t,r=n.key,o=n.props,a=o.children,s=o.value,u=Rt(o,Un),c=G({key:r,value:s},u),i=_t(a);return i.length&&(c.children=i),c}).filter(function(t){return t})}function ct(e){if(!e)return e;var t=G({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return rt(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function qn(e,t,n,r,o,a){var s=null,u=null;function c(){function i(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(v,m){var b="".concat(h,"-").concat(m),I=v[a.value],N=n.includes(I),V=i(v[a.children]||[],b,N),A=l.createElement(ft,v,V.map(function(L){return L.node}));if(t===I&&(s=A),N){var $={pos:b,node:A,children:V};return f||u.push($),$}return null}).filter(function(v){return v})}u||(u=[],i(r),u.sort(function(d,h){var f=d.node.props.value,v=h.node.props.value,m=n.indexOf(f),b=n.indexOf(v);return m-b}))}Object.defineProperty(e,"triggerNode",{get:function(){return rt(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),c(),s}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return rt(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),c(),o?u:u.map(function(d){var h=d.node;return h})}})}const Xn=function(e,t,n){var r=n.treeNodeFilterProp,o=n.filterTreeNode,a=n.fieldNames,s=a.children;return l.useMemo(function(){if(!t||o===!1)return e;var u;if(typeof o=="function")u=o;else{var c=t.toUpperCase();u=function(h,f){var v=f[r];return String(v).toUpperCase().includes(c)}}function i(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.reduce(function(f,v){var m=v[s],b=h||u(t,ct(v)),I=i(m||[],b);return(b||I.length)&&f.push(G(G({},v),{},Yt({isLeaf:void 0},s,I))),f},[])}return i(e)},[e,t,s,r,o])};function Et(e){var t=l.useRef();t.current=e;var n=l.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}function Jn(e,t){var n=t.id,r=t.pId,o=t.rootPId,a={},s=[],u=e.map(function(c){var i=G({},c),d=i[n];return a[d]=i,i.key=i.key||d,i});return u.forEach(function(c){var i=c[r],d=a[i];d&&(d.children=d.children||[],d.children.push(c)),(i===o||!d&&o===null)&&s.push(c)}),s}function Yn(e,t,n){return l.useMemo(function(){return e?n?Jn(e,G({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:_t(t)},[t,n,e])}var Ot=l.createContext(null),jt=l.createContext(null),Zn={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Qn=function(t,n){var r=xn(),o=r.prefixCls,a=r.multiple,s=r.searchValue,u=r.toggleOpen,c=r.open,i=r.notFoundContent,d=l.useContext(jt),h=d.virtual,f=d.listHeight,v=d.listItemHeight,m=d.listItemScrollOffset,b=d.treeData,I=d.fieldNames,N=d.onSelect,V=d.dropdownMatchSelectWidth,A=d.treeExpandAction,$=d.treeTitleRender,L=d.onPopupScroll,g=l.useContext(Ot),E=g.checkable,T=g.checkedKeys,J=g.halfCheckedKeys,me=g.treeExpandedKeys,Ce=g.treeDefaultExpandAll,be=g.treeDefaultExpandedKeys,Se=g.onTreeExpand,Y=g.treeIcon,Ne=g.showTreeIcon,Z=g.switcherIcon,Re=g.treeLine,Q=g.treeNodeFilterProp,ae=g.loadData,P=g.treeLoadedKeys,Le=g.treeMotion,Ve=g.onTreeLoad,Ae=g.keyEntities,U=l.useRef(),M=Zt(function(){return b},[c,b],function(F,S){return S[0]&&F[1]!==S[1]}),ye=l.useState(null),H=ge(ye,2),le=H[0],se=H[1],O=Ae[le],ue=l.useMemo(function(){return E?{checked:T,halfChecked:J}:null},[E,T,J]);l.useEffect(function(){if(c&&!a&&T.length){var F;(F=U.current)===null||F===void 0||F.scrollTo({key:T[0]}),se(T[0])}},[c]);var pe=String(s).toLowerCase(),xe=function(S){return pe?String(S[Q]).toLowerCase().includes(pe):!1},De=l.useState(be),ee=ge(De,2),Ie=ee[0],We=ee[1],Be=l.useState(null),z=ge(Be,2),te=z[0],ke=z[1],W=l.useMemo(function(){return me?ve(me):s?te:Ie},[Ie,te,me,s]);l.useEffect(function(){s&&ke(Pn(b,I))},[s]);var _e=function(S){We(S),ke(S),Se&&Se(S)},we=function(S){S.preventDefault()},q=function(S,ce){var B=ce.node;E&&ut(B)||(N(B.key,{selected:!T.includes(B.key)}),a||u(!1))};if(l.useImperativeHandle(n,function(){var F;return{scrollTo:(F=U.current)===null||F===void 0?void 0:F.scrollTo,onKeyDown:function(ce){var B,ie=ce.which;switch(ie){case $e.UP:case $e.DOWN:case $e.LEFT:case $e.RIGHT:(B=U.current)===null||B===void 0||B.onKeyDown(ce);break;case $e.ENTER:{if(O){var Te=(O==null?void 0:O.node)||{},Ge=Te.selectable,ne=Te.value;Ge!==!1&&q(null,{node:{key:le},selected:!T.includes(ne)})}break}case $e.ESC:u(!1)}},onKeyUp:function(){}}}),M.length===0)return l.createElement("div",{role:"listbox",className:"".concat(o,"-empty"),onMouseDown:we},i);var Ee={fieldNames:I};return P&&(Ee.loadedKeys=P),W&&(Ee.expandedKeys=W),l.createElement("div",{onMouseDown:we},O&&c&&l.createElement("span",{style:Zn,"aria-live":"assertive"},O.node.value),l.createElement(Mn,Lt({ref:U,focusable:!1,prefixCls:"".concat(o,"-tree"),treeData:M,height:f,itemHeight:v,itemScrollOffset:m,virtual:h!==!1&&V!==!1,multiple:a,icon:Y,showIcon:Ne,switcherIcon:Z,showLine:Re,loadData:s?null:ae,motion:Le,activeKey:le,checkable:E,checkStrictly:!0,checkedKeys:ue,selectedKeys:E?[]:T,defaultExpandAll:Ce,titleRender:$},Ee,{onActiveChange:se,onSelect:q,onCheck:q,onExpand:_e,onLoad:Ve,filterTreeNode:xe,expandAction:A,onScroll:L})))},er=l.forwardRef(Qn),ht="SHOW_ALL",vt="SHOW_PARENT",ot="SHOW_CHILD";function Tt(e,t,n,r){var o=new Set(e);return t===ot?e.filter(function(a){var s=n[a];return!(s&&s.children&&s.children.some(function(u){var c=u.node;return o.has(c[r.value])})&&s.children.every(function(u){var c=u.node;return ut(c)||o.has(c[r.value])}))}):t===vt?e.filter(function(a){var s=n[a],u=s?s.parent:null;return!(u&&!ut(u.node)&&o.has(u.key))}):e}var tr=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender","onPopupScroll"];function nr(e){return!e||Qt(e)!=="object"}var rr=l.forwardRef(function(e,t){var n=e.id,r=e.prefixCls,o=r===void 0?"rc-tree-select":r,a=e.value,s=e.defaultValue,u=e.onChange,c=e.onSelect,i=e.onDeselect,d=e.searchValue,h=e.inputValue,f=e.onSearch,v=e.autoClearSearchValue,m=v===void 0?!0:v,b=e.filterTreeNode,I=e.treeNodeFilterProp,N=I===void 0?"value":I,V=e.showCheckedStrategy,A=e.treeNodeLabelProp,$=e.multiple,L=e.treeCheckable,g=e.treeCheckStrictly,E=e.labelInValue,T=e.fieldNames,J=e.treeDataSimpleMode,me=e.treeData,Ce=e.children,be=e.loadData,Se=e.treeLoadedKeys,Y=e.onTreeLoad,Ne=e.treeDefaultExpandAll,Z=e.treeExpandedKeys,Re=e.treeDefaultExpandedKeys,Q=e.onTreeExpand,ae=e.treeExpandAction,P=e.virtual,Le=e.listHeight,Ve=Le===void 0?200:Le,Ae=e.listItemHeight,U=Ae===void 0?20:Ae,M=e.listItemScrollOffset,ye=M===void 0?0:M,H=e.onDropdownVisibleChange,le=e.dropdownMatchSelectWidth,se=le===void 0?!0:le,O=e.treeLine,ue=e.treeIcon,pe=e.showTreeIcon,xe=e.switcherIcon,De=e.treeMotion,ee=e.treeTitleRender,Ie=e.onPopupScroll,We=Rt(e,tr),Be=Dn(n),z=L&&!g,te=L||g,ke=g||E,W=te||$,_e=yt(s,{value:a}),we=ge(_e,2),q=we[0],Ee=we[1],F=l.useMemo(function(){return L?V||ot:ht},[V,L]),S=l.useMemo(function(){return Gn(T)},[JSON.stringify(T)]),ce=yt("",{value:d!==void 0?d:h,postState:function(y){return y||""}}),B=ge(ce,2),ie=B[0],Te=B[1],Ge=function(y){Te(y),f==null||f(y)},ne=Yn(me,Ce,J),qe=zn(ne,S),_=qe.keyEntities,re=qe.valueEntities,Xe=l.useCallback(function(p){var y=[],x=[];return p.forEach(function(k){re.has(k)?x.push(k):y.push(k)}),{missingRawValues:y,existRawValues:x}},[re]),Je=Xn(ne,ie,{fieldNames:S,treeNodeFilterProp:N,filterTreeNode:b}),Ye=l.useCallback(function(p){if(p){if(A)return p[A];for(var y=S._title,x=0;x<y.length;x+=1){var k=p[y[x]];if(k!==void 0)return k}}},[S,A]),oe=l.useCallback(function(p){var y=Bn(p);return y.map(function(x){return nr(x)?{value:x}:x})},[]),de=l.useCallback(function(p){var y=oe(p);return y.map(function(x){var k=x.label,j=x.value,R=x.halfChecked,w,D=re.get(j);if(D){var K;k=(K=k)!==null&&K!==void 0?K:Ye(D.node),w=D.node.disabled}else if(k===void 0){var fe=oe(q).find(function(Pe){return Pe.value===j});k=fe.label}return{label:k,value:j,halfChecked:R,disabled:w}})},[re,Ye,oe,q]),gt=l.useMemo(function(){return oe(q)},[oe,q]),$t=l.useMemo(function(){var p=[],y=[];return gt.forEach(function(x){x.halfChecked?y.push(x):p.push(x)}),[p,y]},[gt]),mt=ge($t,2),Oe=mt[0],Ct=mt[1],bt=l.useMemo(function(){return Oe.map(function(p){return p.value})},[Oe]),Ht=Wn(Oe,Ct,z,_),St=ge(Ht,2),je=St[0],Ze=St[1],Wt=l.useMemo(function(){var p=Tt(je,F,_,S),y=p.map(function(R){var w,D;return(w=(D=_[R])===null||D===void 0||(D=D.node)===null||D===void 0?void 0:D[S.value])!==null&&w!==void 0?w:R}),x=y.map(function(R){var w=Oe.find(function(K){return K.value===R}),D;return E&&w.label!==void 0?D=w.label:!E&&ee&&(D=ee(w)),{value:R,label:D}}),k=de(x),j=k[0];return!W&&j&&wt(j.value)&&wt(j.label)?[]:k.map(function(R){var w;return G(G({},R),{},{label:(w=R.label)!==null&&w!==void 0?w:R.value})})},[S,W,je,Oe,de,F,_]),Bt=Hn(Wt),Gt=ge(Bt,1),Pt=Gt[0],Qe=Et(function(p,y,x){var k=de(p);if(Ee(k),m&&Te(""),u){var j=p;if(z){var R=Tt(p,F,_,S);j=R.map(function(X){var he=re.get(X);return he?he.node[S.value]:X})}var w=y||{triggerValue:void 0,selected:void 0},D=w.triggerValue,K=w.selected,fe=j;if(g){var Pe=Ct.filter(function(X){return!j.includes(X.value)});fe=[].concat(ve(fe),ve(Pe))}var ze=de(fe),Fe={preValue:Oe,triggerValue:D},Ke=!0;(g||x==="selection"&&!K)&&(Ke=!1),qn(Fe,D,p,ne,Ke,S),te?Fe.checked=K:Fe.selected=K;var et=ke?ze:ze.map(function(X){return X.value});u(W?et:et[0],ke?null:ze.map(function(X){return X.label}),Fe)}}),at=l.useCallback(function(p,y){var x,k=y.selected,j=y.source,R=_[p],w=R==null?void 0:R.node,D=(x=w==null?void 0:w[S.value])!==null&&x!==void 0?x:p;if(!W)Qe([D],{selected:!0,triggerValue:D},"option");else{var K=k?[].concat(ve(bt),[D]):je.filter(function(he){return he!==D});if(z){var fe=Xe(K),Pe=fe.missingRawValues,ze=fe.existRawValues,Fe=ze.map(function(he){return re.get(he).key}),Ke;if(k){var et=st(Fe,!0,_);Ke=et.checkedKeys}else{var X=st(Fe,{checked:!1,halfCheckedKeys:Ze},_);Ke=X.checkedKeys}K=[].concat(ve(Pe),ve(Ke.map(function(he){return _[he].node[S.value]})))}Qe(K,{selected:k,triggerValue:D},j||"option")}k||!W?c==null||c(D,ct(w)):i==null||i(D,ct(w))},[Xe,re,_,S,W,bt,Qe,z,c,i,je,Ze]),zt=l.useCallback(function(p){if(H){var y={};Object.defineProperty(y,"documentClickClose",{get:function(){return rt(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),H(p,y)}},[H]),Ut=Et(function(p,y){var x=p.map(function(k){return k.value});if(y.type==="clear"){Qe(x,{},"selection");return}y.values.length&&at(y.values[0].value,{selected:!1,source:"selection"})}),qt=l.useMemo(function(){return{virtual:P,dropdownMatchSelectWidth:se,listHeight:Ve,listItemHeight:U,listItemScrollOffset:ye,treeData:Je,fieldNames:S,onSelect:at,treeExpandAction:ae,treeTitleRender:ee,onPopupScroll:Ie}},[P,se,Ve,U,ye,Je,S,at,ae,ee,Ie]),Xt=l.useMemo(function(){return{checkable:te,loadData:be,treeLoadedKeys:Se,onTreeLoad:Y,checkedKeys:je,halfCheckedKeys:Ze,treeDefaultExpandAll:Ne,treeExpandedKeys:Z,treeDefaultExpandedKeys:Re,onTreeExpand:Q,treeIcon:ue,treeMotion:De,showTreeIcon:pe,switcherIcon:xe,treeLine:O,treeNodeFilterProp:N,keyEntities:_}},[te,be,Se,Y,je,Ze,Ne,Z,Re,Q,ue,De,pe,xe,O,N,_]);return l.createElement(jt.Provider,{value:qt},l.createElement(Ot.Provider,{value:Xt},l.createElement(In,Lt({ref:t},We,{id:Be,prefixCls:o,mode:W?"multiple":void 0,displayValues:Pt,onDisplayValuesChange:Ut,searchValue:ie,onSearch:Ge,OptionList:er,emptyOptions:!ne.length,onDropdownVisibleChange:zt,dropdownMatchSelectWidth:se}))))}),Ue=rr;Ue.TreeNode=ft;Ue.SHOW_ALL=ht;Ue.SHOW_PARENT=vt;Ue.SHOW_CHILD=ot;const or=e=>{const{componentCls:t,treePrefixCls:n,colorBgElevated:r}=e,o=`.${n}`;return[{[`${t}-dropdown`]:[{padding:`${pt(e.paddingXS)} ${pt(e.calc(e.paddingXS).div(2).equal())}`},Rn(n,Vt(e,{colorBgContainer:r})),{[o]:{borderRadius:0,[`${o}-list-holder-inner`]:{alignItems:"stretch",[`${o}-treenode`]:{[`${o}-node-content-wrapper`]:{flex:"auto"}}}}},Ln(`${n}-checkbox`,e),{"&-rtl":{direction:"rtl",[`${o}-switcher${o}-switcher_close`]:{[`${o}-switcher-icon svg`]:{transform:"rotate(90deg)"}}}}]}]};function ar(e,t,n){return en("TreeSelect",r=>{const o=Vt(r,{treePrefixCls:t});return[or(o)]},Nn)(e,n)}var lr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};const sr=(e,t)=>{var n,{prefixCls:r,size:o,disabled:a,bordered:s=!0,className:u,rootClassName:c,treeCheckable:i,multiple:d,listHeight:h=256,listItemHeight:f=26,placement:v,notFoundContent:m,switcherIcon:b,treeLine:I,getPopupContainer:N,popupClassName:V,dropdownClassName:A,treeIcon:$=!1,transitionName:L,choiceTransitionName:g="",status:E,treeExpandAction:T,builtinPlacements:J,dropdownMatchSelectWidth:me,popupMatchSelectWidth:Ce,allowClear:be,variant:Se,dropdownStyle:Y,tagRender:Ne}=e,Z=lr(e,["prefixCls","size","disabled","bordered","className","rootClassName","treeCheckable","multiple","listHeight","listItemHeight","placement","notFoundContent","switcherIcon","treeLine","getPopupContainer","popupClassName","dropdownClassName","treeIcon","transitionName","choiceTransitionName","status","treeExpandAction","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","allowClear","variant","dropdownStyle","tagRender"]);const{getPopupContainer:Re,getPrefixCls:Q,renderEmpty:ae,direction:P,virtual:Le,popupMatchSelectWidth:Ve,popupOverflow:Ae}=l.useContext(tn),U=Q(),M=Q("select",r),ye=Q("select-tree",r),H=Q("tree-select",r),{compactSize:le,compactItemClassnames:se}=nn(M,P),O=xt(M),ue=xt(H),[pe,xe,De]=kn(M,O),[ee]=ar(H,ye,ue),[Ie,We]=_n(Se,s),Be=Dt(V||A,`${H}-dropdown`,{[`${H}-dropdown-rtl`]:P==="rtl"},c,De,O,ue,xe),z=!!(i||d),te=Tn(Z.suffixIcon,Z.showArrow),ke=(n=Ce??me)!==null&&n!==void 0?n:Ve,{status:W,hasFeedback:_e,isFormItemInput:we,feedbackIcon:q}=l.useContext(rn),Ee=jn(W,E),{suffixIcon:F,removeIcon:S,clearIcon:ce}=$n(Object.assign(Object.assign({},Z),{multiple:z,showSuffixIcon:te,hasFeedback:_e,feedbackIcon:q,prefixCls:M,componentName:"TreeSelect"})),B=be===!0?{clearIcon:ce}:be;let ie;m!==void 0?ie=m:ie=(ae==null?void 0:ae("Select"))||l.createElement(wn,{componentName:"Select"});const Te=on(Z,["suffixIcon","removeIcon","clearIcon","itemIcon","switcherIcon"]),Ge=l.useMemo(()=>v!==void 0?v:P==="rtl"?"bottomRight":"bottomLeft",[v,P]),ne=an(oe=>{var de;return(de=o??le)!==null&&de!==void 0?de:oe}),qe=l.useContext(ln),_=a??qe,re=Dt(!r&&H,{[`${M}-lg`]:ne==="large",[`${M}-sm`]:ne==="small",[`${M}-rtl`]:P==="rtl",[`${M}-${Ie}`]:We,[`${M}-in-form-item`]:we},On(M,Ee,_e),se,u,c,De,O,ue,xe),Xe=oe=>l.createElement(Vn,{prefixCls:ye,switcherIcon:b,treeNodeProps:oe,showLine:I}),[Je]=sn("SelectLike",Y==null?void 0:Y.zIndex),Ye=l.createElement(Ue,Object.assign({virtual:Le,disabled:_},Te,{dropdownMatchSelectWidth:ke,builtinPlacements:En(J,Ae),ref:t,prefixCls:M,className:re,listHeight:h,listItemHeight:f,treeCheckable:i&&l.createElement("span",{className:`${M}-tree-checkbox-inner`}),treeLine:!!I,suffixIcon:F,multiple:z,placement:Ge,removeIcon:S,allowClear:B,switcherIcon:Xe,showTreeIcon:$,notFoundContent:ie,getPopupContainer:N||Re,treeMotion:null,dropdownClassName:Be,dropdownStyle:Object.assign(Object.assign({},Y),{zIndex:Je}),choiceTransitionName:It(U,"",g),transitionName:It(U,"slide-up",L),treeExpandAction:T,tagRender:z?Ne:void 0}));return pe(ee(Ye))},ur=l.forwardRef(sr),Me=ur,cr=cn(Me);Me.TreeNode=ft;Me.SHOW_ALL=ht;Me.SHOW_PARENT=vt;Me.SHOW_CHILD=ot;Me._InternalPanelDoNotUseOrYouWillBeFired=cr;const ir=()=>{const e=l.useRef(!0);return l.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),e},dr=e=>l.useMemo(()=>({...{maxHeight:400,overflow:"auto"},...e||{}}),[e]),fr=({fetching:e,error:t,minSymbols:n,plainList:r})=>n?C.jsx(hr,{minSymbols:n,plainList:r}):e?C.jsx(vr,{plainList:r}):t?C.jsx(gr,{error:t,plainList:r}):C.jsx(C.Fragment,{}),hr=({minSymbols:e,plainList:t})=>C.jsxs("div",{style:{paddingLeft:t?"8px":"30px",fontSize:"12px"},children:["Введите как минимум ",e," симв."]}),vr=({plainList:e})=>C.jsxs("div",{style:{paddingLeft:e?"8px":"30px",fontSize:"12px"},children:[C.jsx(dn,{size:"small"})," загрузка..."]}),gr=({error:e,plainList:t})=>C.jsx("div",{role:"alert",style:{paddingLeft:t?"8px":"30px",fontSize:"12px",color:"#ff4d4f"},children:e}),mr=({fetching:e,error:t,minSymbols:n,plainList:r})=>n||e||t?C.jsx(C.Fragment,{}):C.jsx("div",{style:{paddingLeft:r?"8px":"30px",fontSize:"12px"},children:"Данные отсутствуют"}),Cr=({menu:e,fetching:t,error:n,minSymbols:r,plainList:o})=>C.jsxs(C.Fragment,{children:[e,C.jsx(fr,{fetching:t,error:n,minSymbols:r,plainList:o})]}),br=({fetchError:e,fetching:t,minSymbols:n,plainList:r})=>l.useCallback(o=>C.jsx("div",{className:r?"tree-select-plain":void 0,children:C.jsx(Cr,{menu:o,fetching:t,error:e,minSymbols:n,plainList:r})}),[e,t,n,r]),Sr=e=>{const t=e.getProps().fieldNames,n=(t==null?void 0:t.title)||"title";return l.useCallback((r,o)=>{const a=o;return!a||typeof a[n]!="string"?!1:a[n].toLowerCase().indexOf(r.toLowerCase())>=0},[n])},Ft=({api:e,treeSelectProps:t,antdTreeSelectProps:n})=>{var s,u,c,i,d;const r=dr(t.dropdownStyle),o=br({fetchError:e.getFetchError(),fetching:e.getIsFetching(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),a=Sr(e);return C.jsx(Me,{...n,treeData:e.getDataSet(),showSearch:t.showSearch!==!1,treeDefaultExpandAll:t.treeDefaultExpandAll!==!1,disabled:t.disabled||t.readOnly,dropdownStyle:r,fieldNames:{label:t.titleRender?"__title":((s=t.fieldNames)==null?void 0:s.title)??"title",value:(u=t.fieldNames)!=null&&u.value?t.fieldNames.value:"id",children:(c=t.fieldNames)!=null&&c.children?t.fieldNames.children:"children"},treeNodeLabelProp:t.selectedLabelProp?t.selectedLabelProp:t.labelRender?"__label":((i=t.fieldNames)==null?void 0:i.title)??"title",treeNodeFilterProp:t.titleRender?"__title":((d=t.fieldNames)==null?void 0:d.title)??"title",filterTreeNode:(h,f)=>e.getIsAllFetched()?t.filterTreeNode?typeof t.filterTreeNode=="function"?t.filterTreeNode(h,f):t.filterTreeNode:a(h,f):!0,value:e.getInternalValue(),notFoundContent:t.notFoundContent??C.jsx(mr,{fetching:e.getIsFetching(),error:e.getFetchError(),minSymbols:e.getMinSymbols(),plainList:t.plainList}),dropdownRender:t.dropdownRender??o,onClear:()=>{var h,f;(h=t.onClear)==null||h.call(t),e.setValues(null),(f=t.onClear)==null||f.call(t)},onChange:h=>{var v;const f=e.plainValueToNodes(h);e.setValues(f??null),(v=t.onChange)==null||v.call(t,f??null)},onDropdownVisibleChange:h=>{var f;h&&(t.fetchMode==="onUse"||t.fetchMode==="onUseForce")&&e.fetchData(""),(f=t.onDropdownVisibleChange)==null||f.call(t,h)},onSearch:h=>{var f;e.fetchData(h,!0),(f=t.onSearch)==null||f.call(t,h)}})},yr=e=>{const n=e.getProps().editFormProps,[r]=l.useState((n==null?void 0:n.apiRef)||{}),[o]=l.useState((n==null?void 0:n.formId)??"SelectItemEdit-"+dt());return[l.useMemo(()=>{if(!n)return;const u={...{width:400,minWidth:200,bodyHeight:200,bodyMinHeight:40},...n,apiRef:r,formId:o},c=u==null?void 0:u.onSubmitSuccess;return u.onSubmitSuccess=(i,d,h)=>{if(!d||(c==null?void 0:c(i,d,h))===!1)return;const f={...h.model.getFormDataSet()??{},...d};if(h.getFormProps().formMode==="update")e.updateNodes(f);else{const m=e.getValues(),b=m&&m.length>0?m[0]:void 0;e.addNodes(b,f)}e.setValues([f])},u},[n,r,o,e]),r]},pr=e=>l.useCallback(t=>{var o;if(!e.isMounted())return;const n=e.getProps();if(!n.noCacheFetchedData&&e.getIsAllFetched())return;if(n.minSearchLength&&t.length<n.minSearchLength){e.setSetMynSymbols(n.minSearchLength),e.setDataSet(void 0);return}e.setSetMynSymbols(0),e.setSetFetchError(null);const r=(o=n==null?void 0:n.onDataFetch)==null?void 0:o.call(n,t,e);if(!r){e.setIsAllFetched(!0);return}e.setIsFetching(!0),t||e.setDataSet(null),r.then(a=>{var s,u,c;e.isMounted()&&(e.setDataSet(a.data),e.setIsAllFetched(e.getIsAllFetched()||!t),e.getIsReady()||(e.setIsReady(!0),(s=n==null?void 0:n.onReady)==null||s.call(n)),e.setIsFetching(!1),(u=n==null?void 0:n.onDataFetchSuccess)==null||u.call(n,a,e),(c=n==null?void 0:n.onDataFetchComplete)==null||c.call(n,e))},a=>{e.isMounted()&&(e.setSetFetchError(a.message),e.setDataSet(void 0),e.setIsFetching(!1))})},[e]);var xr="Expected a function",Mt=NaN,Dr="[object Symbol]",Ir=/^\s+|\s+$/g,kr=/^[-+]0x[0-9a-f]+$/i,wr=/^0b[01]+$/i,Er=/^0o[0-7]+$/i,Tr=parseInt,Fr=typeof tt=="object"&&tt&&tt.Object===Object&&tt,Mr=typeof self=="object"&&self&&self.Object===Object&&self,Nr=Fr||Mr||Function("return this")(),Rr=Object.prototype,Lr=Rr.toString,Vr=Math.max,Ar=Math.min,lt=function(){return Nr.Date.now()};function _r(e,t,n){var r,o,a,s,u,c,i=0,d=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(xr);t=Nt(t)||0,it(n)&&(d=!!n.leading,h="maxWait"in n,a=h?Vr(Nt(n.maxWait)||0,t):a,f="trailing"in n?!!n.trailing:f);function v(g){var E=r,T=o;return r=o=void 0,i=g,s=e.apply(T,E),s}function m(g){return i=g,u=setTimeout(N,t),d?v(g):s}function b(g){var E=g-c,T=g-i,J=t-E;return h?Ar(J,a-T):J}function I(g){var E=g-c,T=g-i;return c===void 0||E>=t||E<0||h&&T>=a}function N(){var g=lt();if(I(g))return V(g);u=setTimeout(N,b(g))}function V(g){return u=void 0,f&&r?v(g):(r=o=void 0,s)}function A(){u!==void 0&&clearTimeout(u),i=0,r=c=o=u=void 0}function $(){return u===void 0?s:V(lt())}function L(){var g=lt(),E=I(g);if(r=arguments,o=this,c=g,E){if(u===void 0)return m(c);if(h)return u=setTimeout(N,t),v(c)}return u===void 0&&(u=setTimeout(N,t)),s}return L.cancel=A,L.flush=$,L}function it(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Or(e){return!!e&&typeof e=="object"}function jr(e){return typeof e=="symbol"||Or(e)&&Lr.call(e)==Dr}function Nt(e){if(typeof e=="number")return e;if(jr(e))return Mt;if(it(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=it(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ir,"");var n=wr.test(e);return n||Er.test(e)?Tr(e.slice(2),n?2:8):kr.test(e)?Mt:+e}var Kr=_r;const $r=un(Kr),Hr=(e,t,n,r)=>{const o=l.useRef([]),[a,s]=l.useState(r?[]:null),[,u]=l.useState([]),c=Wr(e,t,n),i=l.useCallback(d=>{if(!d){o.current=[],u([]),s(r?[]:null);return}if(!He(d)){const m={...d},b=c(m);o.current=[m],u([m]),s(r?b?[b]:[]:b??null);return}const h=[],f=[],v=[...d];for(const m of v){const b={...m},I=c(b);I&&(f.push(b),h.push(I))}r?(s(h),o.current=f,u(o.current)):(s(h.length>0?h[0]:null),o.current=f.length>0?[f[0]]:[],u(o.current))},[c,r,o]);return[a,o,i]},Wr=(e,t,n)=>l.useCallback(r=>{if(!r)return null;const o=(e==null?void 0:e.value)??"id",a=r[o];let s;if(t)s=t(r);else{const u=(e==null?void 0:e.title)??"title",c=n?"__title":"";s=r.label??void 0,!s&&c&&(s=r[c]),s||(s=r[u])}return{value:a,label:s??void 0}},[e==null?void 0:e.title,e==null?void 0:e.value,t,n]),Br=(e,t,n)=>l.useCallback(r=>{if(!r)return;const o=(e==null?void 0:e.value)??"id",a=r;let s=t(a);if(s||(s=n(a),s))return s;const u={};return u[o]=r,u},[e,t,n]),Gr=e=>{const t=e.getProps(),n=Pr(e.getDataSet()),r=zr(e.getValues()),o=Br(t.fieldNames,n,r);return l.useCallback(a=>{if(!a)return;const s=He(a)?a:[a],u=[];for(const c of s){const i=o(c);i&&u.push(i)}return u},[o])},Pr=e=>{const t=l.useRef();return t.current=e,l.useCallback(n=>{if(!t.current||!n)return;const r=(o,a)=>{for(const s of o){if(s.id===a)return s;if(!s.children)continue;const u=r(s.children,a);if(u)return u}};return r(t.current,n)},[])},zr=e=>{const t=l.useRef();return t.current=e,l.useCallback(n=>{if(!(!t.current||!n)){for(const r of t.current)if(r.id===n)return r}},[])},Ur=(e,t,n)=>{const[r,o]=l.useState(),a=l.useCallback(s=>{if(!n.current)return;if(!s){o(void 0);return}let u;e||t?u=Kt(s,e,t):u=s,o(u)},[e,t,n]);return[r,a]},Kt=(e,t,n)=>{if(!e)return[];const r=[];for(const o of e){const a={...o};n&&(a.__label=n(o)),t&&(a.__title=t(o)),r.push(a),o.children&&(a.children=Kt(a.children,t,n))}return r},qr=({api:e,componentId:t,treeProps:n,updateProps:r,buttonsApi:o})=>{const a=ir(),[s,u]=Ur(n.titleRender,n.labelRender,a),[c,i]=l.useState(!1),[d,h]=nt.useState(!1),[f,v]=nt.useState(""),[m,b]=nt.useState(!1),[I,N]=nt.useState(0),[V,A,$]=Hr(n.fieldNames,n.labelRender,n.titleRender,n.multiple);e.buttonsApi=o,e.getId=Xr(t),e.isMounted=Jr(a),e.getProps=Yr(n),e.setProps=Zr(n,r),e.getInternalValue=Qr(V),e.getValues=eo(A),e.setValues=to($,e),e.getDataSet=no(s),e.setDataSet=ro(u),e.plainValueToNodes=Gr(e),e.getIsReady=oo(c),e.setIsReady=ao(i),e.getIsFetching=lo(d),e.setIsFetching=so(h),e.getFetchError=uo(f),e.setSetFetchError=co(v),e.getIsAllFetched=io(m),e.setIsAllFetched=fo(b),e.getMinSymbols=ho(I),e.setSetMynSymbols=vo(N);const L=pr(e);e.fetchData=go(L,e),e.addNodes=mo(e),e.updateNodes=Co(e),e.deleteNodes=bo(e)},Xr=e=>l.useCallback(()=>e,[e]),Jr=e=>l.useCallback(()=>e.current,[e]),Yr=e=>l.useCallback(()=>e,[e]),Zr=(e,t)=>l.useCallback(n=>{t({...e,...n})},[e,t]),Qr=e=>l.useCallback(()=>e,[e]),eo=e=>l.useCallback(()=>e.current,[e]),to=(e,t)=>l.useCallback(n=>{var s,u,c,i;const r=t.getProps(),o=((s=r.fieldNames)==null?void 0:s.value)??"id";let a;typeof n!="string"?a=n:(a={},a[o]=n),e(a??[]),a?r.multiple?(i=r==null?void 0:r.onChange)==null||i.call(r,a||[]):(c=r==null?void 0:r.onChange)==null||c.call(r,He(a)&&a.length>0?a[0]:a):(u=r==null?void 0:r.onChange)==null||u.call(r,null)},[t,e]),no=e=>l.useCallback(()=>e,[e]),ro=e=>l.useCallback(t=>{e(t??[])},[e]),oo=e=>l.useCallback(()=>e,[e]),ao=e=>l.useCallback(t=>{e(t)},[e]),lo=e=>l.useCallback(()=>e,[e]),so=e=>l.useCallback(t=>{e(t)},[e]),uo=e=>l.useCallback(()=>e,[e]),co=e=>l.useCallback(t=>{e(t??"")},[e]),io=e=>l.useCallback(()=>e,[e]),fo=e=>l.useCallback(t=>{e(t)},[e]),ho=e=>l.useCallback(()=>e,[e]),vo=e=>l.useCallback(t=>{e(t)},[e]),go=(e,t)=>l.useCallback((n,r)=>{const o=$r(e,t.getProps().debounce??0);r?o(n):e(n)},[t,e]),mo=e=>l.useCallback((t,n)=>{var i,d;const r=He(n)?n:[n],o=e.getProps(),a=((i=o.fieldNames)==null?void 0:i.value)??"id",s=((d=o.fieldNames)==null?void 0:d.children)??"children",u=(h,f,v)=>{if(!f){for(const m of v)h.push(m);return}for(const m of h)if(m[a]){if(m[a]===f[a]){if(m.isLeaf)for(const b of v)h.push(b);else{m[s]||(m[s]=[]);const b=m[s];for(const I of v)b.push(I)}return!0}if(m[s]&&u(m[s],f,v))return!0}},c=[...e.getDataSet()??[]];for(const h of r)h[a]||(h[a]=dt());u(c,t,r),e.setDataSet(c)},[e]),Co=e=>l.useCallback(t=>{var c,i;const n=He(t)?t:[t],r=e.getProps(),o=((c=r.fieldNames)==null?void 0:c.value)??"id",a=((i=r.fieldNames)==null?void 0:i.children)??"children",s=(d,h)=>{for(const f of d)if(f[o]){if(f[o]===h[o]){const v=f[a];for(const m in h)f[m]=h[m];return f[a]=v,!0}if(f[a]&&s(f[a],h))return!0}},u=[...e.getDataSet()??[]];for(const d of n)s(u,d);e.setDataSet(u)},[e]),bo=e=>l.useCallback(t=>{var c,i;const n=He(t)?t:[t],r=e.getProps(),o=((c=r.fieldNames)==null?void 0:c.value)??"id",a=((i=r.fieldNames)==null?void 0:i.children)??"children",s=(d,h)=>{for(let f=d.length-1;f>=0;f--){const v=d[f];if(v[o]){if(v[o]===h[o])return d.splice(f,1),!0;if(v[a]&&s(v[a],h))return!0}}},u=[...e.getDataSet()??[]];for(const d of n)s(u,d);e.setDataSet(u)},[e]),So=(e,t)=>{const n=e.getValues(),r=e.getProps();return l.useMemo(()=>{const o={add:{icon:C.jsx(fn,{}),tooltip:"Добавить",position:"left",onClick:()=>{t.open("create")}},edit:{icon:C.jsx(Kn,{}),tooltip:"Редактировать",position:"center",disabled:!n||n.length!==1,onClick:()=>{const a=e.getValues();a.length===1&&t.open("update",a[0])}},delete:{icon:C.jsx(An,{}),tooltip:"Удалить",position:"right",disabled:!n||n.length<1,onClick:()=>{yo(e)}}};return hn(o,r.editButtons)},[e,t,n,r.editButtons])},yo=e=>{const t=e.getProps(),n=e.getValues();if(n.length<1)return;let r;const o=()=>{var s;const a=(s=t==null?void 0:t.onDelete)==null?void 0:s.call(t,n,e);if(vn(a)){t.confirmDelete||(e.buttonsApi.loading("delete",!0),e.buttonsApi.disabled("add",!0),e.buttonsApi.disabled("edit",!0)),a.then(()=>{e.isMounted()&&(e.deleteNodes(n),e.setValues(null),t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("delete",!0),e.buttonsApi.disabled("add",!1)))}).catch(c=>{e.isMounted()&&(t.confirmDelete?r==null||r.destroy():(e.buttonsApi.loading("delete",!1),e.buttonsApi.disabled("add",!1),e.buttonsApi.disabled("edit",!1)),kt.alert({content:C.jsxs(C.Fragment,{children:[C.jsx("p",{children:C.jsx("b",{children:c.message})}),c.stack&&gn()?C.jsx("p",{children:c.stack}):""]}),colorType:"danger"}))});return}e.deleteNodes(n),e.setValues(null),r&&r.destroy()};t.confirmDelete?r=kt.confirmWaiter({content:t.nodeDeleteMessage??"Удалить выбранные строки?",onOk:o}):o()},po=e=>{const[t,n]=mn(e),[r]=l.useState(t.treeSelectId??"treeSelect-"+dt()),[o]=l.useState(t.apiRef??{}),[a]=l.useState({});qr({api:o,componentId:r,treeProps:t,updateProps:n,buttonsApi:a});const[s,u]=yr(o),c=So(o,u),i=xo(e);return l.useEffect(()=>{o.setIsAllFetched(!1),o.setDataSet(void 0),o.setValues(null)},[o]),l.useEffect(()=>{o.setDataSet(t.dataSet)},[o.setDataSet,o,t.dataSet]),l.useEffect(()=>{o.setValues(t.value??null)},[o,t.value]),l.useEffect(()=>{var d;if((!t.fetchMode||t.fetchMode==="onLoad")&&!t.minSearchLength){o.fetchData("");return}o.getIsReady()||(d=t==null?void 0:t.onReady)==null||d.call(t)},[o,t,t.fetchMode,t.minSearchLength]),!s||t.readOnly||t.disabled?C.jsx(Ft,{api:o,treeSelectProps:e,antdTreeSelectProps:i}):C.jsxs(Cn,{wrap:!1,children:[C.jsx(Ft,{api:o,treeSelectProps:e,antdTreeSelectProps:i}),C.jsx(bn,{children:C.jsx(Sn,{buttons:c,apiRef:a,context:o})}),C.jsx(pn,{...s})]})},xo=e=>l.useMemo(()=>At(e,{apiRef:!0,treeSelectId:!0,readOnly:!0,value:!0,defaultValueCallback:!0,titleRender:!0,labelRender:!0,filterTreeNode:!0,dataSet:!0,fetchMode:!0,noCacheFetchedData:!0,minSearchLength:!0,debounce:!0,selectedLabelProp:!0,fieldNames:!0,editFormProps:!0,nodeDeleteMessage:!0,confirmDelete:!0,editButtons:!0,plainList:!0,onReady:!0,onChange:!0,onClear:!0,onDataFetch:!0,onDataFetchSuccess:!0,onDataFetchError:!0,onDataFetchComplete:!0,onDelete:!0})[1],[e]),Do=({field:e})=>{l.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const t=e.getProps(),n=e.getValue(),r=Io(t),o=l.useCallback(c=>{var i;e.isReady()&&(e.setValue(c??null),e.setDirty(!0)),(i=t.onChange)==null||i.call(t,c)},[e,t]),a=l.useCallback(()=>{e.setTouched(!0)},[e]),s=l.useCallback(()=>{var c;e.setDirty(!0),e.setTouched(!0),(c=t.onClear)==null||c.call(t)},[e,t]);l.useEffect(()=>{e.setReady(!0)},[e]);const u={width:t.width??"100%",...t.style};return C.jsx(po,{style:u,...r,autoFocus:t.autoFocus,defaultValueCallback:t.defaultValueCallback,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:n,placeholder:t.placeholder??"Choose",allowClear:t.allowClear!==!1,onChange:o,onClear:s,onBlur:a,onDataFetch:t.onDataFetch,onDataFetchComplete:t.onDataFetchComplete,onDataFetchError:t.onDataFetchError,onDataFetchSuccess:t.onDataFetchSuccess,onDelete:t.onDelete,onReady:()=>{var c;return(c=t.onReady)==null?void 0:c.call(t,e)},onKeyUp:t.onKeyUp,onKeyDown:t.onKeyDown,onClick:t.onClick,onSelect:t.onSelect,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseDown:t.onMouseDown,onFocus:t.onFocus,onDeselect:t.onDeselect,onDropdownVisibleChange:t.onDropdownVisibleChange,onInputKeyDown:t.onInputKeyDown,onTreeExpand:t.onTreeExpand,onPopupScroll:t.onPopupScroll,onSearch:t.onSearch,onTreeLoad:t.onTreeLoad})},Io=e=>l.useMemo(()=>At(e,{component:!0,helpClass:!0,label:!0,placeholder:!0,tab:!0,inlineGroup:!0,value:!0,hidden:!0,dependsOn:!0,width:!0,autoFocus:!0,style:!0,tooltip:!0,disabled:!0,requiredMark:!0,readOnly:!0,nonEditable:!0,rowStyle:!0,autoHeightResize:!0,onDirtyStateChanged:!0,onReady:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,onTouchedStateChanged:!0,onValidated:!0,onValueChanged:!0,onReadyStateChanged:!0,rules:!0})[1],[e]);class Ro extends yn{render(){return C.jsx(Do,{field:this})}}export{Ro as T};
