import{r as a,C as Me,U as _e,ah as je,m as De,F as ve,o as Fe,e as z,I as Re,k as Te,aa as Be,bu as Ve,j as _}from"./index-B5poLpDm.js";import{a as W,B as ze}from"./dForm-vrGhQ6Lh.js";import{s as We}from"./dFormModal-C_QqbNS_.js";import{u as $e,a as ke,D as He,T as Ae,m as Ue,O as Ge,b as Le}from"./useShowArrow-Dw-Bhs1H.js";import{j as Xe}from"./buttonsRow-aX3TQ5bu.js";import{b as Ye,c as Ze,d as qe}from"./index-AMqWlYeY.js";import{u as Je}from"./useIcons-BKmiU9RQ.js";var Ke=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(s[n[o]]=e[n[o]]);return s};const $="SECRET_COMBOBOX_MODE_DO_NOT_USE",Qe=(e,t)=>{var s;const{prefixCls:n,bordered:o,className:l,rootClassName:r,getPopupContainer:b,popupClassName:h,dropdownClassName:k,listHeight:H=256,placement:g,listItemHeight:p,size:O,disabled:x,notFoundContent:j,status:A,builtinPlacements:U,dropdownMatchSelectWidth:G,popupMatchSelectWidth:y,direction:I,style:L,allowClear:D,variant:X,dropdownStyle:f,transitionName:Y,tagRender:Z,maxCount:q,prefix:J}=e,v=Ke(e,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount","prefix"]),{getPopupContainer:K,getPrefixCls:F,renderEmpty:w,direction:Q,virtual:ee,popupMatchSelectWidth:te,popupOverflow:ne,select:u}=a.useContext(Me),[,P]=_e(),oe=p??(P==null?void 0:P.controlHeight),i=F("select",n),se=F(),c=I??Q,{compactSize:ae,compactItemClassnames:le}=je(i,c),[re,ie]=Ye("select",X,o),N=De(i),[ue,R,T]=$e(i,N),S=a.useMemo(()=>{const{mode:m}=e;if(m!=="combobox")return m===$?"combobox":m},[e.mode]),E=S==="multiple"||S==="tags",ce=ke(e.suffixIcon,e.showArrow),de=(s=y??G)!==null&&s!==void 0?s:te,{status:me,hasFeedback:B,isFormItemInput:fe,feedbackIcon:Se}=a.useContext(ve),Ce=qe(me,A);let C;j!==void 0?C=j:S==="combobox"?C=null:C=(w==null?void 0:w("Select"))||a.createElement(He,{componentName:"Select"});const{suffixIcon:be,itemIcon:he,removeIcon:ge,clearIcon:pe}=Je(Object.assign(Object.assign({},v),{multiple:E,hasFeedback:B,feedbackIcon:Se,showSuffixIcon:ce,prefixCls:i,componentName:"Select"})),Oe=D===!0?{clearIcon:pe}:D,xe=Fe(v,["suffixIcon","itemIcon"]),ye=z(h||k,{[`${i}-dropdown-${c}`]:c==="rtl"},r,T,N,R),V=Re(m=>{var M;return(M=O??ae)!==null&&M!==void 0?M:m}),Ie=a.useContext(Te),we=x??Ie,Pe=z({[`${i}-lg`]:V==="large",[`${i}-sm`]:V==="small",[`${i}-rtl`]:c==="rtl",[`${i}-${re}`]:ie,[`${i}-in-form-item`]:fe},Ze(i,Ce,B),le,u==null?void 0:u.className,l,r,T,N,R),Ne=a.useMemo(()=>g!==void 0?g:c==="rtl"?"bottomRight":"bottomLeft",[g,c]),[Ee]=Be("SelectLike",f==null?void 0:f.zIndex);return ue(a.createElement(Ae,Object.assign({ref:t,virtual:ee,showSearch:u==null?void 0:u.showSearch},xe,{style:Object.assign(Object.assign({},u==null?void 0:u.style),L),dropdownMatchSelectWidth:de,transitionName:Ve(se,"slide-up",Y),builtinPlacements:Ue(U,ne),listHeight:H,listItemHeight:oe,mode:S,prefixCls:i,placement:Ne,direction:c,prefix:J,suffixIcon:be,menuItemSelectedIcon:he,removeIcon:ge,allowClear:Oe,notFoundContent:C,className:Pe,getPopupContainer:b||K,dropdownClassName:ye,disabled:we,dropdownStyle:Object.assign(Object.assign({},f),{zIndex:Ee}),maxCount:E?q:void 0,tagRender:E?Z:void 0})))},d=a.forwardRef(Qe),et=Xe(d,"dropdownAlign");d.SECRET_COMBOBOX_MODE_DO_NOT_USE=$;d.Option=Ge;d.OptGroup=Le;d._InternalPanelDoNotUseOrYouWillBeFired=et;const tt=e=>{const t=st(e),s=nt(e),n=ot(e,e.value);return _.jsx(d,{...t,options:s,value:n,disabled:e.disabled||e.readOnly,optionFilterProp:e.optionFilterProp??"label",showSearch:e.showSearch!==!1,onSelect:(o,l)=>{var r;return(r=e.onSelect)==null?void 0:r.call(e,o,l)},onDeselect:(o,l)=>{var r;return(r=e.onDeselect)==null?void 0:r.call(e,o,l)},onChange:(o,l)=>{var r;return(r=e.onChange)==null?void 0:r.call(e,o,l)},children:e.children})},nt=e=>a.useMemo(()=>{if(!e.dataSet)return;const t=s=>{const n=[];if(!(!s||!W(s))){for(const o of s){const l={...o};o.id&&(l.value=o.id),o.label&&(l.label=o.label),o.children&&(l.children=t(o.children)),n.push(l)}return n}};return t(e.dataSet)},[e.dataSet]),ot=(e,t)=>a.useMemo(()=>{if(typeof t>"u")return;if(!W(t))return typeof t=="object"?{value:t.id??"0",label:t.label}:t;const s=[];for(const n of t)typeof n=="object"?s.push({value:n.id,label:n.label}):s.push(n);return s},[t]),st=e=>a.useMemo(()=>We(e,{dataSet:!0,value:!0,readOnly:!0,onSelect:!0,onDeselect:!0,onChange:!0})[1],[e]),at=({field:e})=>{a.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const t=e.getProps(),s=e.getValue(),n=a.useCallback((b,h)=>{e.isReady()&&(t.fullItemValue?e.setValue(h):e.setValue(b),e.setDirty(!0))},[e,t.fullItemValue]),o=a.useCallback(()=>{e.setTouched(!0)},[e]);a.useEffect(()=>{e.setReady(!0)},[e]);const r={...{width:e.getWidth()??"100%"},...t.style};return _.jsx(tt,{className:t.className,allowClear:!0,...t,disabled:e.isDisabled(),readOnly:e.isReadOnly(),value:s,style:r,onBlur:o,onChange:n})};class ft extends ze{render(){return _.jsx(at,{field:this})}}export{ft as S};
