import{r as h,j as i}from"./index-23555c5c.js";import{e as C,a as b}from"./index-e5590f2c.js";import{T as F}from"./tabulatorGrid-1186b9ea.js";const m=({field:e})=>{h.useSyncExternalStore(e.subscribe.bind(e),e.getSnapshot.bind(e));const[t]=h.useState({}),u=e.getProps(),s=R(u),g=e.getValue(),c=h.useRef(u.dataSet),n=h.useRef();let r;u.selectionMode||n.current!==g&&(c.current=g,n.current=g),r=c.current;const a=M(e,u,n,c);let o=u.height;u.autoHeightResize&&(o="100%");const D=h.useMemo(()=>u.autoHeightResize?{position:"absolute",inset:0}:{},[u.autoHeightResize]);return h.useMemo(()=>i.jsx("div",{style:D,children:i.jsx(F,{...s,...a,apiRef:t,dataSet:r,readOnly:u.readOnly,placeholder:u.placeholder,width:u.width,height:o,resizeHeightWithParent:u.resizeHeightWithForm?"#"+e.getModel().getFormId():u.resizeHeightWithParent})}),[D,s,a,t,r,u.readOnly,u.placeholder,u.width,u.resizeHeightWithForm,u.resizeHeightWithParent,o,e])},R=e=>h.useMemo(()=>C(e,{value:!0,dataSet:!0,onMenuVisibilityChanged:!0,onDataLoading:!0,onDataLoaded:!0,onDataProcessed:!0,onDataLoadError:!0,onDataChanged:!0,onDataFetch:!0,onDataFetchResponse:!0,onDataFetching:!0,fetchInCreateMode:!0,onSelectionChange:!0,onDelete:!0,readOnly:!0,onValueChanged:!0,width:!0,autoHeightResize:!0,component:!0,rules:!0,onReadyStateChanged:!0,autoFocus:!0,dependsOn:!0,disabled:!0,helpClass:!0,hidden:!0,label:!0,inlineGroup:!0,onDirtyStateChanged:!0,onDisabledStateChanged:!0,onErrorChanged:!0,onHiddenStateChanged:!0,onLabelChanged:!0,onReadOnlyStateChanged:!0,placeholder:!0,onTouchedStateChanged:!0,onValidated:!0,requiredMark:!0,rowStyle:!0,style:!0,tooltip:!0,resizeHeightWithForm:!0})[1],[e]),M=(e,t,u,s)=>h.useMemo(()=>{const c=e.getModel().getFormMode();return{onDataChanged:(n,r)=>{var a;return e.isReady()&&(t.selectionMode||(u.current=n,s.current=n,e.setValue(n??void 0),e.setDirty(!0))),(a=t.onDataChanged)==null?void 0:a.call(t,n,r,e)},onSelectionChange:(n,r,a,o,D)=>{var y;return e.isReady()&&(t.selectionMode&&(u.current=n,e.setValue(n??void 0),e.setDirty(!0)),e.setTouched(!0)),(y=t.onSelectionChange)==null?void 0:y.call(t,n,r,a,o,D,e)},onDataLoading:(n,r)=>{var a;return e.setReady(!1),(a=t.onDataLoading)==null?void 0:a.call(t,n,r,e)},onDataLoaded:(n,r)=>{var o;e.setReady(!0);const a=e.getProps();return(o=a.onDataLoaded)==null?void 0:o.call(a,n,r,e)},onDataProcessed:(n,r)=>{var o;const a=e.getProps();return a.selectionMode&&r.setSelectedRows(e.getValue()),(o=a.onDataProcessed)==null?void 0:o.call(a,n,r,e)},onDataLoadError:(n,r,a)=>{var o;return e.setReady(!1),(o=t.onDataLoadError)==null?void 0:o.call(t,n,r,a,e)},onDataFetch:!t.onDataFetch||c==="create"&&!t.fetchInCreateMode?void 0:(n,r)=>t.onDataFetch(n,r,e),onDataFetching:t.onDataFetching?(n,r,a)=>t.onDataFetching(n,r,a,e):void 0,onDataFetchResponse:t.onDataFetchResponse?(n,r,a)=>{var o;return((o=t==null?void 0:t.onDataFetchResponse)==null?void 0:o.call(t,n,r,a,e))??n}:void 0,onMenuVisibilityChanged:t.onMenuVisibilityChanged?(n,r)=>{var a;return(a=t==null?void 0:t.onMenuVisibilityChanged)==null?void 0:a.call(t,n,r,e)}:void 0,onDelete:t.onDelete?(n,r)=>{var a;return(a=t==null?void 0:t.onDelete)==null?void 0:a.call(t,n,r,e)}:void 0}},[t,e,u,s]);class z extends b{render(){return i.jsx(m,{field:this})}}export{z as T};
